const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/raw-in9isEBO.js","assets/basedecoder-B2c5_Eok.js","assets/lzw-_aCqfs4w.js","assets/jpeg-JhJy4lL1.js","assets/deflate-Dthki0TA.js","assets/pako.esm-BkaqWuDM.js","assets/packbits-DDWKfGV_.js","assets/lerc-ZdFqBZSg.js","assets/webimage-DBgUwIbt.js"])))=>i.map(i=>d[i]);
(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const h of r)if(h.type==="childList")for(const u of h.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&o(u)}).observe(document,{childList:!0,subtree:!0});function s(r){const h={};return r.integrity&&(h.integrity=r.integrity),r.referrerPolicy&&(h.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?h.credentials="include":r.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function o(r){if(r.ep)return;r.ep=!0;const h=s(r);fetch(r.href,h)}})();const zl=`{
"type": "FeatureCollection",
"name": "Laghetto di Zarella",
"crs": { "type": "name", "properties": { "name": "urn:ogc:def:crs:OGC:1.3:CRS84" } },
"features": [
{ "type": "Feature", "properties": { }, "geometry": { "type": "Polygon", "coordinates": [ [ [ 16.556030040121648, 39.353976874858027 ], [ 16.551837343486472, 39.353646040352686 ], [ 16.549939710529753, 39.35280925944096 ], [ 16.549059705385567, 39.351638389197838 ], [ 16.548864526358123, 39.348601621912735 ], [ 16.54932120537304, 39.348009773423172 ], [ 16.550482007192947, 39.34771800577338 ], [ 16.552279696614995, 39.347904030650838 ], [ 16.553605338765813, 39.347985808863889 ], [ 16.555433728462756, 39.347629815439085 ], [ 16.556485300528522, 39.348190470165967 ], [ 16.557424759093383, 39.349471010889999 ], [ 16.557607551777629, 39.351292181878314 ], [ 16.556916833951639, 39.352881894396567 ], [ 16.556030040121648, 39.353976874858027 ] ] ] } }
]
}
`,Fl=`{
"type": "FeatureCollection",
"name": "Pianori di Macchialonga",
"crs": { "type": "name", "properties": { "name": "urn:ogc:def:crs:OGC:1.3:CRS84" } },
"features": [
{ "type": "Feature", "properties": { }, "geometry": { "type": "Polygon", "coordinates": [ [ [ 16.563172217731189, 39.388695587491426 ], [ 16.548406346226745, 39.384691228132368 ], [ 16.544935016941348, 39.375891389237545 ], [ 16.543625133509167, 39.368168522940302 ], [ 16.543474231503343, 39.361314863610332 ], [ 16.546573914027583, 39.35331228237407 ], [ 16.553705748274609, 39.347356777165388 ], [ 16.565693869332282, 39.342109624609726 ], [ 16.593586318529681, 39.341288686481434 ], [ 16.627515706921585, 39.342920001989 ], [ 16.639835985002204, 39.346064265441591 ], [ 16.644912476123778, 39.362136459047896 ], [ 16.644788740617109, 39.375075371155461 ], [ 16.638990559980112, 39.383007951425917 ], [ 16.629355070505877, 39.391436349659998 ], [ 16.606953257038445, 39.396392084929907 ], [ 16.587844819560637, 39.395880477003914 ], [ 16.568129550981041, 39.393715292249304 ], [ 16.54869613097522, 39.384908520207333 ], [ 16.563172217731189, 39.388695587491426 ] ] ] } }
]
}
`,Zl=`{
"type": "FeatureCollection",
"name": "ZSC Carlomagno",
"crs": { "type": "name", "properties": { "name": "urn:ogc:def:crs:OGC:1.3:CRS84" } },
"features": [
{ "type": "Feature", "properties": { }, "geometry": { "type": "Polygon", "coordinates": [ [ [ 16.583045684179766, 39.294668756534392 ], [ 16.562445885921999, 39.295319591957551 ], [ 16.550055520686104, 39.293250204328828 ], [ 16.543028681614992, 39.289804743321305 ], [ 16.539466586461796, 39.285847449100864 ], [ 16.53529372646673, 39.28133933497498 ], [ 16.537001089579633, 39.277219215483761 ], [ 16.538945781343418, 39.273002805476665 ], [ 16.538641052273665, 39.270026764478132 ], [ 16.546040429881064, 39.26871808773523 ], [ 16.552450549072731, 39.266025230768236 ], [ 16.56885017120554, 39.265432892539039 ], [ 16.587650992939391, 39.265084905775318 ], [ 16.598617073440945, 39.267914903638086 ], [ 16.606170159328371, 39.273398540077032 ], [ 16.606706022091423, 39.28112064145698 ], [ 16.604784350837615, 39.286175972516517 ], [ 16.594383577784583, 39.292558358602811 ], [ 16.583045684179766, 39.294668756534392 ] ] ] } }
]
}
`,Ul=`{
"type": "FeatureCollection",
"name": "ZSC Macchia Sacra",
"crs": { "type": "name", "properties": { "name": "urn:ogc:def:crs:OGC:1.3:CRS84" } },
"features": [
{ "type": "Feature", "properties": { }, "geometry": { "type": "Polygon", "coordinates": [ [ [ 16.414037895220613, 39.301089772356619 ], [ 16.41770572865682, 39.292751814313363 ], [ 16.431578545006293, 39.286102860997929 ], [ 16.443792442035353, 39.279991181953278 ], [ 16.455624822016887, 39.279714255859801 ], [ 16.469731143063498, 39.276556609135874 ], [ 16.479693845954078, 39.274616245564772 ], [ 16.482344170616127, 39.281709604113594 ], [ 16.479999214812711, 39.289125671855139 ], [ 16.472124605776262, 39.295315920232468 ], [ 16.466211656714236, 39.299666784992823 ], [ 16.453678994812481, 39.306562286217471 ], [ 16.448385596424007, 39.308701601575926 ], [ 16.44648052078707, 39.313390275805624 ], [ 16.441986495678197, 39.321998503622169 ], [ 16.430750239638662, 39.327320486438495 ], [ 16.416964977179205, 39.322176240419324 ], [ 16.411586028384164, 39.311874951058094 ], [ 16.414037895220613, 39.301089772356619 ] ] ] } }
]
}
`;var ql=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ba(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var wa={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(e,i){(function(s,o){o(i)})(ql,function(s){var o="1.9.4";function r(t){var n,a,l,f;for(a=1,l=arguments.length;a<l;a++){f=arguments[a];for(n in f)t[n]=f[n]}return t}var h=Object.create||function(){function t(){}return function(n){return t.prototype=n,new t}}();function u(t,n){var a=Array.prototype.slice;if(t.bind)return t.bind.apply(t,a.call(arguments,1));var l=a.call(arguments,2);return function(){return t.apply(n,l.length?l.concat(a.call(arguments)):arguments)}}var c=0;function d(t){return"_leaflet_id"in t||(t._leaflet_id=++c),t._leaflet_id}function _(t,n,a){var l,f,m,y;return y=function(){l=!1,f&&(m.apply(a,f),f=!1)},m=function(){l?f=arguments:(t.apply(a,arguments),setTimeout(y,n),l=!0)},m}function v(t,n,a){var l=n[1],f=n[0],m=l-f;return t===l&&a?t:((t-f)%m+m)%m+f}function g(){return!1}function p(t,n){if(n===!1)return t;var a=Math.pow(10,n===void 0?6:n);return Math.round(t*a)/a}function M(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function w(t){return M(t).split(/\s+/)}function P(t,n){Object.prototype.hasOwnProperty.call(t,"options")||(t.options=t.options?h(t.options):{});for(var a in n)t.options[a]=n[a];return t.options}function x(t,n,a){var l=[];for(var f in t)l.push(encodeURIComponent(a?f.toUpperCase():f)+"="+encodeURIComponent(t[f]));return(!n||n.indexOf("?")===-1?"?":"&")+l.join("&")}var A=/\{ *([\w_ -]+) *\}/g;function T(t,n){return t.replace(A,function(a,l){var f=n[l];if(f===void 0)throw new Error("No value provided for variable "+a);return typeof f=="function"&&(f=f(n)),f})}var S=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};function I(t,n){for(var a=0;a<t.length;a++)if(t[a]===n)return a;return-1}var O="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function N(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}var B=0;function q(t){var n=+new Date,a=Math.max(0,16-(n-B));return B=n+a,window.setTimeout(t,a)}var j=window.requestAnimationFrame||N("RequestAnimationFrame")||q,$=window.cancelAnimationFrame||N("CancelAnimationFrame")||N("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)};function F(t,n,a){if(a&&j===q)t.call(n);else return j.call(window,u(t,n))}function K(t){t&&$.call(window,t)}var ct={__proto__:null,extend:r,create:h,bind:u,get lastId(){return c},stamp:d,throttle:_,wrapNum:v,falseFn:g,formatNum:p,trim:M,splitWords:w,setOptions:P,getParamString:x,template:T,isArray:S,indexOf:I,emptyImageUrl:O,requestFn:j,cancelFn:$,requestAnimFrame:F,cancelAnimFrame:K};function mt(){}mt.extend=function(t){var n=function(){P(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},a=n.__super__=this.prototype,l=h(a);l.constructor=n,n.prototype=l;for(var f in this)Object.prototype.hasOwnProperty.call(this,f)&&f!=="prototype"&&f!=="__super__"&&(n[f]=this[f]);return t.statics&&r(n,t.statics),t.includes&&(tt(t.includes),r.apply(null,[l].concat(t.includes))),r(l,t),delete l.statics,delete l.includes,l.options&&(l.options=a.options?h(a.options):{},r(l.options,t.options)),l._initHooks=[],l.callInitHooks=function(){if(!this._initHooksCalled){a.callInitHooks&&a.callInitHooks.call(this),this._initHooksCalled=!0;for(var m=0,y=l._initHooks.length;m<y;m++)l._initHooks[m].call(this)}},n},mt.include=function(t){var n=this.prototype.options;return r(this.prototype,t),t.options&&(this.prototype.options=n,this.mergeOptions(t.options)),this},mt.mergeOptions=function(t){return r(this.prototype.options,t),this},mt.addInitHook=function(t){var n=Array.prototype.slice.call(arguments,1),a=typeof t=="function"?t:function(){this[t].apply(this,n)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(a),this};function tt(t){if(!(typeof L>"u"||!L||!L.Mixin)){t=S(t)?t:[t];for(var n=0;n<t.length;n++)t[n]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var et={on:function(t,n,a){if(typeof t=="object")for(var l in t)this._on(l,t[l],n);else{t=w(t);for(var f=0,m=t.length;f<m;f++)this._on(t[f],n,a)}return this},off:function(t,n,a){if(!arguments.length)delete this._events;else if(typeof t=="object")for(var l in t)this._off(l,t[l],n);else{t=w(t);for(var f=arguments.length===1,m=0,y=t.length;m<y;m++)f?this._off(t[m]):this._off(t[m],n,a)}return this},_on:function(t,n,a,l){if(typeof n!="function"){console.warn("wrong listener type: "+typeof n);return}if(this._listens(t,n,a)===!1){a===this&&(a=void 0);var f={fn:n,ctx:a};l&&(f.once=!0),this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(f)}},_off:function(t,n,a){var l,f,m;if(this._events&&(l=this._events[t],!!l)){if(arguments.length===1){if(this._firingCount)for(f=0,m=l.length;f<m;f++)l[f].fn=g;delete this._events[t];return}if(typeof n!="function"){console.warn("wrong listener type: "+typeof n);return}var y=this._listens(t,n,a);if(y!==!1){var b=l[y];this._firingCount&&(b.fn=g,this._events[t]=l=l.slice()),l.splice(y,1)}}},fire:function(t,n,a){if(!this.listens(t,a))return this;var l=r({},n,{type:t,target:this,sourceTarget:n&&n.sourceTarget||this});if(this._events){var f=this._events[t];if(f){this._firingCount=this._firingCount+1||1;for(var m=0,y=f.length;m<y;m++){var b=f[m],E=b.fn;b.once&&this.off(t,E,b.ctx),E.call(b.ctx||this,l)}this._firingCount--}}return a&&this._propagateEvent(l),this},listens:function(t,n,a,l){typeof t!="string"&&console.warn('"string" type argument expected');var f=n;typeof n!="function"&&(l=!!n,f=void 0,a=void 0);var m=this._events&&this._events[t];if(m&&m.length&&this._listens(t,f,a)!==!1)return!0;if(l){for(var y in this._eventParents)if(this._eventParents[y].listens(t,n,a,l))return!0}return!1},_listens:function(t,n,a){if(!this._events)return!1;var l=this._events[t]||[];if(!n)return!!l.length;a===this&&(a=void 0);for(var f=0,m=l.length;f<m;f++)if(l[f].fn===n&&l[f].ctx===a)return f;return!1},once:function(t,n,a){if(typeof t=="object")for(var l in t)this._on(l,t[l],n,!0);else{t=w(t);for(var f=0,m=t.length;f<m;f++)this._on(t[f],n,a,!0)}return this},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[d(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[d(t)],this},_propagateEvent:function(t){for(var n in this._eventParents)this._eventParents[n].fire(t.type,r({layer:t.target,propagatedFrom:t.target},t),!0)}};et.addEventListener=et.on,et.removeEventListener=et.clearAllEventListeners=et.off,et.addOneTimeEventListener=et.once,et.fireEvent=et.fire,et.hasEventListeners=et.listens;var Et=mt.extend(et);function Z(t,n,a){this.x=a?Math.round(t):t,this.y=a?Math.round(n):n}var gt=Math.trunc||function(t){return t>0?Math.floor(t):Math.ceil(t)};Z.prototype={clone:function(){return new Z(this.x,this.y)},add:function(t){return this.clone()._add(U(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(U(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new Z(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new Z(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=gt(this.x),this.y=gt(this.y),this},distanceTo:function(t){t=U(t);var n=t.x-this.x,a=t.y-this.y;return Math.sqrt(n*n+a*a)},equals:function(t){return t=U(t),t.x===this.x&&t.y===this.y},contains:function(t){return t=U(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+p(this.x)+", "+p(this.y)+")"}};function U(t,n,a){return t instanceof Z?t:S(t)?new Z(t[0],t[1]):t==null?t:typeof t=="object"&&"x"in t&&"y"in t?new Z(t.x,t.y):new Z(t,n,a)}function at(t,n){if(t)for(var a=n?[t,n]:t,l=0,f=a.length;l<f;l++)this.extend(a[l])}at.prototype={extend:function(t){var n,a;if(!t)return this;if(t instanceof Z||typeof t[0]=="number"||"x"in t)n=a=U(t);else if(t=rt(t),n=t.min,a=t.max,!n||!a)return this;return!this.min&&!this.max?(this.min=n.clone(),this.max=a.clone()):(this.min.x=Math.min(n.x,this.min.x),this.max.x=Math.max(a.x,this.max.x),this.min.y=Math.min(n.y,this.min.y),this.max.y=Math.max(a.y,this.max.y)),this},getCenter:function(t){return U((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return U(this.min.x,this.max.y)},getTopRight:function(){return U(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var n,a;return typeof t[0]=="number"||t instanceof Z?t=U(t):t=rt(t),t instanceof at?(n=t.min,a=t.max):n=a=t,n.x>=this.min.x&&a.x<=this.max.x&&n.y>=this.min.y&&a.y<=this.max.y},intersects:function(t){t=rt(t);var n=this.min,a=this.max,l=t.min,f=t.max,m=f.x>=n.x&&l.x<=a.x,y=f.y>=n.y&&l.y<=a.y;return m&&y},overlaps:function(t){t=rt(t);var n=this.min,a=this.max,l=t.min,f=t.max,m=f.x>n.x&&l.x<a.x,y=f.y>n.y&&l.y<a.y;return m&&y},isValid:function(){return!!(this.min&&this.max)},pad:function(t){var n=this.min,a=this.max,l=Math.abs(n.x-a.x)*t,f=Math.abs(n.y-a.y)*t;return rt(U(n.x-l,n.y-f),U(a.x+l,a.y+f))},equals:function(t){return t?(t=rt(t),this.min.equals(t.getTopLeft())&&this.max.equals(t.getBottomRight())):!1}};function rt(t,n){return!t||t instanceof at?t:new at(t,n)}function ut(t,n){if(t)for(var a=n?[t,n]:t,l=0,f=a.length;l<f;l++)this.extend(a[l])}ut.prototype={extend:function(t){var n=this._southWest,a=this._northEast,l,f;if(t instanceof W)l=t,f=t;else if(t instanceof ut){if(l=t._southWest,f=t._northEast,!l||!f)return this}else return t?this.extend(V(t)||st(t)):this;return!n&&!a?(this._southWest=new W(l.lat,l.lng),this._northEast=new W(f.lat,f.lng)):(n.lat=Math.min(l.lat,n.lat),n.lng=Math.min(l.lng,n.lng),a.lat=Math.max(f.lat,a.lat),a.lng=Math.max(f.lng,a.lng)),this},pad:function(t){var n=this._southWest,a=this._northEast,l=Math.abs(n.lat-a.lat)*t,f=Math.abs(n.lng-a.lng)*t;return new ut(new W(n.lat-l,n.lng-f),new W(a.lat+l,a.lng+f))},getCenter:function(){return new W((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new W(this.getNorth(),this.getWest())},getSouthEast:function(){return new W(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){typeof t[0]=="number"||t instanceof W||"lat"in t?t=V(t):t=st(t);var n=this._southWest,a=this._northEast,l,f;return t instanceof ut?(l=t.getSouthWest(),f=t.getNorthEast()):l=f=t,l.lat>=n.lat&&f.lat<=a.lat&&l.lng>=n.lng&&f.lng<=a.lng},intersects:function(t){t=st(t);var n=this._southWest,a=this._northEast,l=t.getSouthWest(),f=t.getNorthEast(),m=f.lat>=n.lat&&l.lat<=a.lat,y=f.lng>=n.lng&&l.lng<=a.lng;return m&&y},overlaps:function(t){t=st(t);var n=this._southWest,a=this._northEast,l=t.getSouthWest(),f=t.getNorthEast(),m=f.lat>n.lat&&l.lat<a.lat,y=f.lng>n.lng&&l.lng<a.lng;return m&&y},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t,n){return t?(t=st(t),this._southWest.equals(t.getSouthWest(),n)&&this._northEast.equals(t.getNorthEast(),n)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function st(t,n){return t instanceof ut?t:new ut(t,n)}function W(t,n,a){if(isNaN(t)||isNaN(n))throw new Error("Invalid LatLng object: ("+t+", "+n+")");this.lat=+t,this.lng=+n,a!==void 0&&(this.alt=+a)}W.prototype={equals:function(t,n){if(!t)return!1;t=V(t);var a=Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng));return a<=(n===void 0?1e-9:n)},toString:function(t){return"LatLng("+p(this.lat,t)+", "+p(this.lng,t)+")"},distanceTo:function(t){return Ut.distance(this,V(t))},wrap:function(){return Ut.wrapLatLng(this)},toBounds:function(t){var n=180*t/40075017,a=n/Math.cos(Math.PI/180*this.lat);return st([this.lat-n,this.lng-a],[this.lat+n,this.lng+a])},clone:function(){return new W(this.lat,this.lng,this.alt)}};function V(t,n,a){return t instanceof W?t:S(t)&&typeof t[0]!="object"?t.length===3?new W(t[0],t[1],t[2]):t.length===2?new W(t[0],t[1]):null:t==null?t:typeof t=="object"&&"lat"in t?new W(t.lat,"lng"in t?t.lng:t.lon,t.alt):n===void 0?null:new W(t,n,a)}var bt={latLngToPoint:function(t,n){var a=this.projection.project(t),l=this.scale(n);return this.transformation._transform(a,l)},pointToLatLng:function(t,n){var a=this.scale(n),l=this.transformation.untransform(t,a);return this.projection.unproject(l)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var n=this.projection.bounds,a=this.scale(t),l=this.transformation.transform(n.min,a),f=this.transformation.transform(n.max,a);return new at(l,f)},infinite:!1,wrapLatLng:function(t){var n=this.wrapLng?v(t.lng,this.wrapLng,!0):t.lng,a=this.wrapLat?v(t.lat,this.wrapLat,!0):t.lat,l=t.alt;return new W(a,n,l)},wrapLatLngBounds:function(t){var n=t.getCenter(),a=this.wrapLatLng(n),l=n.lat-a.lat,f=n.lng-a.lng;if(l===0&&f===0)return t;var m=t.getSouthWest(),y=t.getNorthEast(),b=new W(m.lat-l,m.lng-f),E=new W(y.lat-l,y.lng-f);return new ut(b,E)}},Ut=r({},bt,{wrapLng:[-180,180],R:6371e3,distance:function(t,n){var a=Math.PI/180,l=t.lat*a,f=n.lat*a,m=Math.sin((n.lat-t.lat)*a/2),y=Math.sin((n.lng-t.lng)*a/2),b=m*m+Math.cos(l)*Math.cos(f)*y*y,E=2*Math.atan2(Math.sqrt(b),Math.sqrt(1-b));return this.R*E}}),ke=6378137,Wt={R:ke,MAX_LATITUDE:85.0511287798,project:function(t){var n=Math.PI/180,a=this.MAX_LATITUDE,l=Math.max(Math.min(a,t.lat),-a),f=Math.sin(l*n);return new Z(this.R*t.lng*n,this.R*Math.log((1+f)/(1-f))/2)},unproject:function(t){var n=180/Math.PI;return new W((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*n,t.x*n/this.R)},bounds:function(){var t=ke*Math.PI;return new at([-t,-t],[t,t])}()};function ei(t,n,a,l){if(S(t)){this._a=t[0],this._b=t[1],this._c=t[2],this._d=t[3];return}this._a=t,this._b=n,this._c=a,this._d=l}ei.prototype={transform:function(t,n){return this._transform(t.clone(),n)},_transform:function(t,n){return n=n||1,t.x=n*(this._a*t.x+this._b),t.y=n*(this._c*t.y+this._d),t},untransform:function(t,n){return n=n||1,new Z((t.x/n-this._b)/this._a,(t.y/n-this._d)/this._c)}};function De(t,n,a,l){return new ei(t,n,a,l)}var Ai=r({},Ut,{code:"EPSG:3857",projection:Wt,transformation:function(){var t=.5/(Math.PI*Wt.R);return De(t,.5,-t,.5)}()}),Is=r({},Ai,{code:"EPSG:900913"});function An(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function Ci(t,n){var a="",l,f,m,y,b,E;for(l=0,m=t.length;l<m;l++){for(b=t[l],f=0,y=b.length;f<y;f++)E=b[f],a+=(f?"L":"M")+E.x+" "+E.y;a+=n?z.svg?"z":"x":""}return a||"M0 0"}var Gi=document.documentElement.style,_e="ActiveXObject"in window,Gt=_e&&!document.addEventListener,Kt="msLaunchUri"in navigator&&!("documentMode"in document),Ee=ft("webkit"),Cn=ft("android"),Gn=ft("android 2")||ft("android 3"),Ii=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Ni=Cn&&ft("Google")&&Ii<537&&!("AudioNode"in window),Be=!!window.opera,ii=!Kt&&ft("chrome"),Oi=ft("gecko")&&!Ee&&!Be&&!_e,In=!ii&&ft("safari"),Ri=ft("phantom"),It="OTransition"in Gi,Ns=navigator.platform.indexOf("Win")===0,Nn=_e&&"transition"in Gi,ki="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Gn,On="MozPerspective"in Gi,Os=!window.L_DISABLE_3D&&(Nn||ki||On)&&!It&&!Ri,ze=typeof orientation<"u"||ft("mobile"),Rs=ze&&Ee,ks=ze&&ki,Rn=!window.PointerEvent&&window.MSPointerEvent,Di=!!(window.PointerEvent||Rn),kn="ontouchstart"in window||!!window.TouchEvent,fr=!window.L_NO_TOUCH&&(kn||Di),me=ze&&Be,Dn=ze&&Oi,Bn=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Ds=function(){var t=!1;try{var n=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassiveEventSupport",g,n),window.removeEventListener("testPassiveEventSupport",g,n)}catch{}return t}(),Bs=function(){return!!document.createElement("canvas").getContext}(),Bi=!!(document.createElementNS&&An("svg").createSVGRect),zs=!!Bi&&function(){var t=document.createElement("div");return t.innerHTML="<svg/>",(t.firstChild&&t.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),zn=!Bi&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var n=t.firstChild;return n.style.behavior="url(#default#VML)",n&&typeof n.adj=="object"}catch{return!1}}(),Fs=navigator.platform.indexOf("Mac")===0,ni=navigator.platform.indexOf("Linux")===0;function ft(t){return navigator.userAgent.toLowerCase().indexOf(t)>=0}var z={ie:_e,ielt9:Gt,edge:Kt,webkit:Ee,android:Cn,android23:Gn,androidStock:Ni,opera:Be,chrome:ii,gecko:Oi,safari:In,phantom:Ri,opera12:It,win:Ns,ie3d:Nn,webkit3d:ki,gecko3d:On,any3d:Os,mobile:ze,mobileWebkit:Rs,mobileWebkit3d:ks,msPointer:Rn,pointer:Di,touch:fr,touchNative:kn,mobileOpera:me,mobileGecko:Dn,retina:Bn,passiveEvents:Ds,canvas:Bs,svg:Bi,vml:zn,inlineSvg:zs,mac:Fs,linux:ni},ge=z.msPointer?"MSPointerDown":"pointerdown",qt=z.msPointer?"MSPointerMove":"pointermove",Xt=z.msPointer?"MSPointerUp":"pointerup",Yt=z.msPointer?"MSPointerCancel":"pointercancel",Jt={touchstart:ge,touchmove:qt,touchend:Xt,touchcancel:Yt},zi={touchstart:zh,touchmove:Zn,touchend:Zn,touchcancel:Zn},pe={},si=!1;function Fi(t,n,a){return n==="touchstart"&&Bh(),zi[n]?(a=zi[n].bind(this,a),t.addEventListener(Jt[n],a,!1),a):(console.warn("wrong event specified:",n),g)}function Fn(t,n,a){if(!Jt[n]){console.warn("wrong event specified:",n);return}t.removeEventListener(Jt[n],a,!1)}function Zs(t){pe[t.pointerId]=t}function Dh(t){pe[t.pointerId]&&(pe[t.pointerId]=t)}function dr(t){delete pe[t.pointerId]}function Bh(){si||(document.addEventListener(ge,Zs,!0),document.addEventListener(qt,Dh,!0),document.addEventListener(Xt,dr,!0),document.addEventListener(Yt,dr,!0),si=!0)}function Zn(t,n){if(n.pointerType!==(n.MSPOINTER_TYPE_MOUSE||"mouse")){n.touches=[];for(var a in pe)n.touches.push(pe[a]);n.changedTouches=[n],t(n)}}function zh(t,n){n.MSPOINTER_TYPE_TOUCH&&n.pointerType===n.MSPOINTER_TYPE_TOUCH&&Tt(n),Zn(t,n)}function Fh(t){var n={},a,l;for(l in t)a=t[l],n[l]=a&&a.bind?a.bind(t):a;return t=n,n.type="dblclick",n.detail=2,n.isTrusted=!1,n._simulated=!0,n}var Zh=200;function Uh(t,n){t.addEventListener("dblclick",n);var a=0,l;function f(m){if(m.detail!==1){l=m.detail;return}if(!(m.pointerType==="mouse"||m.sourceCapabilities&&!m.sourceCapabilities.firesTouchEvents)){var y=vr(m);if(!(y.some(function(E){return E instanceof HTMLLabelElement&&E.attributes.for})&&!y.some(function(E){return E instanceof HTMLInputElement||E instanceof HTMLSelectElement}))){var b=Date.now();b-a<=Zh?(l++,l===2&&n(Fh(m))):l=1,a=b}}}return t.addEventListener("click",f),{dblclick:n,simDblclick:f}}function qh(t,n){t.removeEventListener("dblclick",n.dblclick),t.removeEventListener("click",n.simDblclick)}var Us=jn(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Zi=jn(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),_r=Zi==="webkitTransition"||Zi==="OTransition"?Zi+"End":"transitionend";function mr(t){return typeof t=="string"?document.getElementById(t):t}function Ui(t,n){var a=t.style[n]||t.currentStyle&&t.currentStyle[n];if((!a||a==="auto")&&document.defaultView){var l=document.defaultView.getComputedStyle(t,null);a=l?l[n]:null}return a==="auto"?null:a}function ot(t,n,a){var l=document.createElement(t);return l.className=n||"",a&&a.appendChild(l),l}function pt(t){var n=t.parentNode;n&&n.removeChild(t)}function Un(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function ai(t){var n=t.parentNode;n&&n.lastChild!==t&&n.appendChild(t)}function ri(t){var n=t.parentNode;n&&n.firstChild!==t&&n.insertBefore(t,n.firstChild)}function qs(t,n){if(t.classList!==void 0)return t.classList.contains(n);var a=qn(t);return a.length>0&&new RegExp("(^|\\s)"+n+"(\\s|$)").test(a)}function J(t,n){if(t.classList!==void 0)for(var a=w(n),l=0,f=a.length;l<f;l++)t.classList.add(a[l]);else if(!qs(t,n)){var m=qn(t);js(t,(m?m+" ":"")+n)}}function yt(t,n){t.classList!==void 0?t.classList.remove(n):js(t,M((" "+qn(t)+" ").replace(" "+n+" "," ")))}function js(t,n){t.className.baseVal===void 0?t.className=n:t.className.baseVal=n}function qn(t){return t.correspondingElement&&(t=t.correspondingElement),t.className.baseVal===void 0?t.className:t.className.baseVal}function jt(t,n){"opacity"in t.style?t.style.opacity=n:"filter"in t.style&&jh(t,n)}function jh(t,n){var a=!1,l="DXImageTransform.Microsoft.Alpha";try{a=t.filters.item(l)}catch{if(n===1)return}n=Math.round(n*100),a?(a.Enabled=n!==100,a.Opacity=n):t.style.filter+=" progid:"+l+"(opacity="+n+")"}function jn(t){for(var n=document.documentElement.style,a=0;a<t.length;a++)if(t[a]in n)return t[a];return!1}function Fe(t,n,a){var l=n||new Z(0,0);t.style[Us]=(z.ie3d?"translate("+l.x+"px,"+l.y+"px)":"translate3d("+l.x+"px,"+l.y+"px,0)")+(a?" scale("+a+")":"")}function wt(t,n){t._leaflet_pos=n,z.any3d?Fe(t,n):(t.style.left=n.x+"px",t.style.top=n.y+"px")}function Ze(t){return t._leaflet_pos||new Z(0,0)}var qi,ji,$s;if("onselectstart"in document)qi=function(){X(window,"selectstart",Tt)},ji=function(){dt(window,"selectstart",Tt)};else{var $i=jn(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);qi=function(){if($i){var t=document.documentElement.style;$s=t[$i],t[$i]="none"}},ji=function(){$i&&(document.documentElement.style[$i]=$s,$s=void 0)}}function Hs(){X(window,"dragstart",Tt)}function Vs(){dt(window,"dragstart",Tt)}var $n,Ws;function Ks(t){for(;t.tabIndex===-1;)t=t.parentNode;t.style&&(Hn(),$n=t,Ws=t.style.outlineStyle,t.style.outlineStyle="none",X(window,"keydown",Hn))}function Hn(){$n&&($n.style.outlineStyle=Ws,$n=void 0,Ws=void 0,dt(window,"keydown",Hn))}function gr(t){do t=t.parentNode;while((!t.offsetWidth||!t.offsetHeight)&&t!==document.body);return t}function Xs(t){var n=t.getBoundingClientRect();return{x:n.width/t.offsetWidth||1,y:n.height/t.offsetHeight||1,boundingClientRect:n}}var $h={__proto__:null,TRANSFORM:Us,TRANSITION:Zi,TRANSITION_END:_r,get:mr,getStyle:Ui,create:ot,remove:pt,empty:Un,toFront:ai,toBack:ri,hasClass:qs,addClass:J,removeClass:yt,setClass:js,getClass:qn,setOpacity:jt,testProp:jn,setTransform:Fe,setPosition:wt,getPosition:Ze,get disableTextSelection(){return qi},get enableTextSelection(){return ji},disableImageDrag:Hs,enableImageDrag:Vs,preventOutline:Ks,restoreOutline:Hn,getSizedParentNode:gr,getScale:Xs};function X(t,n,a,l){if(n&&typeof n=="object")for(var f in n)Js(t,f,n[f],a);else{n=w(n);for(var m=0,y=n.length;m<y;m++)Js(t,n[m],a,l)}return this}var ae="_leaflet_events";function dt(t,n,a,l){if(arguments.length===1)pr(t),delete t[ae];else if(n&&typeof n=="object")for(var f in n)Qs(t,f,n[f],a);else if(n=w(n),arguments.length===2)pr(t,function(b){return I(n,b)!==-1});else for(var m=0,y=n.length;m<y;m++)Qs(t,n[m],a,l);return this}function pr(t,n){for(var a in t[ae]){var l=a.split(/\d/)[0];(!n||n(l))&&Qs(t,l,null,null,a)}}var Ys={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Js(t,n,a,l){var f=n+d(a)+(l?"_"+d(l):"");if(t[ae]&&t[ae][f])return this;var m=function(b){return a.call(l||t,b||window.event)},y=m;!z.touchNative&&z.pointer&&n.indexOf("touch")===0?m=Fi(t,n,m):z.touch&&n==="dblclick"?m=Uh(t,m):"addEventListener"in t?n==="touchstart"||n==="touchmove"||n==="wheel"||n==="mousewheel"?t.addEventListener(Ys[n]||n,m,z.passiveEvents?{passive:!1}:!1):n==="mouseenter"||n==="mouseleave"?(m=function(b){b=b||window.event,ea(t,b)&&y(b)},t.addEventListener(Ys[n],m,!1)):t.addEventListener(n,y,!1):t.attachEvent("on"+n,m),t[ae]=t[ae]||{},t[ae][f]=m}function Qs(t,n,a,l,f){f=f||n+d(a)+(l?"_"+d(l):"");var m=t[ae]&&t[ae][f];if(!m)return this;!z.touchNative&&z.pointer&&n.indexOf("touch")===0?Fn(t,n,m):z.touch&&n==="dblclick"?qh(t,m):"removeEventListener"in t?t.removeEventListener(Ys[n]||n,m,!1):t.detachEvent("on"+n,m),t[ae][f]=null}function Ue(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,this}function ta(t){return Js(t,"wheel",Ue),this}function Hi(t){return X(t,"mousedown touchstart dblclick contextmenu",Ue),t._leaflet_disable_click=!0,this}function Tt(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function qe(t){return Tt(t),Ue(t),this}function vr(t){if(t.composedPath)return t.composedPath();for(var n=[],a=t.target;a;)n.push(a),a=a.parentNode;return n}function yr(t,n){if(!n)return new Z(t.clientX,t.clientY);var a=Xs(n),l=a.boundingClientRect;return new Z((t.clientX-l.left)/a.x-n.clientLeft,(t.clientY-l.top)/a.y-n.clientTop)}var Hh=z.linux&&z.chrome?window.devicePixelRatio:z.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Mr(t){return z.edge?t.wheelDeltaY/2:t.deltaY&&t.deltaMode===0?-t.deltaY/Hh:t.deltaY&&t.deltaMode===1?-t.deltaY*20:t.deltaY&&t.deltaMode===2?-t.deltaY*60:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?-t.detail*20:t.detail?t.detail/-32765*60:0}function ea(t,n){var a=n.relatedTarget;if(!a)return!0;try{for(;a&&a!==t;)a=a.parentNode}catch{return!1}return a!==t}var Vh={__proto__:null,on:X,off:dt,stopPropagation:Ue,disableScrollPropagation:ta,disableClickPropagation:Hi,preventDefault:Tt,stop:qe,getPropagationPath:vr,getMousePosition:yr,getWheelDelta:Mr,isExternalTarget:ea,addListener:X,removeListener:dt},wr=Et.extend({run:function(t,n,a,l){this.stop(),this._el=t,this._inProgress=!0,this._duration=a||.25,this._easeOutPower=1/Math.max(l||.5,.2),this._startPos=Ze(t),this._offset=n.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=F(this._animate,this),this._step()},_step:function(t){var n=+new Date-this._startTime,a=this._duration*1e3;n<a?this._runFrame(this._easeOut(n/a),t):(this._runFrame(1),this._complete())},_runFrame:function(t,n){var a=this._startPos.add(this._offset.multiplyBy(t));n&&a._round(),wt(this._el,a),this.fire("step")},_complete:function(){K(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),it=Et.extend({options:{crs:Ai,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,n){n=P(this,n),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(t),this._initLayout(),this._onResize=u(this._onResize,this),this._initEvents(),n.maxBounds&&this.setMaxBounds(n.maxBounds),n.zoom!==void 0&&(this._zoom=this._limitZoom(n.zoom)),n.center&&n.zoom!==void 0&&this.setView(V(n.center),n.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Zi&&z.any3d&&!z.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),X(this._proxy,_r,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,n,a){if(n=n===void 0?this._zoom:this._limitZoom(n),t=this._limitCenter(V(t),n,this.options.maxBounds),a=a||{},this._stop(),this._loaded&&!a.reset&&a!==!0){a.animate!==void 0&&(a.zoom=r({animate:a.animate},a.zoom),a.pan=r({animate:a.animate,duration:a.duration},a.pan));var l=this._zoom!==n?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,n,a.zoom):this._tryAnimatedPan(t,a.pan);if(l)return clearTimeout(this._sizeTimer),this}return this._resetView(t,n,a.pan&&a.pan.noMoveStart),this},setZoom:function(t,n){return this._loaded?this.setView(this.getCenter(),t,{zoom:n}):(this._zoom=t,this)},zoomIn:function(t,n){return t=t||(z.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+t,n)},zoomOut:function(t,n){return t=t||(z.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-t,n)},setZoomAround:function(t,n,a){var l=this.getZoomScale(n),f=this.getSize().divideBy(2),m=t instanceof Z?t:this.latLngToContainerPoint(t),y=m.subtract(f).multiplyBy(1-1/l),b=this.containerPointToLatLng(f.add(y));return this.setView(b,n,{zoom:a})},_getBoundsCenterZoom:function(t,n){n=n||{},t=t.getBounds?t.getBounds():st(t);var a=U(n.paddingTopLeft||n.padding||[0,0]),l=U(n.paddingBottomRight||n.padding||[0,0]),f=this.getBoundsZoom(t,!1,a.add(l));if(f=typeof n.maxZoom=="number"?Math.min(n.maxZoom,f):f,f===1/0)return{center:t.getCenter(),zoom:f};var m=l.subtract(a).divideBy(2),y=this.project(t.getSouthWest(),f),b=this.project(t.getNorthEast(),f),E=this.unproject(y.add(b).divideBy(2).add(m),f);return{center:E,zoom:f}},fitBounds:function(t,n){if(t=st(t),!t.isValid())throw new Error("Bounds are not valid.");var a=this._getBoundsCenterZoom(t,n);return this.setView(a.center,a.zoom,n)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,n){return this.setView(t,this._zoom,{pan:n})},panBy:function(t,n){if(t=U(t).round(),n=n||{},!t.x&&!t.y)return this.fire("moveend");if(n.animate!==!0&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new wr,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),n.noMoveStart||this.fire("movestart"),n.animate!==!1){J(this._mapPane,"leaflet-pan-anim");var a=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,a,n.duration||.25,n.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},flyTo:function(t,n,a){if(a=a||{},a.animate===!1||!z.any3d)return this.setView(t,n,a);this._stop();var l=this.project(this.getCenter()),f=this.project(t),m=this.getSize(),y=this._zoom;t=V(t),n=n===void 0?y:n;var b=Math.max(m.x,m.y),E=b*this.getZoomScale(y,n),C=f.distanceTo(l)||1,D=1.42,H=D*D;function Q(xt){var ss=xt?-1:1,Rl=xt?E:b,kl=E*E-b*b+ss*H*H*C*C,Dl=2*Rl*H*C,fa=kl/Dl,eo=Math.sqrt(fa*fa+1)-fa,Bl=eo<1e-9?-18:Math.log(eo);return Bl}function Nt(xt){return(Math.exp(xt)-Math.exp(-xt))/2}function St(xt){return(Math.exp(xt)+Math.exp(-xt))/2}function Ht(xt){return Nt(xt)/St(xt)}var Dt=Q(0);function fi(xt){return b*(St(Dt)/St(Dt+D*xt))}function Gl(xt){return b*(St(Dt)*Ht(Dt+D*xt)-Nt(Dt))/H}function Il(xt){return 1-Math.pow(1-xt,1.5)}var Nl=Date.now(),Qr=(Q(1)-Dt)/D,Ol=a.duration?1e3*a.duration:1e3*Qr*.8;function to(){var xt=(Date.now()-Nl)/Ol,ss=Il(xt)*Qr;xt<=1?(this._flyToFrame=F(to,this),this._move(this.unproject(l.add(f.subtract(l).multiplyBy(Gl(ss)/C)),y),this.getScaleZoom(b/fi(ss),y),{flyTo:!0})):this._move(t,n)._moveEnd(!0)}return this._moveStart(!0,a.noMoveStart),to.call(this),this},flyToBounds:function(t,n){var a=this._getBoundsCenterZoom(t,n);return this.flyTo(a.center,a.zoom,n)},setMaxBounds:function(t){return t=st(t),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),t.isValid()?(this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(t){var n=this.options.minZoom;return this.options.minZoom=t,this._loaded&&n!==t&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(t):this},setMaxZoom:function(t){var n=this.options.maxZoom;return this.options.maxZoom=t,this._loaded&&n!==t&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(t):this},panInsideBounds:function(t,n){this._enforcingBounds=!0;var a=this.getCenter(),l=this._limitCenter(a,this._zoom,st(t));return a.equals(l)||this.panTo(l,n),this._enforcingBounds=!1,this},panInside:function(t,n){n=n||{};var a=U(n.paddingTopLeft||n.padding||[0,0]),l=U(n.paddingBottomRight||n.padding||[0,0]),f=this.project(this.getCenter()),m=this.project(t),y=this.getPixelBounds(),b=rt([y.min.add(a),y.max.subtract(l)]),E=b.getSize();if(!b.contains(m)){this._enforcingBounds=!0;var C=m.subtract(b.getCenter()),D=b.extend(m).getSize().subtract(E);f.x+=C.x<0?-D.x:D.x,f.y+=C.y<0?-D.y:D.y,this.panTo(this.unproject(f),n),this._enforcingBounds=!1}return this},invalidateSize:function(t){if(!this._loaded)return this;t=r({animate:!1,pan:!0},t===!0?{animate:!0}:t);var n=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var a=this.getSize(),l=n.divideBy(2).round(),f=a.divideBy(2).round(),m=l.subtract(f);return!m.x&&!m.y?this:(t.animate&&t.pan?this.panBy(m):(t.pan&&this._rawPanBy(m),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(u(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:n,newSize:a}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){if(t=this._locateOptions=r({timeout:1e4,watch:!1},t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var n=u(this._handleGeolocationResponse,this),a=u(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(n,a,t):navigator.geolocation.getCurrentPosition(n,a,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){if(this._container._leaflet_id){var n=t.code,a=t.message||(n===1?"permission denied":n===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:n,message:"Geolocation error: "+a+"."})}},_handleGeolocationResponse:function(t){if(this._container._leaflet_id){var n=t.coords.latitude,a=t.coords.longitude,l=new W(n,a),f=l.toBounds(t.coords.accuracy*2),m=this._locateOptions;if(m.setView){var y=this.getBoundsZoom(f);this.setView(l,m.maxZoom?Math.min(y,m.maxZoom):y)}var b={latlng:l,bounds:f,timestamp:t.timestamp};for(var E in t.coords)typeof t.coords[E]=="number"&&(b[E]=t.coords[E]);this.fire("locationfound",b)}},addHandler:function(t,n){if(!n)return this;var a=this[t]=new n(this);return this._handlers.push(a),this.options[t]&&a.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),pt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(K(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var t;for(t in this._layers)this._layers[t].remove();for(t in this._panes)pt(this._panes[t]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(t,n){var a="leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),l=ot("div",a,n||this._mapPane);return t&&(this._panes[t]=l),l},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds(),n=this.unproject(t.getBottomLeft()),a=this.unproject(t.getTopRight());return new ut(n,a)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,n,a){t=st(t),a=U(a||[0,0]);var l=this.getZoom()||0,f=this.getMinZoom(),m=this.getMaxZoom(),y=t.getNorthWest(),b=t.getSouthEast(),E=this.getSize().subtract(a),C=rt(this.project(b,l),this.project(y,l)).getSize(),D=z.any3d?this.options.zoomSnap:1,H=E.x/C.x,Q=E.y/C.y,Nt=n?Math.max(H,Q):Math.min(H,Q);return l=this.getScaleZoom(Nt,l),D&&(l=Math.round(l/(D/100))*(D/100),l=n?Math.ceil(l/D)*D:Math.floor(l/D)*D),Math.max(f,Math.min(m,l))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new Z(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,n){var a=this._getTopLeftPoint(t,n);return new at(a,a.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(t===void 0?this.getZoom():t)},getPane:function(t){return typeof t=="string"?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,n){var a=this.options.crs;return n=n===void 0?this._zoom:n,a.scale(t)/a.scale(n)},getScaleZoom:function(t,n){var a=this.options.crs;n=n===void 0?this._zoom:n;var l=a.zoom(t*a.scale(n));return isNaN(l)?1/0:l},project:function(t,n){return n=n===void 0?this._zoom:n,this.options.crs.latLngToPoint(V(t),n)},unproject:function(t,n){return n=n===void 0?this._zoom:n,this.options.crs.pointToLatLng(U(t),n)},layerPointToLatLng:function(t){var n=U(t).add(this.getPixelOrigin());return this.unproject(n)},latLngToLayerPoint:function(t){var n=this.project(V(t))._round();return n._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(V(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(st(t))},distance:function(t,n){return this.options.crs.distance(V(t),V(n))},containerPointToLayerPoint:function(t){return U(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return U(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var n=this.containerPointToLayerPoint(U(t));return this.layerPointToLatLng(n)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(V(t)))},mouseEventToContainerPoint:function(t){return yr(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var n=this._container=mr(t);if(n){if(n._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");X(n,"scroll",this._onScroll,this),this._containerId=d(n)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&z.any3d,J(t,"leaflet-container"+(z.touch?" leaflet-touch":"")+(z.retina?" leaflet-retina":"")+(z.ielt9?" leaflet-oldie":"")+(z.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var n=Ui(t,"position");n!=="absolute"&&n!=="relative"&&n!=="fixed"&&n!=="sticky"&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),wt(this._mapPane,new Z(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(J(t.markerPane,"leaflet-zoom-hide"),J(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,n,a){wt(this._mapPane,new Z(0,0));var l=!this._loaded;this._loaded=!0,n=this._limitZoom(n),this.fire("viewprereset");var f=this._zoom!==n;this._moveStart(f,a)._move(t,n)._moveEnd(f),this.fire("viewreset"),l&&this.fire("load")},_moveStart:function(t,n){return t&&this.fire("zoomstart"),n||this.fire("movestart"),this},_move:function(t,n,a,l){n===void 0&&(n=this._zoom);var f=this._zoom!==n;return this._zoom=n,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),l?a&&a.pinch&&this.fire("zoom",a):((f||a&&a.pinch)&&this.fire("zoom",a),this.fire("move",a)),this},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return K(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){wt(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){this._targets={},this._targets[d(this._container)]=this;var n=t?dt:X;n(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&n(window,"resize",this._onResize,this),z.any3d&&this.options.transform3DLimit&&(t?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){K(this._resizeRequest),this._resizeRequest=F(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,n){for(var a=[],l,f=n==="mouseout"||n==="mouseover",m=t.target||t.srcElement,y=!1;m;){if(l=this._targets[d(m)],l&&(n==="click"||n==="preclick")&&this._draggableMoved(l)){y=!0;break}if(l&&l.listens(n,!0)&&(f&&!ea(m,t)||(a.push(l),f))||m===this._container)break;m=m.parentNode}return!a.length&&!y&&!f&&this.listens(n,!0)&&(a=[this]),a},_isClickDisabled:function(t){for(;t&&t!==this._container;){if(t._leaflet_disable_click)return!0;t=t.parentNode}},_handleDOMEvent:function(t){var n=t.target||t.srcElement;if(!(!this._loaded||n._leaflet_disable_events||t.type==="click"&&this._isClickDisabled(n))){var a=t.type;a==="mousedown"&&Ks(n),this._fireDOMEvent(t,a)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(t,n,a){if(t.type==="click"){var l=r({},t);l.type="preclick",this._fireDOMEvent(l,l.type,a)}var f=this._findEventTargets(t,n);if(a){for(var m=[],y=0;y<a.length;y++)a[y].listens(n,!0)&&m.push(a[y]);f=m.concat(f)}if(f.length){n==="contextmenu"&&Tt(t);var b=f[0],E={originalEvent:t};if(t.type!=="keypress"&&t.type!=="keydown"&&t.type!=="keyup"){var C=b.getLatLng&&(!b._radius||b._radius<=10);E.containerPoint=C?this.latLngToContainerPoint(b.getLatLng()):this.mouseEventToContainerPoint(t),E.layerPoint=this.containerPointToLayerPoint(E.containerPoint),E.latlng=C?b.getLatLng():this.layerPointToLatLng(E.layerPoint)}for(y=0;y<f.length;y++)if(f[y].fire(n,E,!0),E.originalEvent._stopped||f[y].options.bubblingMouseEvents===!1&&I(this._mouseEvents,n)!==-1)return}},_draggableMoved:function(t){return t=t.dragging&&t.dragging.enabled()?t:this,t.dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,n=this._handlers.length;t<n;t++)this._handlers[t].disable()},whenReady:function(t,n){return this._loaded?t.call(n||this,{target:this}):this.on("load",t,n),this},_getMapPanePos:function(){return Ze(this._mapPane)||new Z(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,n){var a=t&&n!==void 0?this._getNewPixelOrigin(t,n):this.getPixelOrigin();return a.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,n){var a=this.getSize()._divideBy(2);return this.project(t,n)._subtract(a)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,n,a){var l=this._getNewPixelOrigin(a,n);return this.project(t,n)._subtract(l)},_latLngBoundsToNewLayerBounds:function(t,n,a){var l=this._getNewPixelOrigin(a,n);return rt([this.project(t.getSouthWest(),n)._subtract(l),this.project(t.getNorthWest(),n)._subtract(l),this.project(t.getSouthEast(),n)._subtract(l),this.project(t.getNorthEast(),n)._subtract(l)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,n,a){if(!a)return t;var l=this.project(t,n),f=this.getSize().divideBy(2),m=new at(l.subtract(f),l.add(f)),y=this._getBoundsOffset(m,a,n);return Math.abs(y.x)<=1&&Math.abs(y.y)<=1?t:this.unproject(l.add(y),n)},_limitOffset:function(t,n){if(!n)return t;var a=this.getPixelBounds(),l=new at(a.min.add(t),a.max.add(t));return t.add(this._getBoundsOffset(l,n))},_getBoundsOffset:function(t,n,a){var l=rt(this.project(n.getNorthEast(),a),this.project(n.getSouthWest(),a)),f=l.min.subtract(t.min),m=l.max.subtract(t.max),y=this._rebound(f.x,-m.x),b=this._rebound(f.y,-m.y);return new Z(y,b)},_rebound:function(t,n){return t+n>0?Math.round(t-n)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(n))},_limitZoom:function(t){var n=this.getMinZoom(),a=this.getMaxZoom(),l=z.any3d?this.options.zoomSnap:1;return l&&(t=Math.round(t/l)*l),Math.max(n,Math.min(a,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){yt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,n){var a=this._getCenterOffset(t)._trunc();return(n&&n.animate)!==!0&&!this.getSize().contains(a)?!1:(this.panBy(a,n),!0)},_createAnimProxy:function(){var t=this._proxy=ot("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",function(n){var a=Us,l=this._proxy.style[a];Fe(this._proxy,this.project(n.center,n.zoom),this.getZoomScale(n.zoom,1)),l===this._proxy.style[a]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){pt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var t=this.getCenter(),n=this.getZoom();Fe(this._proxy,this.project(t,n),this.getZoomScale(n,1))},_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,n,a){if(this._animatingZoom)return!0;if(a=a||{},!this._zoomAnimated||a.animate===!1||this._nothingToAnimate()||Math.abs(n-this._zoom)>this.options.zoomAnimationThreshold)return!1;var l=this.getZoomScale(n),f=this._getCenterOffset(t)._divideBy(1-1/l);return a.animate!==!0&&!this.getSize().contains(f)?!1:(F(function(){this._moveStart(!0,a.noMoveStart||!1)._animateZoom(t,n,!0)},this),!0)},_animateZoom:function(t,n,a,l){this._mapPane&&(a&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=n,J(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:n,noUpdate:l}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(u(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&yt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Wh(t,n){return new it(t,n)}var Qt=mt.extend({options:{position:"topright"},initialize:function(t){P(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var n=this._map;return n&&n.removeControl(this),this.options.position=t,n&&n.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var n=this._container=this.onAdd(t),a=this.getPosition(),l=t._controlCorners[a];return J(n,"leaflet-control"),a.indexOf("bottom")!==-1?l.insertBefore(n,l.firstChild):l.appendChild(n),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(pt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(t){this._map&&t&&t.screenX>0&&t.screenY>0&&this._map.getContainer().focus()}}),Vi=function(t){return new Qt(t)};it.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){var t=this._controlCorners={},n="leaflet-",a=this._controlContainer=ot("div",n+"control-container",this._container);function l(f,m){var y=n+f+" "+n+m;t[f+m]=ot("div",y,a)}l("top","left"),l("top","right"),l("bottom","left"),l("bottom","right")},_clearControlPos:function(){for(var t in this._controlCorners)pt(this._controlCorners[t]);pt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var xr=Qt.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,n,a,l){return a<l?-1:l<a?1:0}},initialize:function(t,n,a){P(this,a),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var l in t)this._addLayer(t[l],l);for(l in n)this._addLayer(n[l],l,!0)},onAdd:function(t){this._initLayout(),this._update(),this._map=t,t.on("zoomend",this._checkDisabledLayers,this);for(var n=0;n<this._layers.length;n++)this._layers[n].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(t){return Qt.prototype.addTo.call(this,t),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,n){return this._addLayer(t,n),this._map?this._update():this},addOverlay:function(t,n){return this._addLayer(t,n,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);var n=this._getLayer(d(t));return n&&this._layers.splice(this._layers.indexOf(n),1),this._map?this._update():this},expand:function(){J(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._section.clientHeight?(J(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=t+"px"):yt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return yt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",n=this._container=ot("div",t),a=this.options.collapsed;n.setAttribute("aria-haspopup",!0),Hi(n),ta(n);var l=this._section=ot("section",t+"-list");a&&(this._map.on("click",this.collapse,this),X(n,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var f=this._layersLink=ot("a",t+"-toggle",n);f.href="#",f.title="Layers",f.setAttribute("role","button"),X(f,{keydown:function(m){m.keyCode===13&&this._expandSafely()},click:function(m){Tt(m),this._expandSafely()}},this),a||this.expand(),this._baseLayersList=ot("div",t+"-base",l),this._separator=ot("div",t+"-separator",l),this._overlaysList=ot("div",t+"-overlays",l),n.appendChild(l)},_getLayer:function(t){for(var n=0;n<this._layers.length;n++)if(this._layers[n]&&d(this._layers[n].layer)===t)return this._layers[n]},_addLayer:function(t,n,a){this._map&&t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:n,overlay:a}),this.options.sortLayers&&this._layers.sort(u(function(l,f){return this.options.sortFunction(l.layer,f.layer,l.name,f.name)},this)),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Un(this._baseLayersList),Un(this._overlaysList),this._layerControlInputs=[];var t,n,a,l,f=0;for(a=0;a<this._layers.length;a++)l=this._layers[a],this._addItem(l),n=n||l.overlay,t=t||!l.overlay,f+=l.overlay?0:1;return this.options.hideSingleBase&&(t=t&&f>1,this._baseLayersList.style.display=t?"":"none"),this._separator.style.display=n&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var n=this._getLayer(d(t.target)),a=n.overlay?t.type==="add"?"overlayadd":"overlayremove":t.type==="add"?"baselayerchange":null;a&&this._map.fire(a,n)},_createRadioElement:function(t,n){var a='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(n?' checked="checked"':"")+"/>",l=document.createElement("div");return l.innerHTML=a,l.firstChild},_addItem:function(t){var n=document.createElement("label"),a=this._map.hasLayer(t.layer),l;t.overlay?(l=document.createElement("input"),l.type="checkbox",l.className="leaflet-control-layers-selector",l.defaultChecked=a):l=this._createRadioElement("leaflet-base-layers_"+d(this),a),this._layerControlInputs.push(l),l.layerId=d(t.layer),X(l,"click",this._onInputClick,this);var f=document.createElement("span");f.innerHTML=" "+t.name;var m=document.createElement("span");n.appendChild(m),m.appendChild(l),m.appendChild(f);var y=t.overlay?this._overlaysList:this._baseLayersList;return y.appendChild(n),this._checkDisabledLayers(),n},_onInputClick:function(){if(!this._preventClick){var t=this._layerControlInputs,n,a,l=[],f=[];this._handlingClick=!0;for(var m=t.length-1;m>=0;m--)n=t[m],a=this._getLayer(n.layerId).layer,n.checked?l.push(a):n.checked||f.push(a);for(m=0;m<f.length;m++)this._map.hasLayer(f[m])&&this._map.removeLayer(f[m]);for(m=0;m<l.length;m++)this._map.hasLayer(l[m])||this._map.addLayer(l[m]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var t=this._layerControlInputs,n,a,l=this._map.getZoom(),f=t.length-1;f>=0;f--)n=t[f],a=this._getLayer(n.layerId).layer,n.disabled=a.options.minZoom!==void 0&&l<a.options.minZoom||a.options.maxZoom!==void 0&&l>a.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var t=this._section;this._preventClick=!0,X(t,"click",Tt),this.expand();var n=this;setTimeout(function(){dt(t,"click",Tt),n._preventClick=!1})}}),Kh=function(t,n,a){return new xr(t,n,a)},ia=Qt.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(t){var n="leaflet-control-zoom",a=ot("div",n+" leaflet-bar"),l=this.options;return this._zoomInButton=this._createButton(l.zoomInText,l.zoomInTitle,n+"-in",a,this._zoomIn),this._zoomOutButton=this._createButton(l.zoomOutText,l.zoomOutTitle,n+"-out",a,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),a},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,n,a,l,f){var m=ot("a",a,l);return m.innerHTML=t,m.href="#",m.title=n,m.setAttribute("role","button"),m.setAttribute("aria-label",n),Hi(m),X(m,"click",qe),X(m,"click",f,this),X(m,"click",this._refocusOnMap,this),m},_updateDisabled:function(){var t=this._map,n="leaflet-disabled";yt(this._zoomInButton,n),yt(this._zoomOutButton,n),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||t._zoom===t.getMinZoom())&&(J(this._zoomOutButton,n),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||t._zoom===t.getMaxZoom())&&(J(this._zoomInButton,n),this._zoomInButton.setAttribute("aria-disabled","true"))}});it.mergeOptions({zoomControl:!0}),it.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new ia,this.addControl(this.zoomControl))});var Xh=function(t){return new ia(t)},Pr=Qt.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var n="leaflet-control-scale",a=ot("div",n),l=this.options;return this._addScales(l,n+"-line",a),t.on(l.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),a},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,n,a){t.metric&&(this._mScale=ot("div",n,a)),t.imperial&&(this._iScale=ot("div",n,a))},_update:function(){var t=this._map,n=t.getSize().y/2,a=t.distance(t.containerPointToLatLng([0,n]),t.containerPointToLatLng([this.options.maxWidth,n]));this._updateScales(a)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var n=this._getRoundNum(t),a=n<1e3?n+" m":n/1e3+" km";this._updateScale(this._mScale,a,n/t)},_updateImperial:function(t){var n=t*3.2808399,a,l,f;n>5280?(a=n/5280,l=this._getRoundNum(a),this._updateScale(this._iScale,l+" mi",l/a)):(f=this._getRoundNum(n),this._updateScale(this._iScale,f+" ft",f/n))},_updateScale:function(t,n,a){t.style.width=Math.round(this.options.maxWidth*a)+"px",t.innerHTML=n},_getRoundNum:function(t){var n=Math.pow(10,(Math.floor(t)+"").length-1),a=t/n;return a=a>=10?10:a>=5?5:a>=3?3:a>=2?2:1,n*a}}),Yh=function(t){return new Pr(t)},Jh='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',na=Qt.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(z.inlineSvg?Jh+" ":"")+"Leaflet</a>"},initialize:function(t){P(this,t),this._attributions={}},onAdd:function(t){t.attributionControl=this,this._container=ot("div","leaflet-control-attribution"),Hi(this._container);for(var n in t._layers)t._layers[n].getAttribution&&this.addAttribution(t._layers[n].getAttribution());return this._update(),t.on("layeradd",this._addAttribution,this),this._container},onRemove:function(t){t.off("layeradd",this._addAttribution,this)},_addAttribution:function(t){t.layer.getAttribution&&(this.addAttribution(t.layer.getAttribution()),t.layer.once("remove",function(){this.removeAttribution(t.layer.getAttribution())},this))},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):this},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):this},_update:function(){if(this._map){var t=[];for(var n in this._attributions)this._attributions[n]&&t.push(n);var a=[];this.options.prefix&&a.push(this.options.prefix),t.length&&a.push(t.join(", ")),this._container.innerHTML=a.join(' <span aria-hidden="true">|</span> ')}}});it.mergeOptions({attributionControl:!0}),it.addInitHook(function(){this.options.attributionControl&&new na().addTo(this)});var Qh=function(t){return new na(t)};Qt.Layers=xr,Qt.Zoom=ia,Qt.Scale=Pr,Qt.Attribution=na,Vi.layers=Kh,Vi.zoom=Xh,Vi.scale=Yh,Vi.attribution=Qh;var re=mt.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});re.addTo=function(t,n){return t.addHandler(n,this),this};var tl={Events:et},br=z.touch?"touchstart mousedown":"mousedown",Te=Et.extend({options:{clickTolerance:3},initialize:function(t,n,a,l){P(this,l),this._element=t,this._dragStartTarget=n||t,this._preventOutline=a},enable:function(){this._enabled||(X(this._dragStartTarget,br,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Te._dragging===this&&this.finishDrag(!0),dt(this._dragStartTarget,br,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(this._enabled&&(this._moved=!1,!qs(this._element,"leaflet-zoom-anim"))){if(t.touches&&t.touches.length!==1){Te._dragging===this&&this.finishDrag();return}if(!(Te._dragging||t.shiftKey||t.which!==1&&t.button!==1&&!t.touches)&&(Te._dragging=this,this._preventOutline&&Ks(this._element),Hs(),qi(),!this._moving)){this.fire("down");var n=t.touches?t.touches[0]:t,a=gr(this._element);this._startPoint=new Z(n.clientX,n.clientY),this._startPos=Ze(this._element),this._parentScale=Xs(a);var l=t.type==="mousedown";X(document,l?"mousemove":"touchmove",this._onMove,this),X(document,l?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(t){if(this._enabled){if(t.touches&&t.touches.length>1){this._moved=!0;return}var n=t.touches&&t.touches.length===1?t.touches[0]:t,a=new Z(n.clientX,n.clientY)._subtract(this._startPoint);!a.x&&!a.y||Math.abs(a.x)+Math.abs(a.y)<this.options.clickTolerance||(a.x/=this._parentScale.x,a.y/=this._parentScale.y,Tt(t),this._moved||(this.fire("dragstart"),this._moved=!0,J(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),J(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(a),this._moving=!0,this._lastEvent=t,this._updatePosition())}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),wt(this._element,this._newPos),this.fire("drag",t)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(t){yt(document.body,"leaflet-dragging"),this._lastTarget&&(yt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),dt(document,"mousemove touchmove",this._onMove,this),dt(document,"mouseup touchend touchcancel",this._onUp,this),Vs(),ji();var n=this._moved&&this._moving;this._moving=!1,Te._dragging=!1,n&&this.fire("dragend",{noInertia:t,distance:this._newPos.distanceTo(this._startPos)})}});function Sr(t,n,a){var l,f=[1,4,2,8],m,y,b,E,C,D,H,Q;for(m=0,D=t.length;m<D;m++)t[m]._code=je(t[m],n);for(b=0;b<4;b++){for(H=f[b],l=[],m=0,D=t.length,y=D-1;m<D;y=m++)E=t[m],C=t[y],E._code&H?C._code&H||(Q=Vn(C,E,H,n,a),Q._code=je(Q,n),l.push(Q)):(C._code&H&&(Q=Vn(C,E,H,n,a),Q._code=je(Q,n),l.push(Q)),l.push(E));t=l}return t}function Er(t,n){var a,l,f,m,y,b,E,C,D;if(!t||t.length===0)throw new Error("latlngs not passed");$t(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var H=V([0,0]),Q=st(t),Nt=Q.getNorthWest().distanceTo(Q.getSouthWest())*Q.getNorthEast().distanceTo(Q.getNorthWest());Nt<1700&&(H=sa(t));var St=t.length,Ht=[];for(a=0;a<St;a++){var Dt=V(t[a]);Ht.push(n.project(V([Dt.lat-H.lat,Dt.lng-H.lng])))}for(b=E=C=0,a=0,l=St-1;a<St;l=a++)f=Ht[a],m=Ht[l],y=f.y*m.x-m.y*f.x,E+=(f.x+m.x)*y,C+=(f.y+m.y)*y,b+=y*3;b===0?D=Ht[0]:D=[E/b,C/b];var fi=n.unproject(U(D));return V([fi.lat+H.lat,fi.lng+H.lng])}function sa(t){for(var n=0,a=0,l=0,f=0;f<t.length;f++){var m=V(t[f]);n+=m.lat,a+=m.lng,l++}return V([n/l,a/l])}var el={__proto__:null,clipPolygon:Sr,polygonCenter:Er,centroid:sa};function Tr(t,n){if(!n||!t.length)return t.slice();var a=n*n;return t=sl(t,a),t=nl(t,a),t}function Lr(t,n,a){return Math.sqrt(Wi(t,n,a,!0))}function il(t,n,a){return Wi(t,n,a)}function nl(t,n){var a=t.length,l=typeof Uint8Array<"u"?Uint8Array:Array,f=new l(a);f[0]=f[a-1]=1,aa(t,f,n,0,a-1);var m,y=[];for(m=0;m<a;m++)f[m]&&y.push(t[m]);return y}function aa(t,n,a,l,f){var m=0,y,b,E;for(b=l+1;b<=f-1;b++)E=Wi(t[b],t[l],t[f],!0),E>m&&(y=b,m=E);m>a&&(n[y]=1,aa(t,n,a,l,y),aa(t,n,a,y,f))}function sl(t,n){for(var a=[t[0]],l=1,f=0,m=t.length;l<m;l++)al(t[l],t[f])>n&&(a.push(t[l]),f=l);return f<m-1&&a.push(t[m-1]),a}var Ar;function Cr(t,n,a,l,f){var m=l?Ar:je(t,a),y=je(n,a),b,E,C;for(Ar=y;;){if(!(m|y))return[t,n];if(m&y)return!1;b=m||y,E=Vn(t,n,b,a,f),C=je(E,a),b===m?(t=E,m=C):(n=E,y=C)}}function Vn(t,n,a,l,f){var m=n.x-t.x,y=n.y-t.y,b=l.min,E=l.max,C,D;return a&8?(C=t.x+m*(E.y-t.y)/y,D=E.y):a&4?(C=t.x+m*(b.y-t.y)/y,D=b.y):a&2?(C=E.x,D=t.y+y*(E.x-t.x)/m):a&1&&(C=b.x,D=t.y+y*(b.x-t.x)/m),new Z(C,D,f)}function je(t,n){var a=0;return t.x<n.min.x?a|=1:t.x>n.max.x&&(a|=2),t.y<n.min.y?a|=4:t.y>n.max.y&&(a|=8),a}function al(t,n){var a=n.x-t.x,l=n.y-t.y;return a*a+l*l}function Wi(t,n,a,l){var f=n.x,m=n.y,y=a.x-f,b=a.y-m,E=y*y+b*b,C;return E>0&&(C=((t.x-f)*y+(t.y-m)*b)/E,C>1?(f=a.x,m=a.y):C>0&&(f+=y*C,m+=b*C)),y=t.x-f,b=t.y-m,l?y*y+b*b:new Z(f,m)}function $t(t){return!S(t[0])||typeof t[0][0]!="object"&&typeof t[0][0]<"u"}function Gr(t){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),$t(t)}function Ir(t,n){var a,l,f,m,y,b,E,C;if(!t||t.length===0)throw new Error("latlngs not passed");$t(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var D=V([0,0]),H=st(t),Q=H.getNorthWest().distanceTo(H.getSouthWest())*H.getNorthEast().distanceTo(H.getNorthWest());Q<1700&&(D=sa(t));var Nt=t.length,St=[];for(a=0;a<Nt;a++){var Ht=V(t[a]);St.push(n.project(V([Ht.lat-D.lat,Ht.lng-D.lng])))}for(a=0,l=0;a<Nt-1;a++)l+=St[a].distanceTo(St[a+1])/2;if(l===0)C=St[0];else for(a=0,m=0;a<Nt-1;a++)if(y=St[a],b=St[a+1],f=y.distanceTo(b),m+=f,m>l){E=(m-l)/f,C=[b.x-E*(b.x-y.x),b.y-E*(b.y-y.y)];break}var Dt=n.unproject(U(C));return V([Dt.lat+D.lat,Dt.lng+D.lng])}var rl={__proto__:null,simplify:Tr,pointToSegmentDistance:Lr,closestPointOnSegment:il,clipSegment:Cr,_getEdgeIntersection:Vn,_getBitCode:je,_sqClosestPointOnSegment:Wi,isFlat:$t,_flat:Gr,polylineCenter:Ir},ra={project:function(t){return new Z(t.lng,t.lat)},unproject:function(t){return new W(t.y,t.x)},bounds:new at([-180,-90],[180,90])},oa={R:6378137,R_MINOR:6356752314245179e-9,bounds:new at([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(t){var n=Math.PI/180,a=this.R,l=t.lat*n,f=this.R_MINOR/a,m=Math.sqrt(1-f*f),y=m*Math.sin(l),b=Math.tan(Math.PI/4-l/2)/Math.pow((1-y)/(1+y),m/2);return l=-a*Math.log(Math.max(b,1e-10)),new Z(t.lng*n*a,l)},unproject:function(t){for(var n=180/Math.PI,a=this.R,l=this.R_MINOR/a,f=Math.sqrt(1-l*l),m=Math.exp(-t.y/a),y=Math.PI/2-2*Math.atan(m),b=0,E=.1,C;b<15&&Math.abs(E)>1e-7;b++)C=f*Math.sin(y),C=Math.pow((1-C)/(1+C),f/2),E=Math.PI/2-2*Math.atan(m*C)-y,y+=E;return new W(y*n,t.x*n/a)}},ol={__proto__:null,LonLat:ra,Mercator:oa,SphericalMercator:Wt},hl=r({},Ut,{code:"EPSG:3395",projection:oa,transformation:function(){var t=.5/(Math.PI*oa.R);return De(t,.5,-t,.5)}()}),Nr=r({},Ut,{code:"EPSG:4326",projection:ra,transformation:De(1/180,1,-1/180,.5)}),ll=r({},bt,{projection:ra,transformation:De(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,n){var a=n.lng-t.lng,l=n.lat-t.lat;return Math.sqrt(a*a+l*l)},infinite:!0});bt.Earth=Ut,bt.EPSG3395=hl,bt.EPSG3857=Ai,bt.EPSG900913=Is,bt.EPSG4326=Nr,bt.Simple=ll;var te=Et.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[d(t)]=this,this},removeInteractiveTarget:function(t){return delete this._map._targets[d(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var n=t.target;if(n.hasLayer(this)){if(this._map=n,this._zoomAnimated=n._zoomAnimated,this.getEvents){var a=this.getEvents();n.on(a,this),this.once("remove",function(){n.off(a,this)},this)}this.onAdd(n),this.fire("add"),n.fire("layeradd",{layer:this})}}});it.include({addLayer:function(t){if(!t._layerAdd)throw new Error("The provided object is not a Layer.");var n=d(t);return this._layers[n]?this:(this._layers[n]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t),this)},removeLayer:function(t){var n=d(t);return this._layers[n]?(this._loaded&&t.onRemove(this),delete this._layers[n],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return d(t)in this._layers},eachLayer:function(t,n){for(var a in this._layers)t.call(n,this._layers[a]);return this},_addLayers:function(t){t=t?S(t)?t:[t]:[];for(var n=0,a=t.length;n<a;n++)this.addLayer(t[n])},_addZoomLimit:function(t){(!isNaN(t.options.maxZoom)||!isNaN(t.options.minZoom))&&(this._zoomBoundLayers[d(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var n=d(t);this._zoomBoundLayers[n]&&(delete this._zoomBoundLayers[n],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,n=-1/0,a=this._getZoomSpan();for(var l in this._zoomBoundLayers){var f=this._zoomBoundLayers[l].options;t=f.minZoom===void 0?t:Math.min(t,f.minZoom),n=f.maxZoom===void 0?n:Math.max(n,f.maxZoom)}this._layersMaxZoom=n===-1/0?void 0:n,this._layersMinZoom=t===1/0?void 0:t,a!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var oi=te.extend({initialize:function(t,n){P(this,n),this._layers={};var a,l;if(t)for(a=0,l=t.length;a<l;a++)this.addLayer(t[a])},addLayer:function(t){var n=this.getLayerId(t);return this._layers[n]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var n=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[n]&&this._map.removeLayer(this._layers[n]),delete this._layers[n],this},hasLayer:function(t){var n=typeof t=="number"?t:this.getLayerId(t);return n in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(t){var n=Array.prototype.slice.call(arguments,1),a,l;for(a in this._layers)l=this._layers[a],l[t]&&l[t].apply(l,n);return this},onAdd:function(t){this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t)},eachLayer:function(t,n){for(var a in this._layers)t.call(n,this._layers[a]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];return this.eachLayer(t.push,t),t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return d(t)}}),cl=function(t,n){return new oi(t,n)},ve=oi.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),oi.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),oi.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new ut;for(var n in this._layers){var a=this._layers[n];t.extend(a.getBounds?a.getBounds():a.getLatLng())}return t}}),ul=function(t,n){return new ve(t,n)},hi=mt.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(t){P(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,n){var a=this._getIconUrl(t);if(!a){if(t==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var l=this._createImg(a,n&&n.tagName==="IMG"?n:null);return this._setIconStyles(l,t),(this.options.crossOrigin||this.options.crossOrigin==="")&&(l.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),l},_setIconStyles:function(t,n){var a=this.options,l=a[n+"Size"];typeof l=="number"&&(l=[l,l]);var f=U(l),m=U(n==="shadow"&&a.shadowAnchor||a.iconAnchor||f&&f.divideBy(2,!0));t.className="leaflet-marker-"+n+" "+(a.className||""),m&&(t.style.marginLeft=-m.x+"px",t.style.marginTop=-m.y+"px"),f&&(t.style.width=f.x+"px",t.style.height=f.y+"px")},_createImg:function(t,n){return n=n||document.createElement("img"),n.src=t,n},_getIconUrl:function(t){return z.retina&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}});function fl(t){return new hi(t)}var Ki=hi.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return typeof Ki.imagePath!="string"&&(Ki.imagePath=this._detectIconPath()),(this.options.imagePath||Ki.imagePath)+hi.prototype._getIconUrl.call(this,t)},_stripUrl:function(t){var n=function(a,l,f){var m=l.exec(a);return m&&m[f]};return t=n(t,/^url\((['"])?(.+)\1\)$/,2),t&&n(t,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var t=ot("div","leaflet-default-icon-path",document.body),n=Ui(t,"background-image")||Ui(t,"backgroundImage");if(document.body.removeChild(t),n=this._stripUrl(n),n)return n;var a=document.querySelector('link[href$="leaflet.css"]');return a?a.href.substring(0,a.href.length-11-1):""}}),Or=re.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new Te(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),J(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&yt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(t){var n=this._marker,a=n._map,l=this._marker.options.autoPanSpeed,f=this._marker.options.autoPanPadding,m=Ze(n._icon),y=a.getPixelBounds(),b=a.getPixelOrigin(),E=rt(y.min._subtract(b).add(f),y.max._subtract(b).subtract(f));if(!E.contains(m)){var C=U((Math.max(E.max.x,m.x)-E.max.x)/(y.max.x-E.max.x)-(Math.min(E.min.x,m.x)-E.min.x)/(y.min.x-E.min.x),(Math.max(E.max.y,m.y)-E.max.y)/(y.max.y-E.max.y)-(Math.min(E.min.y,m.y)-E.min.y)/(y.min.y-E.min.y)).multiplyBy(l);a.panBy(C,{animate:!1}),this._draggable._newPos._add(C),this._draggable._startPos._add(C),wt(n._icon,this._draggable._newPos),this._onDrag(t),this._panRequest=F(this._adjustPan.bind(this,t))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(t){this._marker.options.autoPan&&(K(this._panRequest),this._panRequest=F(this._adjustPan.bind(this,t)))},_onDrag:function(t){var n=this._marker,a=n._shadow,l=Ze(n._icon),f=n._map.layerPointToLatLng(l);a&&wt(a,l),n._latlng=f,t.latlng=f,t.oldLatLng=this._oldLatLng,n.fire("move",t).fire("drag",t)},_onDragEnd:function(t){K(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),Wn=te.extend({options:{icon:new Ki,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(t,n){P(this,n),this._latlng=V(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var n=this._latlng;return this._latlng=V(t),this.update(),this.fire("move",{oldLatLng:n,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},getIcon:function(){return this.options.icon},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,n="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),a=t.icon.createIcon(this._icon),l=!1;a!==this._icon&&(this._icon&&this._removeIcon(),l=!0,t.title&&(a.title=t.title),a.tagName==="IMG"&&(a.alt=t.alt||"")),J(a,n),t.keyboard&&(a.tabIndex="0",a.setAttribute("role","button")),this._icon=a,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&X(a,"focus",this._panOnFocus,this);var f=t.icon.createShadow(this._shadow),m=!1;f!==this._shadow&&(this._removeShadow(),m=!0),f&&(J(f,n),f.alt=""),this._shadow=f,t.opacity<1&&this._updateOpacity(),l&&this.getPane().appendChild(this._icon),this._initInteraction(),f&&m&&this.getPane(t.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&dt(this._icon,"focus",this._panOnFocus,this),pt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&pt(this._shadow),this._shadow=null},_setPos:function(t){this._icon&&wt(this._icon,t),this._shadow&&wt(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon&&(this._icon.style.zIndex=this._zIndex+t)},_animateZoom:function(t){var n=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(n)},_initInteraction:function(){if(this.options.interactive&&(J(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Or)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Or(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;this._icon&&jt(this._icon,t),this._shadow&&jt(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var t=this._map;if(t){var n=this.options.icon.options,a=n.iconSize?U(n.iconSize):U(0,0),l=n.iconAnchor?U(n.iconAnchor):U(0,0);t.panInside(this._latlng,{paddingTopLeft:l,paddingBottomRight:a.subtract(l)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function dl(t,n){return new Wn(t,n)}var Le=te.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return P(this,t),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&t&&Object.prototype.hasOwnProperty.call(t,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Kn=Le.extend({options:{fill:!0,radius:10},initialize:function(t,n){P(this,n),this._latlng=V(t),this._radius=this.options.radius},setLatLng:function(t){var n=this._latlng;return this._latlng=V(t),this.redraw(),this.fire("move",{oldLatLng:n,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var n=t&&t.radius||this._radius;return Le.prototype.setStyle.call(this,t),this.setRadius(n),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,n=this._radiusY||t,a=this._clickTolerance(),l=[t+a,n+a];this._pxBounds=new at(this._point.subtract(l),this._point.add(l))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function _l(t,n){return new Kn(t,n)}var ha=Kn.extend({initialize:function(t,n,a){if(typeof n=="number"&&(n=r({},a,{radius:n})),P(this,n),this._latlng=V(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new ut(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:Le.prototype.setStyle,_project:function(){var t=this._latlng.lng,n=this._latlng.lat,a=this._map,l=a.options.crs;if(l.distance===Ut.distance){var f=Math.PI/180,m=this._mRadius/Ut.R/f,y=a.project([n+m,t]),b=a.project([n-m,t]),E=y.add(b).divideBy(2),C=a.unproject(E).lat,D=Math.acos((Math.cos(m*f)-Math.sin(n*f)*Math.sin(C*f))/(Math.cos(n*f)*Math.cos(C*f)))/f;(isNaN(D)||D===0)&&(D=m/Math.cos(Math.PI/180*n)),this._point=E.subtract(a.getPixelOrigin()),this._radius=isNaN(D)?0:E.x-a.project([C,t-D]).x,this._radiusY=E.y-y.y}else{var H=l.unproject(l.project(this._latlng).subtract([this._mRadius,0]));this._point=a.latLngToLayerPoint(this._latlng),this._radius=this._point.x-a.latLngToLayerPoint(H).x}this._updateBounds()}});function ml(t,n,a){return new ha(t,n,a)}var ye=Le.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,n){P(this,n),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var n=1/0,a=null,l=Wi,f,m,y=0,b=this._parts.length;y<b;y++)for(var E=this._parts[y],C=1,D=E.length;C<D;C++){f=E[C-1],m=E[C];var H=l(t,f,m,!0);H<n&&(n=H,a=l(t,f,m))}return a&&(a.distance=Math.sqrt(n)),a},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Ir(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(t,n){return n=n||this._defaultShape(),t=V(t),n.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new ut,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return $t(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var n=[],a=$t(t),l=0,f=t.length;l<f;l++)a?(n[l]=V(t[l]),this._bounds.extend(n[l])):n[l]=this._convertLatLngs(t[l]);return n},_project:function(){var t=new at;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t),this._bounds.isValid()&&t.isValid()&&(this._rawPxBounds=t,this._updateBounds())},_updateBounds:function(){var t=this._clickTolerance(),n=new Z(t,t);this._rawPxBounds&&(this._pxBounds=new at([this._rawPxBounds.min.subtract(n),this._rawPxBounds.max.add(n)]))},_projectLatlngs:function(t,n,a){var l=t[0]instanceof W,f=t.length,m,y;if(l){for(y=[],m=0;m<f;m++)y[m]=this._map.latLngToLayerPoint(t[m]),a.extend(y[m]);n.push(y)}else for(m=0;m<f;m++)this._projectLatlngs(t[m],n,a)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(t))){if(this.options.noClip){this._parts=this._rings;return}var n=this._parts,a,l,f,m,y,b,E;for(a=0,f=0,m=this._rings.length;a<m;a++)for(E=this._rings[a],l=0,y=E.length;l<y-1;l++)b=Cr(E[l],E[l+1],t,l,!0),b&&(n[f]=n[f]||[],n[f].push(b[0]),(b[1]!==E[l+1]||l===y-2)&&(n[f].push(b[1]),f++))}},_simplifyPoints:function(){for(var t=this._parts,n=this.options.smoothFactor,a=0,l=t.length;a<l;a++)t[a]=Tr(t[a],n)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(t,n){var a,l,f,m,y,b,E=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(a=0,m=this._parts.length;a<m;a++)for(b=this._parts[a],l=0,y=b.length,f=y-1;l<y;f=l++)if(!(!n&&l===0)&&Lr(t,b[f],b[l])<=E)return!0;return!1}});function gl(t,n){return new ye(t,n)}ye._flat=Gr;var li=ye.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Er(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(t){var n=ye.prototype._convertLatLngs.call(this,t),a=n.length;return a>=2&&n[0]instanceof W&&n[0].equals(n[a-1])&&n.pop(),n},_setLatLngs:function(t){ye.prototype._setLatLngs.call(this,t),$t(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return $t(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,n=this.options.weight,a=new Z(n,n);if(t=new at(t.min.subtract(a),t.max.add(a)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(t))){if(this.options.noClip){this._parts=this._rings;return}for(var l=0,f=this._rings.length,m;l<f;l++)m=Sr(this._rings[l],t,!0),m.length&&this._parts.push(m)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(t){var n=!1,a,l,f,m,y,b,E,C;if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(m=0,E=this._parts.length;m<E;m++)for(a=this._parts[m],y=0,C=a.length,b=C-1;y<C;b=y++)l=a[y],f=a[b],l.y>t.y!=f.y>t.y&&t.x<(f.x-l.x)*(t.y-l.y)/(f.y-l.y)+l.x&&(n=!n);return n||ye.prototype._containsPoint.call(this,t,!0)}});function pl(t,n){return new li(t,n)}var Me=ve.extend({initialize:function(t,n){P(this,n),this._layers={},t&&this.addData(t)},addData:function(t){var n=S(t)?t:t.features,a,l,f;if(n){for(a=0,l=n.length;a<l;a++)f=n[a],(f.geometries||f.geometry||f.features||f.coordinates)&&this.addData(f);return this}var m=this.options;if(m.filter&&!m.filter(t))return this;var y=Xn(t,m);return y?(y.feature=Qn(t),y.defaultOptions=y.options,this.resetStyle(y),m.onEachFeature&&m.onEachFeature(t,y),this.addLayer(y)):this},resetStyle:function(t){return t===void 0?this.eachLayer(this.resetStyle,this):(t.options=r({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this)},setStyle:function(t){return this.eachLayer(function(n){this._setLayerStyle(n,t)},this)},_setLayerStyle:function(t,n){t.setStyle&&(typeof n=="function"&&(n=n(t.feature)),t.setStyle(n))}});function Xn(t,n){var a=t.type==="Feature"?t.geometry:t,l=a?a.coordinates:null,f=[],m=n&&n.pointToLayer,y=n&&n.coordsToLatLng||la,b,E,C,D;if(!l&&!a)return null;switch(a.type){case"Point":return b=y(l),Rr(m,t,b,n);case"MultiPoint":for(C=0,D=l.length;C<D;C++)b=y(l[C]),f.push(Rr(m,t,b,n));return new ve(f);case"LineString":case"MultiLineString":return E=Yn(l,a.type==="LineString"?0:1,y),new ye(E,n);case"Polygon":case"MultiPolygon":return E=Yn(l,a.type==="Polygon"?1:2,y),new li(E,n);case"GeometryCollection":for(C=0,D=a.geometries.length;C<D;C++){var H=Xn({geometry:a.geometries[C],type:"Feature",properties:t.properties},n);H&&f.push(H)}return new ve(f);case"FeatureCollection":for(C=0,D=a.features.length;C<D;C++){var Q=Xn(a.features[C],n);Q&&f.push(Q)}return new ve(f);default:throw new Error("Invalid GeoJSON object.")}}function Rr(t,n,a,l){return t?t(n,a):new Wn(a,l&&l.markersInheritOptions&&l)}function la(t){return new W(t[1],t[0],t[2])}function Yn(t,n,a){for(var l=[],f=0,m=t.length,y;f<m;f++)y=n?Yn(t[f],n-1,a):(a||la)(t[f]),l.push(y);return l}function ca(t,n){return t=V(t),t.alt!==void 0?[p(t.lng,n),p(t.lat,n),p(t.alt,n)]:[p(t.lng,n),p(t.lat,n)]}function Jn(t,n,a,l){for(var f=[],m=0,y=t.length;m<y;m++)f.push(n?Jn(t[m],$t(t[m])?0:n-1,a,l):ca(t[m],l));return!n&&a&&f.length>0&&f.push(f[0].slice()),f}function ci(t,n){return t.feature?r({},t.feature,{geometry:n}):Qn(n)}function Qn(t){return t.type==="Feature"||t.type==="FeatureCollection"?t:{type:"Feature",properties:{},geometry:t}}var ua={toGeoJSON:function(t){return ci(this,{type:"Point",coordinates:ca(this.getLatLng(),t)})}};Wn.include(ua),ha.include(ua),Kn.include(ua),ye.include({toGeoJSON:function(t){var n=!$t(this._latlngs),a=Jn(this._latlngs,n?1:0,!1,t);return ci(this,{type:(n?"Multi":"")+"LineString",coordinates:a})}}),li.include({toGeoJSON:function(t){var n=!$t(this._latlngs),a=n&&!$t(this._latlngs[0]),l=Jn(this._latlngs,a?2:n?1:0,!0,t);return n||(l=[l]),ci(this,{type:(a?"Multi":"")+"Polygon",coordinates:l})}}),oi.include({toMultiPoint:function(t){var n=[];return this.eachLayer(function(a){n.push(a.toGeoJSON(t).geometry.coordinates)}),ci(this,{type:"MultiPoint",coordinates:n})},toGeoJSON:function(t){var n=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(n==="MultiPoint")return this.toMultiPoint(t);var a=n==="GeometryCollection",l=[];return this.eachLayer(function(f){if(f.toGeoJSON){var m=f.toGeoJSON(t);if(a)l.push(m.geometry);else{var y=Qn(m);y.type==="FeatureCollection"?l.push.apply(l,y.features):l.push(y)}}}),a?ci(this,{geometries:l,type:"GeometryCollection"}):{type:"FeatureCollection",features:l}}});function kr(t,n){return new Me(t,n)}var vl=kr,ts=te.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(t,n,a){this._url=t,this._bounds=st(n),P(this,a)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(J(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){pt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&ai(this._image),this},bringToBack:function(){return this._map&&ri(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=st(t),this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t=this._url.tagName==="IMG",n=this._image=t?this._url:ot("img");if(J(n,"leaflet-image-layer"),this._zoomAnimated&&J(n,"leaflet-zoom-animated"),this.options.className&&J(n,this.options.className),n.onselectstart=g,n.onmousemove=g,n.onload=u(this.fire,this,"load"),n.onerror=u(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(n.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),t){this._url=n.src;return}n.src=this._url,n.alt=this.options.alt},_animateZoom:function(t){var n=this._map.getZoomScale(t.zoom),a=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;Fe(this._image,a,n)},_reset:function(){var t=this._image,n=new at(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),a=n.getSize();wt(t,n.min),t.style.width=a.x+"px",t.style.height=a.y+"px"},_updateOpacity:function(){jt(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var t=this.options.errorOverlayUrl;t&&this._url!==t&&(this._url=t,this._image.src=t)},getCenter:function(){return this._bounds.getCenter()}}),yl=function(t,n,a){return new ts(t,n,a)},Dr=ts.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var t=this._url.tagName==="VIDEO",n=this._image=t?this._url:ot("video");if(J(n,"leaflet-image-layer"),this._zoomAnimated&&J(n,"leaflet-zoom-animated"),this.options.className&&J(n,this.options.className),n.onselectstart=g,n.onmousemove=g,n.onloadeddata=u(this.fire,this,"load"),t){for(var a=n.getElementsByTagName("source"),l=[],f=0;f<a.length;f++)l.push(a[f].src);this._url=a.length>0?l:[n.src];return}S(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(n.style,"objectFit")&&(n.style.objectFit="fill"),n.autoplay=!!this.options.autoplay,n.loop=!!this.options.loop,n.muted=!!this.options.muted,n.playsInline=!!this.options.playsInline;for(var m=0;m<this._url.length;m++){var y=ot("source");y.src=this._url[m],n.appendChild(y)}}});function Ml(t,n,a){return new Dr(t,n,a)}var Br=ts.extend({_initImage:function(){var t=this._image=this._url;J(t,"leaflet-image-layer"),this._zoomAnimated&&J(t,"leaflet-zoom-animated"),this.options.className&&J(t,this.options.className),t.onselectstart=g,t.onmousemove=g}});function wl(t,n,a){return new Br(t,n,a)}var oe=te.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(t,n){t&&(t instanceof W||S(t))?(this._latlng=V(t),P(this,n)):(P(this,t),this._source=n),this.options.content&&(this._content=this.options.content)},openOn:function(t){return t=arguments.length?t:this._source._map,t.hasLayer(this)||t.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(t){return this._map?this.close():(arguments.length?this._source=t:t=this._source,this._prepareOpen(),this.openOn(t._map)),this},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&jt(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&jt(this._container,1),this.bringToFront(),this.options.interactive&&(J(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(t){t._fadeAnimated?(jt(this._container,0),this._removeTimeout=setTimeout(u(pt,void 0,this._container),200)):pt(this._container),this.options.interactive&&(yt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=V(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&ai(this._container),this},bringToBack:function(){return this._map&&ri(this._container),this},_prepareOpen:function(t){var n=this._source;if(!n._map)return!1;if(n instanceof ve){n=null;var a=this._source._layers;for(var l in a)if(a[l]._map){n=a[l];break}if(!n)return!1;this._source=n}if(!t)if(n.getCenter)t=n.getCenter();else if(n.getLatLng)t=n.getLatLng();else if(n.getBounds)t=n.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(t),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var t=this._contentNode,n=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof n=="string")t.innerHTML=n;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(n)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),n=U(this.options.offset),a=this._getAnchor();this._zoomAnimated?wt(this._container,t.add(a)):n=n.add(t).add(a);var l=this._containerBottom=-n.y,f=this._containerLeft=-Math.round(this._containerWidth/2)+n.x;this._container.style.bottom=l+"px",this._container.style.left=f+"px"}},_getAnchor:function(){return[0,0]}});it.include({_initOverlay:function(t,n,a,l){var f=n;return f instanceof t||(f=new t(l).setContent(n)),a&&f.setLatLng(a),f}}),te.include({_initOverlay:function(t,n,a,l){var f=a;return f instanceof t?(P(f,l),f._source=this):(f=n&&!l?n:new t(l,this),f.setContent(a)),f}});var es=oe.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(t){return t=arguments.length?t:this._source._map,!t.hasLayer(this)&&t._popup&&t._popup.options.autoClose&&t.removeLayer(t._popup),t._popup=this,oe.prototype.openOn.call(this,t)},onAdd:function(t){oe.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Le||this._source.on("preclick",Ue))},onRemove:function(t){oe.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Le||this._source.off("preclick",Ue))},getEvents:function(){var t=oe.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this.close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_initLayout:function(){var t="leaflet-popup",n=this._container=ot("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated"),a=this._wrapper=ot("div",t+"-content-wrapper",n);if(this._contentNode=ot("div",t+"-content",a),Hi(n),ta(this._contentNode),X(n,"contextmenu",Ue),this._tipContainer=ot("div",t+"-tip-container",n),this._tip=ot("div",t+"-tip",this._tipContainer),this.options.closeButton){var l=this._closeButton=ot("a",t+"-close-button",n);l.setAttribute("role","button"),l.setAttribute("aria-label","Close popup"),l.href="#close",l.innerHTML='<span aria-hidden="true">&#215;</span>',X(l,"click",function(f){Tt(f),this.close()},this)}},_updateLayout:function(){var t=this._contentNode,n=t.style;n.width="",n.whiteSpace="nowrap";var a=t.offsetWidth;a=Math.min(a,this.options.maxWidth),a=Math.max(a,this.options.minWidth),n.width=a+1+"px",n.whiteSpace="",n.height="";var l=t.offsetHeight,f=this.options.maxHeight,m="leaflet-popup-scrolled";f&&l>f?(n.height=f+"px",J(t,m)):yt(t,m),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var n=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),a=this._getAnchor();wt(this._container,n.add(a))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var t=this._map,n=parseInt(Ui(this._container,"marginBottom"),10)||0,a=this._container.offsetHeight+n,l=this._containerWidth,f=new Z(this._containerLeft,-a-this._containerBottom);f._add(Ze(this._container));var m=t.layerPointToContainerPoint(f),y=U(this.options.autoPanPadding),b=U(this.options.autoPanPaddingTopLeft||y),E=U(this.options.autoPanPaddingBottomRight||y),C=t.getSize(),D=0,H=0;m.x+l+E.x>C.x&&(D=m.x+l-C.x+E.x),m.x-D-b.x<0&&(D=m.x-b.x),m.y+a+E.y>C.y&&(H=m.y+a-C.y+E.y),m.y-H-b.y<0&&(H=m.y-b.y),(D||H)&&(this.options.keepInView&&(this._autopanning=!0),t.fire("autopanstart").panBy([D,H]))}},_getAnchor:function(){return U(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),xl=function(t,n){return new es(t,n)};it.mergeOptions({closePopupOnClick:!0}),it.include({openPopup:function(t,n,a){return this._initOverlay(es,t,n,a).openOn(this),this},closePopup:function(t){return t=arguments.length?t:this._popup,t&&t.close(),this}}),te.include({bindPopup:function(t,n){return this._popup=this._initOverlay(es,this._popup,t,n),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t){return this._popup&&(this instanceof ve||(this._popup._source=this),this._popup._prepareOpen(t||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){if(!(!this._popup||!this._map)){qe(t);var n=t.layer||t.target;if(this._popup._source===n&&!(n instanceof Le)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(t.latlng);return}this._popup._source=n,this.openPopup(t.latlng)}},_movePopup:function(t){this._popup.setLatLng(t.latlng)},_onKeyPress:function(t){t.originalEvent.keyCode===13&&this._openPopup(t)}});var is=oe.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(t){oe.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(t){oe.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var t=oe.prototype.getEvents.call(this);return this.options.permanent||(t.preclick=this.close),t},_initLayout:function(){var t="leaflet-tooltip",n=t+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=ot("div",n),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+d(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var n,a,l=this._map,f=this._container,m=l.latLngToContainerPoint(l.getCenter()),y=l.layerPointToContainerPoint(t),b=this.options.direction,E=f.offsetWidth,C=f.offsetHeight,D=U(this.options.offset),H=this._getAnchor();b==="top"?(n=E/2,a=C):b==="bottom"?(n=E/2,a=0):b==="center"?(n=E/2,a=C/2):b==="right"?(n=0,a=C/2):b==="left"?(n=E,a=C/2):y.x<m.x?(b="right",n=0,a=C/2):(b="left",n=E+(D.x+H.x)*2,a=C/2),t=t.subtract(U(n,a,!0)).add(D).add(H),yt(f,"leaflet-tooltip-right"),yt(f,"leaflet-tooltip-left"),yt(f,"leaflet-tooltip-top"),yt(f,"leaflet-tooltip-bottom"),J(f,"leaflet-tooltip-"+b),wt(f,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&jt(this._container,t)},_animateZoom:function(t){var n=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(n)},_getAnchor:function(){return U(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Pl=function(t,n){return new is(t,n)};it.include({openTooltip:function(t,n,a){return this._initOverlay(is,t,n,a).openOn(this),this},closeTooltip:function(t){return t.close(),this}}),te.include({bindTooltip:function(t,n){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(is,this._tooltip,t,n),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){if(!(!t&&this._tooltipHandlersAdded)){var n=t?"off":"on",a={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?a.add=this._openTooltip:(a.mouseover=this._openTooltip,a.mouseout=this.closeTooltip,a.click=this._openTooltip,this._map?this._addFocusListeners():a.add=this._addFocusListeners),this._tooltip.options.sticky&&(a.mousemove=this._moveTooltip),this[n](a),this._tooltipHandlersAdded=!t}},openTooltip:function(t){return this._tooltip&&(this instanceof ve||(this._tooltip._source=this),this._tooltip._prepareOpen(t)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(t){var n=typeof t.getElement=="function"&&t.getElement();n&&(X(n,"focus",function(){this._tooltip._source=t,this.openTooltip()},this),X(n,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(t){var n=typeof t.getElement=="function"&&t.getElement();n&&n.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(t){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var n=this;this._map.once("moveend",function(){n._openOnceFlag=!1,n._openTooltip(t)});return}this._tooltip._source=t.layer||t.target,this.openTooltip(this._tooltip.options.sticky?t.latlng:void 0)}},_moveTooltip:function(t){var n=t.latlng,a,l;this._tooltip.options.sticky&&t.originalEvent&&(a=this._map.mouseEventToContainerPoint(t.originalEvent),l=this._map.containerPointToLayerPoint(a),n=this._map.layerPointToLatLng(l)),this._tooltip.setLatLng(n)}});var zr=hi.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var n=t&&t.tagName==="DIV"?t:document.createElement("div"),a=this.options;if(a.html instanceof Element?(Un(n),n.appendChild(a.html)):n.innerHTML=a.html!==!1?a.html:"",a.bgPos){var l=U(a.bgPos);n.style.backgroundPosition=-l.x+"px "+-l.y+"px"}return this._setIconStyles(n,"icon"),n},createShadow:function(){return null}});function bl(t){return new zr(t)}hi.Default=Ki;var Xi=te.extend({options:{tileSize:256,opacity:1,updateWhenIdle:z.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){P(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),pt(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(ai(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(ri(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var t=this._clampZoom(this._map.getZoom());t!==this._tileZoom&&(this._tileZoom=t,this._updateLevels()),this._update()}return this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=_(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return document.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof Z?t:new Z(t,t)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var n=this.getPane().children,a=-t(-1/0,1/0),l=0,f=n.length,m;l<f;l++)m=n[l].style.zIndex,n[l]!==this._container&&m&&(a=t(a,+m));isFinite(a)&&(this.options.zIndex=a+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!z.ielt9){jt(this._container,this.options.opacity);var t=+new Date,n=!1,a=!1;for(var l in this._tiles){var f=this._tiles[l];if(!(!f.current||!f.loaded)){var m=Math.min(1,(t-f.loaded)/200);jt(f.el,m),m<1?n=!0:(f.active?a=!0:this._onOpaqueTile(f),f.active=!0)}}a&&!this._noPrune&&this._pruneTiles(),n&&(K(this._fadeFrame),this._fadeFrame=F(this._updateOpacity,this))}},_onOpaqueTile:g,_initContainer:function(){this._container||(this._container=ot("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,n=this.options.maxZoom;if(t!==void 0){for(var a in this._levels)a=Number(a),this._levels[a].el.children.length||a===t?(this._levels[a].el.style.zIndex=n-Math.abs(t-a),this._onUpdateLevel(a)):(pt(this._levels[a].el),this._removeTilesAtZoom(a),this._onRemoveLevel(a),delete this._levels[a]);var l=this._levels[t],f=this._map;return l||(l=this._levels[t]={},l.el=ot("div","leaflet-tile-container leaflet-zoom-animated",this._container),l.el.style.zIndex=n,l.origin=f.project(f.unproject(f.getPixelOrigin()),t).round(),l.zoom=t,this._setZoomTransform(l,f.getCenter(),f.getZoom()),g(l.el.offsetWidth),this._onCreateLevel(l)),this._level=l,l}},_onUpdateLevel:g,_onRemoveLevel:g,_onCreateLevel:g,_pruneTiles:function(){if(this._map){var t,n,a=this._map.getZoom();if(a>this.options.maxZoom||a<this.options.minZoom){this._removeAllTiles();return}for(t in this._tiles)n=this._tiles[t],n.retain=n.current;for(t in this._tiles)if(n=this._tiles[t],n.current&&!n.active){var l=n.coords;this._retainParent(l.x,l.y,l.z,l.z-5)||this._retainChildren(l.x,l.y,l.z,l.z+2)}for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}},_removeTilesAtZoom:function(t){for(var n in this._tiles)this._tiles[n].coords.z===t&&this._removeTile(n)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)pt(this._levels[t].el),this._onRemoveLevel(Number(t)),delete this._levels[t];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(t,n,a,l){var f=Math.floor(t/2),m=Math.floor(n/2),y=a-1,b=new Z(+f,+m);b.z=+y;var E=this._tileCoordsToKey(b),C=this._tiles[E];return C&&C.active?(C.retain=!0,!0):(C&&C.loaded&&(C.retain=!0),y>l?this._retainParent(f,m,y,l):!1)},_retainChildren:function(t,n,a,l){for(var f=2*t;f<2*t+2;f++)for(var m=2*n;m<2*n+2;m++){var y=new Z(f,m);y.z=a+1;var b=this._tileCoordsToKey(y),E=this._tiles[b];if(E&&E.active){E.retain=!0;continue}else E&&E.loaded&&(E.retain=!0);a+1<l&&this._retainChildren(f,m,a+1,l)}},_resetView:function(t){var n=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),n,n)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_clampZoom:function(t){var n=this.options;return n.minNativeZoom!==void 0&&t<n.minNativeZoom?n.minNativeZoom:n.maxNativeZoom!==void 0&&n.maxNativeZoom<t?n.maxNativeZoom:t},_setView:function(t,n,a,l){var f=Math.round(n);this.options.maxZoom!==void 0&&f>this.options.maxZoom||this.options.minZoom!==void 0&&f<this.options.minZoom?f=void 0:f=this._clampZoom(f);var m=this.options.updateWhenZooming&&f!==this._tileZoom;(!l||m)&&(this._tileZoom=f,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),f!==void 0&&this._update(t),a||this._pruneTiles(),this._noPrune=!!a),this._setZoomTransforms(t,n)},_setZoomTransforms:function(t,n){for(var a in this._levels)this._setZoomTransform(this._levels[a],t,n)},_setZoomTransform:function(t,n,a){var l=this._map.getZoomScale(a,t.zoom),f=t.origin.multiplyBy(l).subtract(this._map._getNewPixelOrigin(n,a)).round();z.any3d?Fe(t.el,f,l):wt(t.el,f)},_resetGrid:function(){var t=this._map,n=t.options.crs,a=this._tileSize=this.getTileSize(),l=this._tileZoom,f=this._map.getPixelWorldBounds(this._tileZoom);f&&(this._globalTileRange=this._pxBoundsToTileRange(f)),this._wrapX=n.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,n.wrapLng[0]],l).x/a.x),Math.ceil(t.project([0,n.wrapLng[1]],l).x/a.y)],this._wrapY=n.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([n.wrapLat[0],0],l).y/a.x),Math.ceil(t.project([n.wrapLat[1],0],l).y/a.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(t){var n=this._map,a=n._animatingZoom?Math.max(n._animateToZoom,n.getZoom()):n.getZoom(),l=n.getZoomScale(a,this._tileZoom),f=n.project(t,this._tileZoom).floor(),m=n.getSize().divideBy(l*2);return new at(f.subtract(m),f.add(m))},_update:function(t){var n=this._map;if(n){var a=this._clampZoom(n.getZoom());if(t===void 0&&(t=n.getCenter()),this._tileZoom!==void 0){var l=this._getTiledPixelBounds(t),f=this._pxBoundsToTileRange(l),m=f.getCenter(),y=[],b=this.options.keepBuffer,E=new at(f.getBottomLeft().subtract([b,-b]),f.getTopRight().add([b,-b]));if(!(isFinite(f.min.x)&&isFinite(f.min.y)&&isFinite(f.max.x)&&isFinite(f.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var C in this._tiles){var D=this._tiles[C].coords;(D.z!==this._tileZoom||!E.contains(new Z(D.x,D.y)))&&(this._tiles[C].current=!1)}if(Math.abs(a-this._tileZoom)>1){this._setView(t,a);return}for(var H=f.min.y;H<=f.max.y;H++)for(var Q=f.min.x;Q<=f.max.x;Q++){var Nt=new Z(Q,H);if(Nt.z=this._tileZoom,!!this._isValidTile(Nt)){var St=this._tiles[this._tileCoordsToKey(Nt)];St?St.current=!0:y.push(Nt)}}if(y.sort(function(Dt,fi){return Dt.distanceTo(m)-fi.distanceTo(m)}),y.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Ht=document.createDocumentFragment();for(Q=0;Q<y.length;Q++)this._addTile(y[Q],Ht);this._level.el.appendChild(Ht)}}}},_isValidTile:function(t){var n=this._map.options.crs;if(!n.infinite){var a=this._globalTileRange;if(!n.wrapLng&&(t.x<a.min.x||t.x>a.max.x)||!n.wrapLat&&(t.y<a.min.y||t.y>a.max.y))return!1}if(!this.options.bounds)return!0;var l=this._tileCoordsToBounds(t);return st(this.options.bounds).overlaps(l)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToNwSe:function(t){var n=this._map,a=this.getTileSize(),l=t.scaleBy(a),f=l.add(a),m=n.unproject(l,t.z),y=n.unproject(f,t.z);return[m,y]},_tileCoordsToBounds:function(t){var n=this._tileCoordsToNwSe(t),a=new ut(n[0],n[1]);return this.options.noWrap||(a=this._map.wrapLatLngBounds(a)),a},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var n=t.split(":"),a=new Z(+n[0],+n[1]);return a.z=+n[2],a},_removeTile:function(t){var n=this._tiles[t];n&&(pt(n.el),delete this._tiles[t],this.fire("tileunload",{tile:n.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){J(t,"leaflet-tile");var n=this.getTileSize();t.style.width=n.x+"px",t.style.height=n.y+"px",t.onselectstart=g,t.onmousemove=g,z.ielt9&&this.options.opacity<1&&jt(t,this.options.opacity)},_addTile:function(t,n){var a=this._getTilePos(t),l=this._tileCoordsToKey(t),f=this.createTile(this._wrapCoords(t),u(this._tileReady,this,t));this._initTile(f),this.createTile.length<2&&F(u(this._tileReady,this,t,null,f)),wt(f,a),this._tiles[l]={el:f,coords:t,current:!0},n.appendChild(f),this.fire("tileloadstart",{tile:f,coords:t})},_tileReady:function(t,n,a){n&&this.fire("tileerror",{error:n,tile:a,coords:t});var l=this._tileCoordsToKey(t);a=this._tiles[l],a&&(a.loaded=+new Date,this._map._fadeAnimated?(jt(a.el,0),K(this._fadeFrame),this._fadeFrame=F(this._updateOpacity,this)):(a.active=!0,this._pruneTiles()),n||(J(a.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:a.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),z.ielt9||!this._map._fadeAnimated?F(this._pruneTiles,this):setTimeout(u(this._pruneTiles,this),250)))},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var n=new Z(this._wrapX?v(t.x,this._wrapX):t.x,this._wrapY?v(t.y,this._wrapY):t.y);return n.z=t.z,n},_pxBoundsToTileRange:function(t){var n=this.getTileSize();return new at(t.min.unscaleBy(n).floor(),t.max.unscaleBy(n).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}});function Sl(t){return new Xi(t)}var ui=Xi.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(t,n){this._url=t,n=P(this,n),n.detectRetina&&z.retina&&n.maxZoom>0?(n.tileSize=Math.floor(n.tileSize/2),n.zoomReverse?(n.zoomOffset--,n.minZoom=Math.min(n.maxZoom,n.minZoom+1)):(n.zoomOffset++,n.maxZoom=Math.max(n.minZoom,n.maxZoom-1)),n.minZoom=Math.max(0,n.minZoom)):n.zoomReverse?n.minZoom=Math.min(n.maxZoom,n.minZoom):n.maxZoom=Math.max(n.minZoom,n.maxZoom),typeof n.subdomains=="string"&&(n.subdomains=n.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(t,n){return this._url===t&&n===void 0&&(n=!0),this._url=t,n||this.redraw(),this},createTile:function(t,n){var a=document.createElement("img");return X(a,"load",u(this._tileOnLoad,this,n,a)),X(a,"error",u(this._tileOnError,this,n,a)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(a.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(a.referrerPolicy=this.options.referrerPolicy),a.alt="",a.src=this.getTileUrl(t),a},getTileUrl:function(t){var n={r:z.retina?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var a=this._globalTileRange.max.y-t.y;this.options.tms&&(n.y=a),n["-y"]=a}return T(this._url,r(n,this.options))},_tileOnLoad:function(t,n){z.ielt9?setTimeout(u(t,this,null,n),0):t(null,n)},_tileOnError:function(t,n,a){var l=this.options.errorTileUrl;l&&n.getAttribute("src")!==l&&(n.src=l),t(a,n)},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom,n=this.options.maxZoom,a=this.options.zoomReverse,l=this.options.zoomOffset;return a&&(t=n-t),t+l},_getSubdomain:function(t){var n=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[n]},_abortLoading:function(){var t,n;for(t in this._tiles)if(this._tiles[t].coords.z!==this._tileZoom&&(n=this._tiles[t].el,n.onload=g,n.onerror=g,!n.complete)){n.src=O;var a=this._tiles[t].coords;pt(n),delete this._tiles[t],this.fire("tileabort",{tile:n,coords:a})}},_removeTile:function(t){var n=this._tiles[t];if(n)return n.el.setAttribute("src",O),Xi.prototype._removeTile.call(this,t)},_tileReady:function(t,n,a){if(!(!this._map||a&&a.getAttribute("src")===O))return Xi.prototype._tileReady.call(this,t,n,a)}});function Fr(t,n){return new ui(t,n)}var Zr=ui.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,n){this._url=t;var a=r({},this.defaultWmsParams);for(var l in n)l in this.options||(a[l]=n[l]);n=P(this,n);var f=n.detectRetina&&z.retina?2:1,m=this.getTileSize();a.width=m.x*f,a.height=m.y*f,this.wmsParams=a},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var n=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[n]=this._crs.code,ui.prototype.onAdd.call(this,t)},getTileUrl:function(t){var n=this._tileCoordsToNwSe(t),a=this._crs,l=rt(a.project(n[0]),a.project(n[1])),f=l.min,m=l.max,y=(this._wmsVersion>=1.3&&this._crs===Nr?[f.y,f.x,m.y,m.x]:[f.x,f.y,m.x,m.y]).join(","),b=ui.prototype.getTileUrl.call(this,t);return b+x(this.wmsParams,b,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+y},setParams:function(t,n){return r(this.wmsParams,t),n||this.redraw(),this}});function El(t,n){return new Zr(t,n)}ui.WMS=Zr,Fr.wms=El;var we=te.extend({options:{padding:.1},initialize:function(t){P(this,t),d(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),J(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,n){var a=this._map.getZoomScale(n,this._zoom),l=this._map.getSize().multiplyBy(.5+this.options.padding),f=this._map.project(this._center,n),m=l.multiplyBy(-a).add(f).subtract(this._map._getNewPixelOrigin(t,n));z.any3d?Fe(this._container,m,a):wt(this._container,m)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var t in this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,n=this._map.getSize(),a=this._map.containerPointToLayerPoint(n.multiplyBy(-t)).round();this._bounds=new at(a,a.add(n.multiplyBy(1+t*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Ur=we.extend({options:{tolerance:0},getEvents:function(){var t=we.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){we.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");X(t,"mousemove",this._onMouseMove,this),X(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),X(t,"mouseout",this._handleMouseOut,this),t._leaflet_disable_events=!0,this._ctx=t.getContext("2d")},_destroyContainer:function(){K(this._redrawRequest),delete this._ctx,pt(this._container),dt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var t;this._redrawBounds=null;for(var n in this._layers)t=this._layers[n],t._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){we.prototype._update.call(this);var t=this._bounds,n=this._container,a=t.getSize(),l=z.retina?2:1;wt(n,t.min),n.width=l*a.x,n.height=l*a.y,n.style.width=a.x+"px",n.style.height=a.y+"px",z.retina&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update")}},_reset:function(){we.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t),this._layers[d(t)]=t;var n=t._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=n),this._drawLast=n,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var n=t._order,a=n.next,l=n.prev;a?a.prev=l:this._drawLast=l,l?l.next=a:this._drawFirst=a,delete t._order,delete this._layers[d(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if(typeof t.options.dashArray=="string"){var n=t.options.dashArray.split(/[, ]+/),a=[],l,f;for(f=0;f<n.length;f++){if(l=Number(n[f]),isNaN(l))return;a.push(l)}t.options._dashArray=a}else t.options._dashArray=t.options.dashArray},_requestRedraw:function(t){this._map&&(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||F(this._redraw,this))},_extendRedrawBounds:function(t){if(t._pxBounds){var n=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new at,this._redrawBounds.extend(t._pxBounds.min.subtract([n,n])),this._redrawBounds.extend(t._pxBounds.max.add([n,n]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t=this._redrawBounds;if(t){var n=t.getSize();this._ctx.clearRect(t.min.x,t.min.y,n.x,n.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var t,n=this._redrawBounds;if(this._ctx.save(),n){var a=n.getSize();this._ctx.beginPath(),this._ctx.rect(n.min.x,n.min.y,a.x,a.y),this._ctx.clip()}this._drawing=!0;for(var l=this._drawFirst;l;l=l.next)t=l.layer,(!n||t._pxBounds&&t._pxBounds.intersects(n))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,n){if(this._drawing){var a,l,f,m,y=t._parts,b=y.length,E=this._ctx;if(b){for(E.beginPath(),a=0;a<b;a++){for(l=0,f=y[a].length;l<f;l++)m=y[a][l],E[l?"lineTo":"moveTo"](m.x,m.y);n&&E.closePath()}this._fillStroke(E,t)}}},_updateCircle:function(t){if(!(!this._drawing||t._empty())){var n=t._point,a=this._ctx,l=Math.max(Math.round(t._radius),1),f=(Math.max(Math.round(t._radiusY),1)||l)/l;f!==1&&(a.save(),a.scale(1,f)),a.beginPath(),a.arc(n.x,n.y/f,l,0,Math.PI*2,!1),f!==1&&a.restore(),this._fillStroke(a,t)}},_fillStroke:function(t,n){var a=n.options;a.fill&&(t.globalAlpha=a.fillOpacity,t.fillStyle=a.fillColor||a.color,t.fill(a.fillRule||"evenodd")),a.stroke&&a.weight!==0&&(t.setLineDash&&t.setLineDash(n.options&&n.options._dashArray||[]),t.globalAlpha=a.opacity,t.lineWidth=a.weight,t.strokeStyle=a.color,t.lineCap=a.lineCap,t.lineJoin=a.lineJoin,t.stroke())},_onClick:function(t){for(var n=this._map.mouseEventToLayerPoint(t),a,l,f=this._drawFirst;f;f=f.next)a=f.layer,a.options.interactive&&a._containsPoint(n)&&(!(t.type==="click"||t.type==="preclick")||!this._map._draggableMoved(a))&&(l=a);this._fireEvent(l?[l]:!1,t)},_onMouseMove:function(t){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var n=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,n)}},_handleMouseOut:function(t){var n=this._hoveredLayer;n&&(yt(this._container,"leaflet-interactive"),this._fireEvent([n],t,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(t,n){if(!this._mouseHoverThrottled){for(var a,l,f=this._drawFirst;f;f=f.next)a=f.layer,a.options.interactive&&a._containsPoint(n)&&(l=a);l!==this._hoveredLayer&&(this._handleMouseOut(t),l&&(J(this._container,"leaflet-interactive"),this._fireEvent([l],t,"mouseover"),this._hoveredLayer=l)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,t),this._mouseHoverThrottled=!0,setTimeout(u(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(t,n,a){this._map._fireDOMEvent(n,a||n.type,t)},_bringToFront:function(t){var n=t._order;if(n){var a=n.next,l=n.prev;if(a)a.prev=l;else return;l?l.next=a:a&&(this._drawFirst=a),n.prev=this._drawLast,this._drawLast.next=n,n.next=null,this._drawLast=n,this._requestRedraw(t)}},_bringToBack:function(t){var n=t._order;if(n){var a=n.next,l=n.prev;if(l)l.next=a;else return;a?a.prev=l:l&&(this._drawLast=l),n.prev=null,n.next=this._drawFirst,this._drawFirst.prev=n,this._drawFirst=n,this._requestRedraw(t)}}});function qr(t){return z.canvas?new Ur(t):null}var Yi=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch{}return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Tl={_initContainer:function(){this._container=ot("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(we.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var n=t._container=Yi("shape");J(n,"leaflet-vml-shape "+(this.options.className||"")),n.coordsize="1 1",t._path=Yi("path"),n.appendChild(t._path),this._updateStyle(t),this._layers[d(t)]=t},_addPath:function(t){var n=t._container;this._container.appendChild(n),t.options.interactive&&t.addInteractiveTarget(n)},_removePath:function(t){var n=t._container;pt(n),t.removeInteractiveTarget(n),delete this._layers[d(t)]},_updateStyle:function(t){var n=t._stroke,a=t._fill,l=t.options,f=t._container;f.stroked=!!l.stroke,f.filled=!!l.fill,l.stroke?(n||(n=t._stroke=Yi("stroke")),f.appendChild(n),n.weight=l.weight+"px",n.color=l.color,n.opacity=l.opacity,l.dashArray?n.dashStyle=S(l.dashArray)?l.dashArray.join(" "):l.dashArray.replace(/( *, *)/g," "):n.dashStyle="",n.endcap=l.lineCap.replace("butt","flat"),n.joinstyle=l.lineJoin):n&&(f.removeChild(n),t._stroke=null),l.fill?(a||(a=t._fill=Yi("fill")),f.appendChild(a),a.color=l.fillColor||l.color,a.opacity=l.fillOpacity):a&&(f.removeChild(a),t._fill=null)},_updateCircle:function(t){var n=t._point.round(),a=Math.round(t._radius),l=Math.round(t._radiusY||a);this._setPath(t,t._empty()?"M0 0":"AL "+n.x+","+n.y+" "+a+","+l+" 0,"+65535*360)},_setPath:function(t,n){t._path.v=n},_bringToFront:function(t){ai(t._container)},_bringToBack:function(t){ri(t._container)}},ns=z.vml?Yi:An,Ji=we.extend({_initContainer:function(){this._container=ns("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=ns("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){pt(this._container),dt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){we.prototype._update.call(this);var t=this._bounds,n=t.getSize(),a=this._container;(!this._svgSize||!this._svgSize.equals(n))&&(this._svgSize=n,a.setAttribute("width",n.x),a.setAttribute("height",n.y)),wt(a,t.min),a.setAttribute("viewBox",[t.min.x,t.min.y,n.x,n.y].join(" ")),this.fire("update")}},_initPath:function(t){var n=t._path=ns("path");t.options.className&&J(n,t.options.className),t.options.interactive&&J(n,"leaflet-interactive"),this._updateStyle(t),this._layers[d(t)]=t},_addPath:function(t){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){pt(t._path),t.removeInteractiveTarget(t._path),delete this._layers[d(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var n=t._path,a=t.options;n&&(a.stroke?(n.setAttribute("stroke",a.color),n.setAttribute("stroke-opacity",a.opacity),n.setAttribute("stroke-width",a.weight),n.setAttribute("stroke-linecap",a.lineCap),n.setAttribute("stroke-linejoin",a.lineJoin),a.dashArray?n.setAttribute("stroke-dasharray",a.dashArray):n.removeAttribute("stroke-dasharray"),a.dashOffset?n.setAttribute("stroke-dashoffset",a.dashOffset):n.removeAttribute("stroke-dashoffset")):n.setAttribute("stroke","none"),a.fill?(n.setAttribute("fill",a.fillColor||a.color),n.setAttribute("fill-opacity",a.fillOpacity),n.setAttribute("fill-rule",a.fillRule||"evenodd")):n.setAttribute("fill","none"))},_updatePoly:function(t,n){this._setPath(t,Ci(t._parts,n))},_updateCircle:function(t){var n=t._point,a=Math.max(Math.round(t._radius),1),l=Math.max(Math.round(t._radiusY),1)||a,f="a"+a+","+l+" 0 1,0 ",m=t._empty()?"M0 0":"M"+(n.x-a)+","+n.y+f+a*2+",0 "+f+-a*2+",0 ";this._setPath(t,m)},_setPath:function(t,n){t._path.setAttribute("d",n)},_bringToFront:function(t){ai(t._path)},_bringToBack:function(t){ri(t._path)}});z.vml&&Ji.include(Tl);function jr(t){return z.svg||z.vml?new Ji(t):null}it.include({getRenderer:function(t){var n=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return n||(n=this._renderer=this._createRenderer()),this.hasLayer(n)||this.addLayer(n),n},_getPaneRenderer:function(t){if(t==="overlayPane"||t===void 0)return!1;var n=this._paneRenderers[t];return n===void 0&&(n=this._createRenderer({pane:t}),this._paneRenderers[t]=n),n},_createRenderer:function(t){return this.options.preferCanvas&&qr(t)||jr(t)}});var $r=li.extend({initialize:function(t,n){li.prototype.initialize.call(this,this._boundsToLatLngs(t),n)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return t=st(t),[t.getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}});function Ll(t,n){return new $r(t,n)}Ji.create=ns,Ji.pointsToPath=Ci,Me.geometryToLayer=Xn,Me.coordsToLatLng=la,Me.coordsToLatLngs=Yn,Me.latLngToCoords=ca,Me.latLngsToCoords=Jn,Me.getFeature=ci,Me.asFeature=Qn,it.mergeOptions({boxZoom:!0});var Hr=re.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._resetStateTimeout=0,t.on("unload",this._destroy,this)},addHooks:function(){X(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){dt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){pt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(t){if(!t.shiftKey||t.which!==1&&t.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),qi(),Hs(),this._startPoint=this._map.mouseEventToContainerPoint(t),X(document,{contextmenu:qe,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=ot("div","leaflet-zoom-box",this._container),J(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var n=new at(this._point,this._startPoint),a=n.getSize();wt(this._box,n.min),this._box.style.width=a.x+"px",this._box.style.height=a.y+"px"},_finish:function(){this._moved&&(pt(this._box),yt(this._container,"leaflet-crosshair")),ji(),Vs(),dt(document,{contextmenu:qe,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if(!(t.which!==1&&t.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(u(this._resetState,this),0);var n=new ut(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(n).fire("boxzoomend",{boxZoomBounds:n})}},_onKeyDown:function(t){t.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});it.addInitHook("addHandler","boxZoom",Hr),it.mergeOptions({doubleClickZoom:!0});var Vr=re.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var n=this._map,a=n.getZoom(),l=n.options.zoomDelta,f=t.originalEvent.shiftKey?a-l:a+l;n.options.doubleClickZoom==="center"?n.setZoom(f):n.setZoomAround(t.containerPoint,f)}});it.addInitHook("addHandler","doubleClickZoom",Vr),it.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Wr=re.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new Te(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}J(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){yt(this._map._container,"leaflet-grab"),yt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var t=this._map;if(t._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var n=st(this._map.options.maxBounds);this._offsetLimit=rt(this._map.latLngToContainerPoint(n.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(n.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var n=this._lastTime=+new Date,a=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(a),this._times.push(n),this._prunePositions(n)}this._map.fire("move",t).fire("drag",t)},_prunePositions:function(t){for(;this._positions.length>1&&t-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),n=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=n.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,n){return t-(t-n)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var t=this._draggable._newPos.subtract(this._draggable._startPos),n=this._offsetLimit;t.x<n.min.x&&(t.x=this._viscousLimit(t.x,n.min.x)),t.y<n.min.y&&(t.y=this._viscousLimit(t.y,n.min.y)),t.x>n.max.x&&(t.x=this._viscousLimit(t.x,n.max.x)),t.y>n.max.y&&(t.y=this._viscousLimit(t.y,n.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,n=Math.round(t/2),a=this._initialWorldOffset,l=this._draggable._newPos.x,f=(l-n+a)%t+n-a,m=(l+n+a)%t-n-a,y=Math.abs(f+a)<Math.abs(m+a)?f:m;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=y},_onDragEnd:function(t){var n=this._map,a=n.options,l=!a.inertia||t.noInertia||this._times.length<2;if(n.fire("dragend",t),l)n.fire("moveend");else{this._prunePositions(+new Date);var f=this._lastPos.subtract(this._positions[0]),m=(this._lastTime-this._times[0])/1e3,y=a.easeLinearity,b=f.multiplyBy(y/m),E=b.distanceTo([0,0]),C=Math.min(a.inertiaMaxSpeed,E),D=b.multiplyBy(C/E),H=C/(a.inertiaDeceleration*y),Q=D.multiplyBy(-H/2).round();!Q.x&&!Q.y?n.fire("moveend"):(Q=n._limitOffset(Q,n.options.maxBounds),F(function(){n.panBy(Q,{duration:H,easeLinearity:y,noMoveStart:!0,animate:!0})}))}}});it.addInitHook("addHandler","dragging",Wr),it.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Kr=re.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),X(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),dt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var t=document.body,n=document.documentElement,a=t.scrollTop||n.scrollTop,l=t.scrollLeft||n.scrollLeft;this._map._container.focus(),window.scrollTo(l,a)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){var n=this._panKeys={},a=this.keyCodes,l,f;for(l=0,f=a.left.length;l<f;l++)n[a.left[l]]=[-1*t,0];for(l=0,f=a.right.length;l<f;l++)n[a.right[l]]=[t,0];for(l=0,f=a.down.length;l<f;l++)n[a.down[l]]=[0,t];for(l=0,f=a.up.length;l<f;l++)n[a.up[l]]=[0,-1*t]},_setZoomDelta:function(t){var n=this._zoomKeys={},a=this.keyCodes,l,f;for(l=0,f=a.zoomIn.length;l<f;l++)n[a.zoomIn[l]]=t;for(l=0,f=a.zoomOut.length;l<f;l++)n[a.zoomOut[l]]=-t},_addHooks:function(){X(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){dt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var n=t.keyCode,a=this._map,l;if(n in this._panKeys){if(!a._panAnim||!a._panAnim._inProgress)if(l=this._panKeys[n],t.shiftKey&&(l=U(l).multiplyBy(3)),a.options.maxBounds&&(l=a._limitOffset(U(l),a.options.maxBounds)),a.options.worldCopyJump){var f=a.wrapLatLng(a.unproject(a.project(a.getCenter()).add(l)));a.panTo(f)}else a.panBy(l)}else if(n in this._zoomKeys)a.setZoom(a.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[n]);else if(n===27&&a._popup&&a._popup.options.closeOnEscapeKey)a.closePopup();else return;qe(t)}}});it.addInitHook("addHandler","keyboard",Kr),it.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Xr=re.extend({addHooks:function(){X(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){dt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var n=Mr(t),a=this._map.options.wheelDebounceTime;this._delta+=n,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var l=Math.max(a-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(u(this._performZoom,this),l),qe(t)},_performZoom:function(){var t=this._map,n=t.getZoom(),a=this._map.options.zoomSnap||0;t._stop();var l=this._delta/(this._map.options.wheelPxPerZoomLevel*4),f=4*Math.log(2/(1+Math.exp(-Math.abs(l))))/Math.LN2,m=a?Math.ceil(f/a)*a:f,y=t._limitZoom(n+(this._delta>0?m:-m))-n;this._delta=0,this._startTime=null,y&&(t.options.scrollWheelZoom==="center"?t.setZoom(n+y):t.setZoomAround(this._lastMousePos,n+y))}});it.addInitHook("addHandler","scrollWheelZoom",Xr);var Al=600;it.mergeOptions({tapHold:z.touchNative&&z.safari&&z.mobile,tapTolerance:15});var Yr=re.extend({addHooks:function(){X(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){dt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(clearTimeout(this._holdTimeout),t.touches.length===1){var n=t.touches[0];this._startPos=this._newPos=new Z(n.clientX,n.clientY),this._holdTimeout=setTimeout(u(function(){this._cancel(),this._isTapValid()&&(X(document,"touchend",Tt),X(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",n))},this),Al),X(document,"touchend touchcancel contextmenu",this._cancel,this),X(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function t(){dt(document,"touchend",Tt),dt(document,"touchend touchcancel",t)},_cancel:function(){clearTimeout(this._holdTimeout),dt(document,"touchend touchcancel contextmenu",this._cancel,this),dt(document,"touchmove",this._onMove,this)},_onMove:function(t){var n=t.touches[0];this._newPos=new Z(n.clientX,n.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(t,n){var a=new MouseEvent(t,{bubbles:!0,cancelable:!0,view:window,screenX:n.screenX,screenY:n.screenY,clientX:n.clientX,clientY:n.clientY});a._simulated=!0,n.target.dispatchEvent(a)}});it.addInitHook("addHandler","tapHold",Yr),it.mergeOptions({touchZoom:z.touch,bounceAtZoomLimits:!0});var Jr=re.extend({addHooks:function(){J(this._map._container,"leaflet-touch-zoom"),X(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){yt(this._map._container,"leaflet-touch-zoom"),dt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var n=this._map;if(!(!t.touches||t.touches.length!==2||n._animatingZoom||this._zooming)){var a=n.mouseEventToContainerPoint(t.touches[0]),l=n.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=n.getSize()._divideBy(2),this._startLatLng=n.containerPointToLatLng(this._centerPoint),n.options.touchZoom!=="center"&&(this._pinchStartLatLng=n.containerPointToLatLng(a.add(l)._divideBy(2))),this._startDist=a.distanceTo(l),this._startZoom=n.getZoom(),this._moved=!1,this._zooming=!0,n._stop(),X(document,"touchmove",this._onTouchMove,this),X(document,"touchend touchcancel",this._onTouchEnd,this),Tt(t)}},_onTouchMove:function(t){if(!(!t.touches||t.touches.length!==2||!this._zooming)){var n=this._map,a=n.mouseEventToContainerPoint(t.touches[0]),l=n.mouseEventToContainerPoint(t.touches[1]),f=a.distanceTo(l)/this._startDist;if(this._zoom=n.getScaleZoom(f,this._startZoom),!n.options.bounceAtZoomLimits&&(this._zoom<n.getMinZoom()&&f<1||this._zoom>n.getMaxZoom()&&f>1)&&(this._zoom=n._limitZoom(this._zoom)),n.options.touchZoom==="center"){if(this._center=this._startLatLng,f===1)return}else{var m=a._add(l)._divideBy(2)._subtract(this._centerPoint);if(f===1&&m.x===0&&m.y===0)return;this._center=n.unproject(n.project(this._pinchStartLatLng,this._zoom).subtract(m),this._zoom)}this._moved||(n._moveStart(!0,!1),this._moved=!0),K(this._animRequest);var y=u(n._move,n,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=F(y,this,!0),Tt(t)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,K(this._animRequest),dt(document,"touchmove",this._onTouchMove,this),dt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});it.addInitHook("addHandler","touchZoom",Jr),it.BoxZoom=Hr,it.DoubleClickZoom=Vr,it.Drag=Wr,it.Keyboard=Kr,it.ScrollWheelZoom=Xr,it.TapHold=Yr,it.TouchZoom=Jr,s.Bounds=at,s.Browser=z,s.CRS=bt,s.Canvas=Ur,s.Circle=ha,s.CircleMarker=Kn,s.Class=mt,s.Control=Qt,s.DivIcon=zr,s.DivOverlay=oe,s.DomEvent=Vh,s.DomUtil=$h,s.Draggable=Te,s.Evented=Et,s.FeatureGroup=ve,s.GeoJSON=Me,s.GridLayer=Xi,s.Handler=re,s.Icon=hi,s.ImageOverlay=ts,s.LatLng=W,s.LatLngBounds=ut,s.Layer=te,s.LayerGroup=oi,s.LineUtil=rl,s.Map=it,s.Marker=Wn,s.Mixin=tl,s.Path=Le,s.Point=Z,s.PolyUtil=el,s.Polygon=li,s.Polyline=ye,s.Popup=es,s.PosAnimation=wr,s.Projection=ol,s.Rectangle=$r,s.Renderer=we,s.SVG=Ji,s.SVGOverlay=Br,s.TileLayer=ui,s.Tooltip=is,s.Transformation=ei,s.Util=ct,s.VideoOverlay=Dr,s.bind=u,s.bounds=rt,s.canvas=qr,s.circle=ml,s.circleMarker=_l,s.control=Vi,s.divIcon=bl,s.extend=r,s.featureGroup=ul,s.geoJSON=kr,s.geoJson=vl,s.gridLayer=Sl,s.icon=fl,s.imageOverlay=yl,s.latLng=V,s.latLngBounds=st,s.layerGroup=cl,s.map=Wh,s.marker=dl,s.point=U,s.polygon=pl,s.polyline=gl,s.popup=xl,s.rectangle=Ll,s.setOptions=P,s.stamp=d,s.svg=jr,s.svgOverlay=wl,s.tileLayer=Fr,s.tooltip=Pl,s.transformation=De,s.version=o,s.videoOverlay=Ml;var Cl=window.L;s.noConflict=function(){return window.L=Cl,this},window.L=s})})(wa,wa.exports);var jl=wa.exports;const Pt=Ba(jl);function At(e){return(i,...s)=>$l(e,i,s)}function Ei(e,i){return At(No(e,i).get)}const{apply:$l,getOwnPropertyDescriptor:No,getPrototypeOf:za,ownKeys:Hl}=Reflect,{iterator:xn,toStringTag:Vl}=Symbol,Wl=Object,{create:Fa,defineProperty:Kl}=Wl,Xl=Array,Yl=Xl.prototype,Oo=Yl[xn],Jl=At(Oo),Ro=ArrayBuffer,Ql=Ro.prototype;Ei(Ql,"byteLength");const io=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:null;io&&Ei(io.prototype,"byteLength");const ko=za(Uint8Array);ko.from;const kt=ko.prototype;kt[xn];At(kt.keys);At(kt.values);At(kt.entries);At(kt.set);At(kt.reverse);At(kt.fill);At(kt.copyWithin);At(kt.sort);At(kt.slice);At(kt.subarray);Ei(kt,"buffer");Ei(kt,"byteOffset");Ei(kt,"length");Ei(kt,Vl);const tc=Uint8Array,Do=Uint16Array,Za=Uint32Array,ec=Float32Array,_n=za([][xn]()),Bo=At(_n.next),ic=At(function*(){}().next),nc=za(_n),sc=DataView.prototype,ac=At(sc.getUint16),Ua=WeakMap,zo=Ua.prototype,Fo=At(zo.get),rc=At(zo.set),Zo=new Ua,oc=Fa(null,{next:{value:function(){const i=Fo(Zo,this);return Bo(i)}},[xn]:{value:function(){return this}}});function hc(e){if(e[xn]===Oo&&_n.next===Bo)return e;const i=Fa(oc);return rc(Zo,i,Jl(e)),i}const lc=new Ua,cc=Fa(nc,{next:{value:function(){const i=Fo(lc,this);return ic(i)},writable:!0,configurable:!0}});for(const e of Hl(_n))e!=="next"&&Kl(cc,e,No(_n,e));const Uo=new Ro(4),uc=new ec(Uo),fc=new Za(Uo),he=new Do(512),le=new tc(512);for(let e=0;e<256;++e){const i=e-127;i<-24?(he[e]=0,he[e|256]=32768,le[e]=24,le[e|256]=24):i<-14?(he[e]=1024>>-i-14,he[e|256]=1024>>-i-14|32768,le[e]=-i-1,le[e|256]=-i-1):i<=15?(he[e]=i+15<<10,he[e|256]=i+15<<10|32768,le[e]=13,le[e|256]=13):i<128?(he[e]=31744,he[e|256]=64512,le[e]=24,le[e|256]=24):(he[e]=31744,he[e|256]=64512,le[e]=13,le[e|256]=13)}const qa=new Za(2048);for(let e=1;e<1024;++e){let i=e<<13,s=0;for(;!(i&8388608);)i<<=1,s-=8388608;i&=-8388609,s+=947912704,qa[e]=i|s}for(let e=1024;e<2048;++e)qa[e]=939524096+(e-1024<<13);const Ti=new Za(64);for(let e=1;e<31;++e)Ti[e]=e<<23;Ti[31]=1199570944;Ti[32]=2147483648;for(let e=33;e<63;++e)Ti[e]=2147483648+(e-32<<23);Ti[63]=3347054592;const qo=new Do(64);for(let e=1;e<64;++e)e!==32&&(qo[e]=1024);function dc(e){const i=e>>10;return fc[0]=qa[qo[i]+(e&1023)]+Ti[i],uc[0]}function jo(e,i,...s){return dc(ac(e,i,...hc(s)))}var ja={exports:{}};function $o(e,i,s){const o=s&&s.debug||!1;o&&console.log("[xml-utils] getting "+i+" in "+e);const r=typeof e=="object"?e.outer:e,h=r.slice(0,r.indexOf(">")+1),u=['"',"'"];for(let c=0;c<u.length;c++){const d=u[c],_=i+"\\="+d+"([^"+d+"]*)"+d;o&&console.log("[xml-utils] pattern:",_);const g=new RegExp(_).exec(h);if(o&&console.log("[xml-utils] match:",g),g)return g[1]}}ja.exports=$o;ja.exports.default=$o;var _c=ja.exports;const da=Ba(_c);var $a={exports:{}},Ha={exports:{}},Va={exports:{}};function Ho(e,i,s){const r=new RegExp(i).exec(e.slice(s));return r?s+r.index:-1}Va.exports=Ho;Va.exports.default=Ho;var mc=Va.exports,Wa={exports:{}};function Vo(e,i,s){const r=new RegExp(i).exec(e.slice(s));return r?s+r.index+r[0].length-1:-1}Wa.exports=Vo;Wa.exports.default=Vo;var gc=Wa.exports,Ka={exports:{}};function Wo(e,i){const s=new RegExp(i,"g"),o=e.match(s);return o?o.length:0}Ka.exports=Wo;Ka.exports.default=Wo;var pc=Ka.exports;const vc=mc,_a=gc,no=pc;function Ko(e,i,s){const o=s&&s.debug||!1,r=!(s&&typeof s.nested===!1),h=s&&s.startIndex||0;o&&console.log("[xml-utils] starting findTagByName with",i," and ",s);const u=vc(e,`<${i}[ 
>/]`,h);if(o&&console.log("[xml-utils] start:",u),u===-1)return;const c=e.slice(u+i.length);let d=_a(c,"^[^<]*[ /]>",0);const _=d!==-1&&c[d-1]==="/";if(o&&console.log("[xml-utils] selfClosing:",_),_===!1)if(r){let M=0,w=1,P=0;for(;(d=_a(c,"[ /]"+i+">",M))!==-1;){const x=c.substring(M,d+1);if(w+=no(x,"<"+i+`[ 
	>]`),P+=no(x,"</"+i+">"),P>=w)break;M=d}}else d=_a(c,"[ /]"+i+">",0);const v=u+i.length+d+1;if(o&&console.log("[xml-utils] end:",v),v===-1)return;const g=e.slice(u,v);let p;return _?p=null:p=g.slice(g.indexOf(">")+1,g.lastIndexOf("<")),{inner:p,outer:g,start:u,end:v}}Ha.exports=Ko;Ha.exports.default=Ko;var yc=Ha.exports;const Mc=yc;function Xo(e,i,s){const o=[],r=s&&s.debug||!1,h=s&&typeof s.nested=="boolean"?s.nested:!0;let u=s&&s.startIndex||0,c;for(;c=Mc(e,i,{debug:r,startIndex:u});)h?u=c.start+1+i.length:u=c.end,o.push(c);return r&&console.log("findTagsByName found",o.length,"tags"),o}$a.exports=Xo;$a.exports.default=Xo;var wc=$a.exports;const xc=Ba(wc),rn={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop",33550:"ModelPixelScale",33922:"ModelTiepoint",34264:"ModelTransformation",34735:"GeoKeyDirectory",34736:"GeoDoubleParams",34737:"GeoAsciiParams",50674:"LercParameters"},ce={};for(const e in rn)rn.hasOwnProperty(e)&&(ce[rn[e]]=parseInt(e,10));const Pc=[ce.BitsPerSample,ce.ExtraSamples,ce.SampleFormat,ce.StripByteCounts,ce.StripOffsets,ce.StripRowCounts,ce.TileByteCounts,ce.TileOffsets,ce.SubIFDs],ma={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE",13:"IFD",16:"LONG8",17:"SLONG8",18:"IFD8"},Y={};for(const e in ma)ma.hasOwnProperty(e)&&(Y[ma[e]]=parseInt(e,10));const Zt={WhiteIsZero:0,BlackIsZero:1,RGB:2,Palette:3,CMYK:5,YCbCr:6,CIELab:8},bc={Unspecified:0},bm={AddCompression:1},Sm={None:0,Deflate:1,Zstandard:2},Sc={1024:"GTModelTypeGeoKey",1025:"GTRasterTypeGeoKey",1026:"GTCitationGeoKey",2048:"GeographicTypeGeoKey",2049:"GeogCitationGeoKey",2050:"GeogGeodeticDatumGeoKey",2051:"GeogPrimeMeridianGeoKey",2052:"GeogLinearUnitsGeoKey",2053:"GeogLinearUnitSizeGeoKey",2054:"GeogAngularUnitsGeoKey",2055:"GeogAngularUnitSizeGeoKey",2056:"GeogEllipsoidGeoKey",2057:"GeogSemiMajorAxisGeoKey",2058:"GeogSemiMinorAxisGeoKey",2059:"GeogInvFlatteningGeoKey",2060:"GeogAzimuthUnitsGeoKey",2061:"GeogPrimeMeridianLongGeoKey",2062:"GeogTOWGS84GeoKey",3072:"ProjectedCSTypeGeoKey",3073:"PCSCitationGeoKey",3074:"ProjectionGeoKey",3075:"ProjCoordTransGeoKey",3076:"ProjLinearUnitsGeoKey",3077:"ProjLinearUnitSizeGeoKey",3078:"ProjStdParallel1GeoKey",3079:"ProjStdParallel2GeoKey",3080:"ProjNatOriginLongGeoKey",3081:"ProjNatOriginLatGeoKey",3082:"ProjFalseEastingGeoKey",3083:"ProjFalseNorthingGeoKey",3084:"ProjFalseOriginLongGeoKey",3085:"ProjFalseOriginLatGeoKey",3086:"ProjFalseOriginEastingGeoKey",3087:"ProjFalseOriginNorthingGeoKey",3088:"ProjCenterLongGeoKey",3089:"ProjCenterLatGeoKey",3090:"ProjCenterEastingGeoKey",3091:"ProjCenterNorthingGeoKey",3092:"ProjScaleAtNatOriginGeoKey",3093:"ProjScaleAtCenterGeoKey",3094:"ProjAzimuthAngleGeoKey",3095:"ProjStraightVertPoleLongGeoKey",3096:"ProjRectifiedGridAngleGeoKey",4096:"VerticalCSTypeGeoKey",4097:"VerticalCitationGeoKey",4098:"VerticalDatumGeoKey",4099:"VerticalUnitsGeoKey"};function Ec(e,i){const{width:s,height:o}=e,r=new Uint8Array(s*o*3);let h;for(let u=0,c=0;u<e.length;++u,c+=3)h=256-e[u]/i*256,r[c]=h,r[c+1]=h,r[c+2]=h;return r}function Tc(e,i){const{width:s,height:o}=e,r=new Uint8Array(s*o*3);let h;for(let u=0,c=0;u<e.length;++u,c+=3)h=e[u]/i*256,r[c]=h,r[c+1]=h,r[c+2]=h;return r}function Lc(e,i){const{width:s,height:o}=e,r=new Uint8Array(s*o*3),h=i.length/3,u=i.length/3*2;for(let c=0,d=0;c<e.length;++c,d+=3){const _=e[c];r[d]=i[_]/65536*256,r[d+1]=i[_+h]/65536*256,r[d+2]=i[_+u]/65536*256}return r}function Ac(e){const{width:i,height:s}=e,o=new Uint8Array(i*s*3);for(let r=0,h=0;r<e.length;r+=4,h+=3){const u=e[r],c=e[r+1],d=e[r+2],_=e[r+3];o[h]=255*((255-u)/256)*((255-_)/256),o[h+1]=255*((255-c)/256)*((255-_)/256),o[h+2]=255*((255-d)/256)*((255-_)/256)}return o}function Cc(e){const{width:i,height:s}=e,o=new Uint8ClampedArray(i*s*3);for(let r=0,h=0;r<e.length;r+=3,h+=3){const u=e[r],c=e[r+1],d=e[r+2];o[h]=u+1.402*(d-128),o[h+1]=u-.34414*(c-128)-.71414*(d-128),o[h+2]=u+1.772*(c-128)}return o}const Gc=.95047,Ic=1,Nc=1.08883;function Oc(e){const{width:i,height:s}=e,o=new Uint8Array(i*s*3);for(let r=0,h=0;r<e.length;r+=3,h+=3){const u=e[r+0],c=e[r+1]<<24>>24,d=e[r+2]<<24>>24;let _=(u+16)/116,v=c/500+_,g=_-d/200,p,M,w;v=Gc*(v*v*v>.008856?v*v*v:(v-16/116)/7.787),_=Ic*(_*_*_>.008856?_*_*_:(_-16/116)/7.787),g=Nc*(g*g*g>.008856?g*g*g:(g-16/116)/7.787),p=v*3.2406+_*-1.5372+g*-.4986,M=v*-.9689+_*1.8758+g*.0415,w=v*.0557+_*-.204+g*1.057,p=p>.0031308?1.055*p**(1/2.4)-.055:12.92*p,M=M>.0031308?1.055*M**(1/2.4)-.055:12.92*M,w=w>.0031308?1.055*w**(1/2.4)-.055:12.92*w,o[h]=Math.max(0,Math.min(1,p))*255,o[h+1]=Math.max(0,Math.min(1,M))*255,o[h+2]=Math.max(0,Math.min(1,w))*255}return o}const Rc="modulepreload",kc=function(e){return"/"+e},so={},ti=function(i,s,o){let r=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),c=u?.nonce||u?.getAttribute("nonce");r=Promise.allSettled(s.map(d=>{if(d=kc(d),d in so)return;so[d]=!0;const _=d.endsWith(".css"),v=_?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${v}`))return;const g=document.createElement("link");if(g.rel=_?"stylesheet":Rc,_||(g.as="script"),g.crossOrigin="",g.href=d,c&&g.setAttribute("nonce",c),document.head.appendChild(g),_)return new Promise((p,M)=>{g.addEventListener("load",p),g.addEventListener("error",()=>M(new Error(`Unable to preload CSS for ${d}`)))})}))}function h(u){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=u,window.dispatchEvent(c),!c.defaultPrevented)throw u}return r.then(u=>{for(const c of u||[])c.status==="rejected"&&h(c.reason);return i().catch(h)})},Yo=new Map;function Oe(e,i){Array.isArray(e)||(e=[e]),e.forEach(s=>Yo.set(s,i))}async function Dc(e){const i=Yo.get(e.Compression);if(!i)throw new Error(`Unknown compression method identifier: ${e.Compression}`);const s=await i();return new s(e)}Oe([void 0,1],()=>ti(()=>import("./raw-in9isEBO.js"),__vite__mapDeps([0,1])).then(e=>e.default));Oe(5,()=>ti(()=>import("./lzw-_aCqfs4w.js"),__vite__mapDeps([2,1])).then(e=>e.default));Oe(6,()=>{throw new Error("old style JPEG compression is not supported.")});Oe(7,()=>ti(()=>import("./jpeg-JhJy4lL1.js"),__vite__mapDeps([3,1])).then(e=>e.default));Oe([8,32946],()=>ti(()=>import("./deflate-Dthki0TA.js"),__vite__mapDeps([4,5,1])).then(e=>e.default));Oe(32773,()=>ti(()=>import("./packbits-DDWKfGV_.js"),__vite__mapDeps([6,1])).then(e=>e.default));Oe(34887,()=>ti(()=>import("./lerc-ZdFqBZSg.js"),__vite__mapDeps([7,5,1])).then(async e=>(await e.zstd.init(),e)).then(e=>e.default));Oe(50001,()=>ti(()=>import("./webimage-DBgUwIbt.js"),__vite__mapDeps([8,1])).then(e=>e.default));function Ls(e,i,s,o=1){return new(Object.getPrototypeOf(e)).constructor(i*s*o)}function Bc(e,i,s,o,r){const h=i/o,u=s/r;return e.map(c=>{const d=Ls(c,o,r);for(let _=0;_<r;++_){const v=Math.min(Math.round(u*_),s-1);for(let g=0;g<o;++g){const p=Math.min(Math.round(h*g),i-1),M=c[v*i+p];d[_*o+g]=M}}return d})}function Mi(e,i,s){return(1-s)*e+s*i}function zc(e,i,s,o,r){const h=i/o,u=s/r;return e.map(c=>{const d=Ls(c,o,r);for(let _=0;_<r;++_){const v=u*_,g=Math.floor(v),p=Math.min(Math.ceil(v),s-1);for(let M=0;M<o;++M){const w=h*M,P=w%1,x=Math.floor(w),A=Math.min(Math.ceil(w),i-1),T=c[g*i+x],S=c[g*i+A],I=c[p*i+x],O=c[p*i+A],N=Mi(Mi(T,S,P),Mi(I,O,P),v%1);d[_*o+M]=N}}return d})}function Fc(e,i,s,o,r,h="nearest"){switch(h.toLowerCase()){case"nearest":return Bc(e,i,s,o,r);case"bilinear":case"linear":return zc(e,i,s,o,r);default:throw new Error(`Unsupported resampling method: '${h}'`)}}function Zc(e,i,s,o,r,h){const u=i/o,c=s/r,d=Ls(e,o,r,h);for(let _=0;_<r;++_){const v=Math.min(Math.round(c*_),s-1);for(let g=0;g<o;++g){const p=Math.min(Math.round(u*g),i-1);for(let M=0;M<h;++M){const w=e[v*i*h+p*h+M];d[_*o*h+g*h+M]=w}}}return d}function Uc(e,i,s,o,r,h){const u=i/o,c=s/r,d=Ls(e,o,r,h);for(let _=0;_<r;++_){const v=c*_,g=Math.floor(v),p=Math.min(Math.ceil(v),s-1);for(let M=0;M<o;++M){const w=u*M,P=w%1,x=Math.floor(w),A=Math.min(Math.ceil(w),i-1);for(let T=0;T<h;++T){const S=e[g*i*h+x*h+T],I=e[g*i*h+A*h+T],O=e[p*i*h+x*h+T],N=e[p*i*h+A*h+T],B=Mi(Mi(S,I,P),Mi(O,N,P),v%1);d[_*o*h+M*h+T]=B}}}return d}function qc(e,i,s,o,r,h,u="nearest"){switch(u.toLowerCase()){case"nearest":return Zc(e,i,s,o,r,h);case"bilinear":case"linear":return Uc(e,i,s,o,r,h);default:throw new Error(`Unsupported resampling method: '${u}'`)}}function jc(e,i,s){let o=0;for(let r=i;r<s;++r)o+=e[r];return o}function xa(e,i,s){switch(e){case 1:if(i<=8)return new Uint8Array(s);if(i<=16)return new Uint16Array(s);if(i<=32)return new Uint32Array(s);break;case 2:if(i===8)return new Int8Array(s);if(i===16)return new Int16Array(s);if(i===32)return new Int32Array(s);break;case 3:switch(i){case 16:case 32:return new Float32Array(s);case 64:return new Float64Array(s)}break}throw Error("Unsupported data format/bitsPerSample")}function $c(e,i){return(e===1||e===2)&&i<=32&&i%8===0?!1:!(e===3&&(i===16||i===32||i===64))}function Hc(e,i,s,o,r,h,u){const c=new DataView(e),d=s===2?u*h:u*h*o,_=s===2?1:o,v=xa(i,r,d),g=parseInt("1".repeat(r),2);if(i===1){let p;s===1?p=o*r:p=r;let M=h*p;M&7&&(M=M+7&-8);for(let w=0;w<u;++w){const P=w*M;for(let x=0;x<h;++x){const A=P+x*_*r;for(let T=0;T<_;++T){const S=A+T*r,I=(w*h+x)*_+T,O=Math.floor(S/8),N=S%8;if(N+r<=8)v[I]=c.getUint8(O)>>8-r-N&g;else if(N+r<=16)v[I]=c.getUint16(O)>>16-r-N&g;else if(N+r<=24){const B=c.getUint16(O)<<8|c.getUint8(O+2);v[I]=B>>24-r-N&g}else v[I]=c.getUint32(O)>>32-r-N&g}}}}return v.buffer}class Vc{constructor(i,s,o,r,h,u){this.fileDirectory=i,this.geoKeys=s,this.dataView=o,this.littleEndian=r,this.tiles=h?{}:null,this.isTiled=!i.StripOffsets;const c=i.PlanarConfiguration;if(this.planarConfiguration=typeof c>"u"?1:c,this.planarConfiguration!==1&&this.planarConfiguration!==2)throw new Error("Invalid planar configuration.");this.source=u}getFileDirectory(){return this.fileDirectory}getGeoKeys(){return this.geoKeys}getWidth(){return this.fileDirectory.ImageWidth}getHeight(){return this.fileDirectory.ImageLength}getSamplesPerPixel(){return typeof this.fileDirectory.SamplesPerPixel<"u"?this.fileDirectory.SamplesPerPixel:1}getTileWidth(){return this.isTiled?this.fileDirectory.TileWidth:this.getWidth()}getTileHeight(){return this.isTiled?this.fileDirectory.TileLength:typeof this.fileDirectory.RowsPerStrip<"u"?Math.min(this.fileDirectory.RowsPerStrip,this.getHeight()):this.getHeight()}getBlockWidth(){return this.getTileWidth()}getBlockHeight(i){return this.isTiled||(i+1)*this.getTileHeight()<=this.getHeight()?this.getTileHeight():this.getHeight()-i*this.getTileHeight()}getBytesPerPixel(){let i=0;for(let s=0;s<this.fileDirectory.BitsPerSample.length;++s)i+=this.getSampleByteSize(s);return i}getSampleByteSize(i){if(i>=this.fileDirectory.BitsPerSample.length)throw new RangeError(`Sample index ${i} is out of range.`);return Math.ceil(this.fileDirectory.BitsPerSample[i]/8)}getReaderForSample(i){const s=this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[i]:1,o=this.fileDirectory.BitsPerSample[i];switch(s){case 1:if(o<=8)return DataView.prototype.getUint8;if(o<=16)return DataView.prototype.getUint16;if(o<=32)return DataView.prototype.getUint32;break;case 2:if(o<=8)return DataView.prototype.getInt8;if(o<=16)return DataView.prototype.getInt16;if(o<=32)return DataView.prototype.getInt32;break;case 3:switch(o){case 16:return function(r,h){return jo(this,r,h)};case 32:return DataView.prototype.getFloat32;case 64:return DataView.prototype.getFloat64}break}throw Error("Unsupported data format/bitsPerSample")}getSampleFormat(i=0){return this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[i]:1}getBitsPerSample(i=0){return this.fileDirectory.BitsPerSample[i]}getArrayForSample(i,s){const o=this.getSampleFormat(i),r=this.getBitsPerSample(i);return xa(o,r,s)}async getTileOrStrip(i,s,o,r,h){const u=Math.ceil(this.getWidth()/this.getTileWidth()),c=Math.ceil(this.getHeight()/this.getTileHeight());let d;const{tiles:_}=this;this.planarConfiguration===1?d=s*u+i:this.planarConfiguration===2&&(d=o*u*c+s*u+i);let v,g;this.isTiled?(v=this.fileDirectory.TileOffsets[d],g=this.fileDirectory.TileByteCounts[d]):(v=this.fileDirectory.StripOffsets[d],g=this.fileDirectory.StripByteCounts[d]);const p=(await this.source.fetch([{offset:v,length:g}],h))[0];let M;return _===null||!_[d]?(M=(async()=>{let w=await r.decode(this.fileDirectory,p);const P=this.getSampleFormat(),x=this.getBitsPerSample();return $c(P,x)&&(w=Hc(w,P,this.planarConfiguration,this.getSamplesPerPixel(),x,this.getTileWidth(),this.getBlockHeight(s))),w})(),_!==null&&(_[d]=M)):M=_[d],{x:i,y:s,sample:o,data:await M}}async _readRaster(i,s,o,r,h,u,c,d,_){const v=this.getTileWidth(),g=this.getTileHeight(),p=this.getWidth(),M=this.getHeight(),w=Math.max(Math.floor(i[0]/v),0),P=Math.min(Math.ceil(i[2]/v),Math.ceil(p/v)),x=Math.max(Math.floor(i[1]/g),0),A=Math.min(Math.ceil(i[3]/g),Math.ceil(M/g)),T=i[2]-i[0];let S=this.getBytesPerPixel();const I=[],O=[];for(let q=0;q<s.length;++q)this.planarConfiguration===1?I.push(jc(this.fileDirectory.BitsPerSample,0,s[q])/8):I.push(0),O.push(this.getReaderForSample(s[q]));const N=[],{littleEndian:B}=this;for(let q=x;q<A;++q)for(let j=w;j<P;++j){let $;this.planarConfiguration===1&&($=this.getTileOrStrip(j,q,0,h,_));for(let F=0;F<s.length;++F){const K=F,ct=s[F];this.planarConfiguration===2&&(S=this.getSampleByteSize(ct),$=this.getTileOrStrip(j,q,ct,h,_));const mt=$.then(tt=>{const et=tt.data,Et=new DataView(et),Z=this.getBlockHeight(tt.y),gt=tt.y*g,U=tt.x*v,at=gt+Z,rt=(tt.x+1)*v,ut=O[K],st=Math.min(Z,Z-(at-i[3]),M-gt),W=Math.min(v,v-(rt-i[2]),p-U);for(let V=Math.max(0,i[1]-gt);V<st;++V)for(let bt=Math.max(0,i[0]-U);bt<W;++bt){const Ut=(V*v+bt)*S,ke=ut.call(Et,Ut+I[K],B);let Wt;r?(Wt=(V+gt-i[1])*T*s.length+(bt+U-i[0])*s.length+K,o[Wt]=ke):(Wt=(V+gt-i[1])*T+bt+U-i[0],o[K][Wt]=ke)}});N.push(mt)}}if(await Promise.all(N),u&&i[2]-i[0]!==u||c&&i[3]-i[1]!==c){let q;return r?q=qc(o,i[2]-i[0],i[3]-i[1],u,c,s.length,d):q=Fc(o,i[2]-i[0],i[3]-i[1],u,c,d),q.width=u,q.height=c,q}return o.width=u||i[2]-i[0],o.height=c||i[3]-i[1],o}async readRasters({window:i,samples:s=[],interleave:o,pool:r=null,width:h,height:u,resampleMethod:c,fillValue:d,signal:_}={}){const v=i||[0,0,this.getWidth(),this.getHeight()];if(v[0]>v[2]||v[1]>v[3])throw new Error("Invalid subsets");const g=v[2]-v[0],p=v[3]-v[1],M=g*p,w=this.getSamplesPerPixel();if(!s||!s.length)for(let T=0;T<w;++T)s.push(T);else for(let T=0;T<s.length;++T)if(s[T]>=w)return Promise.reject(new RangeError(`Invalid sample index '${s[T]}'.`));let P;if(o){const T=this.fileDirectory.SampleFormat?Math.max.apply(null,this.fileDirectory.SampleFormat):1,S=Math.max.apply(null,this.fileDirectory.BitsPerSample);P=xa(T,S,M*s.length),d&&P.fill(d)}else{P=[];for(let T=0;T<s.length;++T){const S=this.getArrayForSample(s[T],M);Array.isArray(d)&&T<d.length?S.fill(d[T]):d&&!Array.isArray(d)&&S.fill(d),P.push(S)}}const x=r||await Dc(this.fileDirectory);return await this._readRaster(v,s,P,o,x,h,u,c,_)}async readRGB({window:i,interleave:s=!0,pool:o=null,width:r,height:h,resampleMethod:u,enableAlpha:c=!1,signal:d}={}){const _=i||[0,0,this.getWidth(),this.getHeight()];if(_[0]>_[2]||_[1]>_[3])throw new Error("Invalid subsets");const v=this.fileDirectory.PhotometricInterpretation;if(v===Zt.RGB){let A=[0,1,2];if(this.fileDirectory.ExtraSamples!==bc.Unspecified&&c){A=[];for(let T=0;T<this.fileDirectory.BitsPerSample.length;T+=1)A.push(T)}return this.readRasters({window:i,interleave:s,samples:A,pool:o,width:r,height:h,resampleMethod:u,signal:d})}let g;switch(v){case Zt.WhiteIsZero:case Zt.BlackIsZero:case Zt.Palette:g=[0];break;case Zt.CMYK:g=[0,1,2,3];break;case Zt.YCbCr:case Zt.CIELab:g=[0,1,2];break;default:throw new Error("Invalid or unsupported photometric interpretation.")}const p={window:_,interleave:!0,samples:g,pool:o,width:r,height:h,resampleMethod:u,signal:d},{fileDirectory:M}=this,w=await this.readRasters(p),P=2**this.fileDirectory.BitsPerSample[0];let x;switch(v){case Zt.WhiteIsZero:x=Ec(w,P);break;case Zt.BlackIsZero:x=Tc(w,P);break;case Zt.Palette:x=Lc(w,M.ColorMap);break;case Zt.CMYK:x=Ac(w);break;case Zt.YCbCr:x=Cc(w);break;case Zt.CIELab:x=Oc(w);break;default:throw new Error("Unsupported photometric interpretation.")}if(!s){const A=new Uint8Array(x.length/3),T=new Uint8Array(x.length/3),S=new Uint8Array(x.length/3);for(let I=0,O=0;I<x.length;I+=3,++O)A[O]=x[I],T[O]=x[I+1],S[O]=x[I+2];x=[A,T,S]}return x.width=w.width,x.height=w.height,x}getTiePoints(){if(!this.fileDirectory.ModelTiepoint)return[];const i=[];for(let s=0;s<this.fileDirectory.ModelTiepoint.length;s+=6)i.push({i:this.fileDirectory.ModelTiepoint[s],j:this.fileDirectory.ModelTiepoint[s+1],k:this.fileDirectory.ModelTiepoint[s+2],x:this.fileDirectory.ModelTiepoint[s+3],y:this.fileDirectory.ModelTiepoint[s+4],z:this.fileDirectory.ModelTiepoint[s+5]});return i}getGDALMetadata(i=null){const s={};if(!this.fileDirectory.GDAL_METADATA)return null;const o=this.fileDirectory.GDAL_METADATA;let r=xc(o,"Item");i===null?r=r.filter(h=>da(h,"sample")===void 0):r=r.filter(h=>Number(da(h,"sample"))===i);for(let h=0;h<r.length;++h){const u=r[h];s[da(u,"name")]=u.inner}return s}getGDALNoData(){if(!this.fileDirectory.GDAL_NODATA)return null;const i=this.fileDirectory.GDAL_NODATA;return Number(i.substring(0,i.length-1))}getOrigin(){const i=this.fileDirectory.ModelTiepoint,s=this.fileDirectory.ModelTransformation;if(i&&i.length===6)return[i[3],i[4],i[5]];if(s)return[s[3],s[7],s[11]];throw new Error("The image does not have an affine transformation.")}getResolution(i=null){const s=this.fileDirectory.ModelPixelScale,o=this.fileDirectory.ModelTransformation;if(s)return[s[0],-s[1],s[2]];if(o)return o[1]===0&&o[4]===0?[o[0],-o[5],o[10]]:[Math.sqrt(o[0]*o[0]+o[4]*o[4]),-Math.sqrt(o[1]*o[1]+o[5]*o[5]),o[10]];if(i){const[r,h,u]=i.getResolution();return[r*i.getWidth()/this.getWidth(),h*i.getHeight()/this.getHeight(),u*i.getWidth()/this.getWidth()]}throw new Error("The image does not have an affine transformation.")}pixelIsArea(){return this.geoKeys.GTRasterTypeGeoKey===1}getBoundingBox(i=!1){const s=this.getHeight(),o=this.getWidth();if(this.fileDirectory.ModelTransformation&&!i){const[r,h,u,c,d,_,v,g]=this.fileDirectory.ModelTransformation,M=[[0,0],[0,s],[o,0],[o,s]].map(([x,A])=>[c+r*x+h*A,g+d*x+_*A]),w=M.map(x=>x[0]),P=M.map(x=>x[1]);return[Math.min(...w),Math.min(...P),Math.max(...w),Math.max(...P)]}else{const r=this.getOrigin(),h=this.getResolution(),u=r[0],c=r[1],d=u+h[0]*o,_=c+h[1]*s;return[Math.min(u,d),Math.min(c,_),Math.max(u,d),Math.max(c,_)]}}}class Wc{constructor(i){this._dataView=new DataView(i)}get buffer(){return this._dataView.buffer}getUint64(i,s){const o=this.getUint32(i,s),r=this.getUint32(i+4,s);let h;if(s){if(h=o+2**32*r,!Number.isSafeInteger(h))throw new Error(`${h} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return h}if(h=2**32*o+r,!Number.isSafeInteger(h))throw new Error(`${h} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return h}getInt64(i,s){let o=0;const r=(this._dataView.getUint8(i+(s?7:0))&128)>0;let h=!0;for(let u=0;u<8;u++){let c=this._dataView.getUint8(i+(s?u:7-u));r&&(h?c!==0&&(c=~(c-1)&255,h=!1):c=~c&255),o+=c*256**u}return r&&(o=-o),o}getUint8(i,s){return this._dataView.getUint8(i,s)}getInt8(i,s){return this._dataView.getInt8(i,s)}getUint16(i,s){return this._dataView.getUint16(i,s)}getInt16(i,s){return this._dataView.getInt16(i,s)}getUint32(i,s){return this._dataView.getUint32(i,s)}getInt32(i,s){return this._dataView.getInt32(i,s)}getFloat16(i,s){return jo(this._dataView,i,s)}getFloat32(i,s){return this._dataView.getFloat32(i,s)}getFloat64(i,s){return this._dataView.getFloat64(i,s)}}class Kc{constructor(i,s,o,r){this._dataView=new DataView(i),this._sliceOffset=s,this._littleEndian=o,this._bigTiff=r}get sliceOffset(){return this._sliceOffset}get sliceTop(){return this._sliceOffset+this.buffer.byteLength}get littleEndian(){return this._littleEndian}get bigTiff(){return this._bigTiff}get buffer(){return this._dataView.buffer}covers(i,s){return this.sliceOffset<=i&&this.sliceTop>=i+s}readUint8(i){return this._dataView.getUint8(i-this._sliceOffset,this._littleEndian)}readInt8(i){return this._dataView.getInt8(i-this._sliceOffset,this._littleEndian)}readUint16(i){return this._dataView.getUint16(i-this._sliceOffset,this._littleEndian)}readInt16(i){return this._dataView.getInt16(i-this._sliceOffset,this._littleEndian)}readUint32(i){return this._dataView.getUint32(i-this._sliceOffset,this._littleEndian)}readInt32(i){return this._dataView.getInt32(i-this._sliceOffset,this._littleEndian)}readFloat32(i){return this._dataView.getFloat32(i-this._sliceOffset,this._littleEndian)}readFloat64(i){return this._dataView.getFloat64(i-this._sliceOffset,this._littleEndian)}readUint64(i){const s=this.readUint32(i),o=this.readUint32(i+4);let r;if(this._littleEndian){if(r=s+2**32*o,!Number.isSafeInteger(r))throw new Error(`${r} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return r}if(r=2**32*s+o,!Number.isSafeInteger(r))throw new Error(`${r} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return r}readInt64(i){let s=0;const o=(this._dataView.getUint8(i+(this._littleEndian?7:0))&128)>0;let r=!0;for(let h=0;h<8;h++){let u=this._dataView.getUint8(i+(this._littleEndian?h:7-h));o&&(r?u!==0&&(u=~(u-1)&255,r=!1):u=~u&255),s+=u*256**h}return o&&(s=-s),s}readOffset(i){return this._bigTiff?this.readUint64(i):this.readUint32(i)}}class Xc{async fetch(i,s=void 0){return Promise.all(i.map(o=>this.fetchSlice(o,s)))}async fetchSlice(i){throw new Error(`fetching of slice ${i} not possible, not implemented`)}get fileSize(){return null}async close(){}}class Xa extends Error{constructor(i){super(i),Error.captureStackTrace&&Error.captureStackTrace(this,Xa),this.name="AbortError"}}class Yc extends Xc{constructor(i){super(),this.arrayBuffer=i}fetchSlice(i,s){if(s&&s.aborted)throw new Xa("Request aborted");return this.arrayBuffer.slice(i.offset,i.offset+i.length)}}function Jc(e){return new Yc(e)}function Pa(e){switch(e){case Y.BYTE:case Y.ASCII:case Y.SBYTE:case Y.UNDEFINED:return 1;case Y.SHORT:case Y.SSHORT:return 2;case Y.LONG:case Y.SLONG:case Y.FLOAT:case Y.IFD:return 4;case Y.RATIONAL:case Y.SRATIONAL:case Y.DOUBLE:case Y.LONG8:case Y.SLONG8:case Y.IFD8:return 8;default:throw new RangeError(`Invalid field type: ${e}`)}}function Qc(e){const i=e.GeoKeyDirectory;if(!i)return null;const s={};for(let o=4;o<=i[3]*4;o+=4){const r=Sc[i[o]],h=i[o+1]?rn[i[o+1]]:null,u=i[o+2],c=i[o+3];let d=null;if(!h)d=c;else{if(d=e[h],typeof d>"u"||d===null)throw new Error(`Could not get value of geoKey '${r}'.`);typeof d=="string"?d=d.substring(c,c+u-1):d.subarray&&(d=d.subarray(c,c+u),u===1&&(d=d[0]))}s[r]=d}return s}function di(e,i,s,o){let r=null,h=null;const u=Pa(i);switch(i){case Y.BYTE:case Y.ASCII:case Y.UNDEFINED:r=new Uint8Array(s),h=e.readUint8;break;case Y.SBYTE:r=new Int8Array(s),h=e.readInt8;break;case Y.SHORT:r=new Uint16Array(s),h=e.readUint16;break;case Y.SSHORT:r=new Int16Array(s),h=e.readInt16;break;case Y.LONG:case Y.IFD:r=new Uint32Array(s),h=e.readUint32;break;case Y.SLONG:r=new Int32Array(s),h=e.readInt32;break;case Y.LONG8:case Y.IFD8:r=new Array(s),h=e.readUint64;break;case Y.SLONG8:r=new Array(s),h=e.readInt64;break;case Y.RATIONAL:r=new Uint32Array(s*2),h=e.readUint32;break;case Y.SRATIONAL:r=new Int32Array(s*2),h=e.readInt32;break;case Y.FLOAT:r=new Float32Array(s),h=e.readFloat32;break;case Y.DOUBLE:r=new Float64Array(s),h=e.readFloat64;break;default:throw new RangeError(`Invalid field type: ${i}`)}if(i===Y.RATIONAL||i===Y.SRATIONAL)for(let c=0;c<s;c+=2)r[c]=h.call(e,o+c*u),r[c+1]=h.call(e,o+(c*u+4));else for(let c=0;c<s;++c)r[c]=h.call(e,o+c*u);return i===Y.ASCII?new TextDecoder("utf-8").decode(r):r}class tu{constructor(i,s,o){this.fileDirectory=i,this.geoKeyDirectory=s,this.nextIFDByteOffset=o}}class as extends Error{constructor(i){super(`No image at index ${i}`),this.index=i}}class eu{async readRasters(i={}){const{window:s,width:o,height:r}=i;let{resX:h,resY:u,bbox:c}=i;const d=await this.getImage();let _=d;const v=await this.getImageCount(),g=d.getBoundingBox();if(s&&c)throw new Error('Both "bbox" and "window" passed.');if(o||r){if(s){const[w,P]=d.getOrigin(),[x,A]=d.getResolution();c=[w+s[0]*x,P+s[1]*A,w+s[2]*x,P+s[3]*A]}const M=c||g;if(o){if(h)throw new Error("Both width and resX passed");h=(M[2]-M[0])/o}if(r){if(u)throw new Error("Both width and resY passed");u=(M[3]-M[1])/r}}if(h||u){const M=[];for(let w=0;w<v;++w){const P=await this.getImage(w),{SubfileType:x,NewSubfileType:A}=P.fileDirectory;(w===0||x===2||A&1)&&M.push(P)}M.sort((w,P)=>w.getWidth()-P.getWidth());for(let w=0;w<M.length;++w){const P=M[w],x=(g[2]-g[0])/P.getWidth(),A=(g[3]-g[1])/P.getHeight();if(_=P,h&&h>x||u&&u>A)break}}let p=s;if(c){const[M,w]=d.getOrigin(),[P,x]=_.getResolution(d);p=[Math.round((c[0]-M)/P),Math.round((c[1]-w)/x),Math.round((c[2]-M)/P),Math.round((c[3]-w)/x)],p=[Math.min(p[0],p[2]),Math.min(p[1],p[3]),Math.max(p[0],p[2]),Math.max(p[1],p[3])]}return _.readRasters({...i,window:p})}}class Ya extends eu{constructor(i,s,o,r,h={}){super(),this.source=i,this.littleEndian=s,this.bigTiff=o,this.firstIFDOffset=r,this.cache=h.cache||!1,this.ifdRequests=[],this.ghostValues=null}async getSlice(i,s){const o=this.bigTiff?4048:1024;return new Kc((await this.source.fetch([{offset:i,length:typeof s<"u"?s:o}]))[0],i,this.littleEndian,this.bigTiff)}async parseFileDirectoryAt(i){const s=this.bigTiff?20:12,o=this.bigTiff?8:2;let r=await this.getSlice(i);const h=this.bigTiff?r.readUint64(i):r.readUint16(i),u=h*s+(this.bigTiff?16:6);r.covers(i,u)||(r=await this.getSlice(i,u));const c={};let d=i+(this.bigTiff?8:2);for(let g=0;g<h;d+=s,++g){const p=r.readUint16(d),M=r.readUint16(d+2),w=this.bigTiff?r.readUint64(d+4):r.readUint32(d+4);let P,x;const A=Pa(M),T=d+(this.bigTiff?12:8);if(A*w<=(this.bigTiff?8:4))P=di(r,M,w,T);else{const S=r.readOffset(T),I=Pa(M)*w;if(r.covers(S,I))P=di(r,M,w,S);else{const O=await this.getSlice(S,I);P=di(O,M,w,S)}}w===1&&Pc.indexOf(p)===-1&&!(M===Y.RATIONAL||M===Y.SRATIONAL)?x=P[0]:x=P,c[rn[p]]=x}const _=Qc(c),v=r.readOffset(i+o+s*h);return new tu(c,_,v)}async requestIFD(i){if(this.ifdRequests[i])return this.ifdRequests[i];if(i===0)return this.ifdRequests[i]=this.parseFileDirectoryAt(this.firstIFDOffset),this.ifdRequests[i];if(!this.ifdRequests[i-1])try{this.ifdRequests[i-1]=this.requestIFD(i-1)}catch(s){throw s instanceof as?new as(i):s}return this.ifdRequests[i]=(async()=>{const s=await this.ifdRequests[i-1];if(s.nextIFDByteOffset===0)throw new as(i);return this.parseFileDirectoryAt(s.nextIFDByteOffset)})(),this.ifdRequests[i]}async getImage(i=0){const s=await this.requestIFD(i);return new Vc(s.fileDirectory,s.geoKeyDirectory,this.dataView,this.littleEndian,this.cache,this.source)}async getImageCount(){let i=0,s=!0;for(;s;)try{await this.requestIFD(i),++i}catch(o){if(o instanceof as)s=!1;else throw o}return i}async getGhostValues(){const i=this.bigTiff?16:8;if(this.ghostValues)return this.ghostValues;const s="GDAL_STRUCTURAL_METADATA_SIZE=",o=s.length+100;let r=await this.getSlice(i,o);if(s===di(r,Y.ASCII,s.length,i)){const u=di(r,Y.ASCII,o,i).split(`
`)[0],c=Number(u.split("=")[1].split(" ")[0])+u.length;c>o&&(r=await this.getSlice(i,c));const d=di(r,Y.ASCII,c,i);this.ghostValues={},d.split(`
`).filter(_=>_.length>0).map(_=>_.split("=")).forEach(([_,v])=>{this.ghostValues[_]=v})}return this.ghostValues}static async fromSource(i,s,o){const r=(await i.fetch([{offset:0,length:1024}],o))[0],h=new Wc(r),u=h.getUint16(0,0);let c;if(u===18761)c=!0;else if(u===19789)c=!1;else throw new TypeError("Invalid byte order value.");const d=h.getUint16(2,c);let _;if(d===42)_=!1;else if(d===43){if(_=!0,h.getUint16(4,c)!==8)throw new Error("Unsupported offset byte-size.")}else throw new TypeError("Invalid magic number.");const v=_?h.getUint64(8,c):h.getUint32(4,c);return new Ya(i,c,_,v,s)}close(){return typeof this.source.close=="function"?this.source.close():!1}}async function iu(e,i){return Ya.fromSource(Jc(e),i)}function nu(e){e("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),e("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),e("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");for(var i=1;i<=60;++i)e("EPSG:"+(32600+i),"+proj=utm +zone="+i+" +datum=WGS84 +units=m"),e("EPSG:"+(32700+i),"+proj=utm +zone="+i+" +south +datum=WGS84 +units=m");e.WGS84=e["EPSG:4326"],e["EPSG:3785"]=e["EPSG:3857"],e.GOOGLE=e["EPSG:3857"],e["EPSG:900913"]=e["EPSG:3857"],e["EPSG:102113"]=e["EPSG:3857"]}var Ke=1,Xe=2,wi=3,su=4,ba=5,ao=6378137,au=6356752314e-3,ro=.0066943799901413165,on=484813681109536e-20,G=Math.PI/2,ru=.16666666666666666,ou=.04722222222222222,hu=.022156084656084655,R=1e-10,Lt=.017453292519943295,ue=57.29577951308232,ht=Math.PI/4,mn=Math.PI*2,Mt=3.14159265359,Ft={};Ft.greenwich=0;Ft.lisbon=-9.131906111111;Ft.paris=2.337229166667;Ft.bogota=-74.080916666667;Ft.madrid=-3.687938888889;Ft.rome=12.452333333333;Ft.bern=7.439583333333;Ft.jakarta=106.807719444444;Ft.ferro=-17.666666666667;Ft.brussels=4.367975;Ft.stockholm=18.058277777778;Ft.athens=23.7163375;Ft.oslo=10.722916666667;const lu={mm:{to_meter:.001},cm:{to_meter:.01},ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937},fath:{to_meter:1.8288},kmi:{to_meter:1852},"us-ch":{to_meter:20.1168402336805},"us-mi":{to_meter:1609.34721869444},km:{to_meter:1e3},"ind-ft":{to_meter:.30479841},"ind-yd":{to_meter:.91439523},mi:{to_meter:1609.344},yd:{to_meter:.9144},ch:{to_meter:20.1168},link:{to_meter:.201168},dm:{to_meter:.1},in:{to_meter:.0254},"ind-ch":{to_meter:20.11669506},"us-in":{to_meter:.025400050800101},"us-yd":{to_meter:.914401828803658}};var oo=/[\s_\-\/\(\)]/g;function Ie(e,i){if(e[i])return e[i];for(var s=Object.keys(e),o=i.toLowerCase().replace(oo,""),r=-1,h,u;++r<s.length;)if(h=s[r],u=h.toLowerCase().replace(oo,""),u===o)return e[h]}function Sa(e){var i={},s=e.split("+").map(function(c){return c.trim()}).filter(function(c){return c}).reduce(function(c,d){var _=d.split("=");return _.push(!0),c[_[0].toLowerCase()]=_[1],c},{}),o,r,h,u={proj:"projName",datum:"datumCode",rf:function(c){i.rf=parseFloat(c)},lat_0:function(c){i.lat0=c*Lt},lat_1:function(c){i.lat1=c*Lt},lat_2:function(c){i.lat2=c*Lt},lat_ts:function(c){i.lat_ts=c*Lt},lon_0:function(c){i.long0=c*Lt},lon_1:function(c){i.long1=c*Lt},lon_2:function(c){i.long2=c*Lt},alpha:function(c){i.alpha=parseFloat(c)*Lt},gamma:function(c){i.rectified_grid_angle=parseFloat(c)*Lt},lonc:function(c){i.longc=c*Lt},x_0:function(c){i.x0=parseFloat(c)},y_0:function(c){i.y0=parseFloat(c)},k_0:function(c){i.k0=parseFloat(c)},k:function(c){i.k0=parseFloat(c)},a:function(c){i.a=parseFloat(c)},b:function(c){i.b=parseFloat(c)},r:function(c){i.a=i.b=parseFloat(c)},r_a:function(){i.R_A=!0},zone:function(c){i.zone=parseInt(c,10)},south:function(){i.utmSouth=!0},towgs84:function(c){i.datum_params=c.split(",").map(function(d){return parseFloat(d)})},to_meter:function(c){i.to_meter=parseFloat(c)},units:function(c){i.units=c;var d=Ie(lu,c);d&&(i.to_meter=d.to_meter)},from_greenwich:function(c){i.from_greenwich=c*Lt},pm:function(c){var d=Ie(Ft,c);i.from_greenwich=(d||parseFloat(c))*Lt},nadgrids:function(c){c==="@null"?i.datumCode="none":i.nadgrids=c},axis:function(c){var d="ewnsud";c.length===3&&d.indexOf(c.substr(0,1))!==-1&&d.indexOf(c.substr(1,1))!==-1&&d.indexOf(c.substr(2,1))!==-1&&(i.axis=c)},approx:function(){i.approx=!0}};for(o in s)r=s[o],o in u?(h=u[o],typeof h=="function"?h(r):i[h]=r):i[o]=r;return typeof i.datumCode=="string"&&i.datumCode!=="WGS84"&&(i.datumCode=i.datumCode.toLowerCase()),i}class Jo{static getId(i){const s=i.find(o=>Array.isArray(o)&&o[0]==="ID");return s&&s.length>=3?{authority:s[1],code:parseInt(s[2],10)}:null}static convertUnit(i,s="unit"){if(!i||i.length<3)return{type:s,name:"unknown",conversion_factor:null};const o=i[1],r=parseFloat(i[2])||null,h=i.find(c=>Array.isArray(c)&&c[0]==="ID"),u=h?{authority:h[1],code:parseInt(h[2],10)}:null;return{type:s,name:o,conversion_factor:r,id:u}}static convertAxis(i){const s=i[1]||"Unknown";let o;const r=s.match(/^\((.)\)$/);if(r){const _=r[1].toUpperCase();if(_==="E")o="east";else if(_==="N")o="north";else if(_==="U")o="up";else throw new Error(`Unknown axis abbreviation: ${_}`)}else o=i[2]?i[2].toLowerCase():"unknown";const h=i.find(_=>Array.isArray(_)&&_[0]==="ORDER"),u=h?parseInt(h[1],10):null,c=i.find(_=>Array.isArray(_)&&(_[0]==="LENGTHUNIT"||_[0]==="ANGLEUNIT"||_[0]==="SCALEUNIT")),d=this.convertUnit(c);return{name:s,direction:o,unit:d,order:u}}static extractAxes(i){return i.filter(s=>Array.isArray(s)&&s[0]==="AXIS").map(s=>this.convertAxis(s)).sort((s,o)=>(s.order||0)-(o.order||0))}static convert(i,s={}){switch(i[0]){case"PROJCRS":s.type="ProjectedCRS",s.name=i[1],s.base_crs=i.find(p=>Array.isArray(p)&&p[0]==="BASEGEOGCRS")?this.convert(i.find(p=>Array.isArray(p)&&p[0]==="BASEGEOGCRS")):null,s.conversion=i.find(p=>Array.isArray(p)&&p[0]==="CONVERSION")?this.convert(i.find(p=>Array.isArray(p)&&p[0]==="CONVERSION")):null;const o=i.find(p=>Array.isArray(p)&&p[0]==="CS");o&&(s.coordinate_system={type:o[1],axis:this.extractAxes(i)});const r=i.find(p=>Array.isArray(p)&&p[0]==="LENGTHUNIT");if(r){const p=this.convertUnit(r);s.coordinate_system.unit=p}s.id=this.getId(i);break;case"BASEGEOGCRS":case"GEOGCRS":s.type="GeographicCRS",s.name=i[1];const h=i.find(p=>Array.isArray(p)&&(p[0]==="DATUM"||p[0]==="ENSEMBLE"));if(h){const p=this.convert(h);h[0]==="ENSEMBLE"?s.datum_ensemble=p:s.datum=p;const M=i.find(w=>Array.isArray(w)&&w[0]==="PRIMEM");M&&M[1]!=="Greenwich"&&(p.prime_meridian={name:M[1],longitude:parseFloat(M[2])})}s.coordinate_system={type:"ellipsoidal",axis:this.extractAxes(i)},s.id=this.getId(i);break;case"DATUM":s.type="GeodeticReferenceFrame",s.name=i[1],s.ellipsoid=i.find(p=>Array.isArray(p)&&p[0]==="ELLIPSOID")?this.convert(i.find(p=>Array.isArray(p)&&p[0]==="ELLIPSOID")):null;break;case"ENSEMBLE":s.type="DatumEnsemble",s.name=i[1],s.members=i.filter(p=>Array.isArray(p)&&p[0]==="MEMBER").map(p=>({type:"DatumEnsembleMember",name:p[1],id:this.getId(p)}));const u=i.find(p=>Array.isArray(p)&&p[0]==="ENSEMBLEACCURACY");u&&(s.accuracy=parseFloat(u[1]));const c=i.find(p=>Array.isArray(p)&&p[0]==="ELLIPSOID");c&&(s.ellipsoid=this.convert(c)),s.id=this.getId(i);break;case"ELLIPSOID":s.type="Ellipsoid",s.name=i[1],s.semi_major_axis=parseFloat(i[2]),s.inverse_flattening=parseFloat(i[3]),i.find(p=>Array.isArray(p)&&p[0]==="LENGTHUNIT")&&this.convert(i.find(p=>Array.isArray(p)&&p[0]==="LENGTHUNIT"),s);break;case"CONVERSION":s.type="Conversion",s.name=i[1],s.method=i.find(p=>Array.isArray(p)&&p[0]==="METHOD")?this.convert(i.find(p=>Array.isArray(p)&&p[0]==="METHOD")):null,s.parameters=i.filter(p=>Array.isArray(p)&&p[0]==="PARAMETER").map(p=>this.convert(p));break;case"METHOD":s.type="Method",s.name=i[1],s.id=this.getId(i);break;case"PARAMETER":s.type="Parameter",s.name=i[1],s.value=parseFloat(i[2]),s.unit=this.convertUnit(i.find(p=>Array.isArray(p)&&(p[0]==="LENGTHUNIT"||p[0]==="ANGLEUNIT"||p[0]==="SCALEUNIT"))),s.id=this.getId(i);break;case"BOUNDCRS":s.type="BoundCRS";const d=i.find(p=>Array.isArray(p)&&p[0]==="SOURCECRS");if(d){const p=d.find(M=>Array.isArray(M));s.source_crs=p?this.convert(p):null}const _=i.find(p=>Array.isArray(p)&&p[0]==="TARGETCRS");if(_){const p=_.find(M=>Array.isArray(M));s.target_crs=p?this.convert(p):null}const v=i.find(p=>Array.isArray(p)&&p[0]==="ABRIDGEDTRANSFORMATION");v?s.transformation=this.convert(v):s.transformation=null;break;case"ABRIDGEDTRANSFORMATION":if(s.type="Transformation",s.name=i[1],s.method=i.find(p=>Array.isArray(p)&&p[0]==="METHOD")?this.convert(i.find(p=>Array.isArray(p)&&p[0]==="METHOD")):null,s.parameters=i.filter(p=>Array.isArray(p)&&(p[0]==="PARAMETER"||p[0]==="PARAMETERFILE")).map(p=>{if(p[0]==="PARAMETER")return this.convert(p);if(p[0]==="PARAMETERFILE")return{name:p[1],value:p[2],id:{authority:"EPSG",code:8656}}}),s.parameters.length===7){const p=s.parameters[6];p.name==="Scale difference"&&(p.value=Math.round((p.value-1)*1e12)/1e6)}s.id=this.getId(i);break;case"AXIS":s.coordinate_system||(s.coordinate_system={type:"unspecified",axis:[]}),s.coordinate_system.axis.push(this.convertAxis(i));break;case"LENGTHUNIT":const g=this.convertUnit(i,"LinearUnit");s.coordinate_system&&s.coordinate_system.axis&&s.coordinate_system.axis.forEach(p=>{p.unit||(p.unit=g)}),g.conversion_factor&&g.conversion_factor!==1&&s.semi_major_axis&&(s.semi_major_axis={value:s.semi_major_axis,unit:g});break;default:s.keyword=i[0];break}return s}}class cu extends Jo{static convert(i,s={}){return super.convert(i,s),s.coordinate_system&&s.coordinate_system.subtype==="Cartesian"&&delete s.coordinate_system,s.usage&&delete s.usage,s}}class uu extends Jo{static convert(i,s={}){super.convert(i,s);const o=i.find(h=>Array.isArray(h)&&h[0]==="CS");o&&(s.coordinate_system={subtype:o[1],axis:this.extractAxes(i)});const r=i.find(h=>Array.isArray(h)&&h[0]==="USAGE");if(r){const h=r.find(d=>Array.isArray(d)&&d[0]==="SCOPE"),u=r.find(d=>Array.isArray(d)&&d[0]==="AREA"),c=r.find(d=>Array.isArray(d)&&d[0]==="BBOX");s.usage={},h&&(s.usage.scope=h[1]),u&&(s.usage.area=u[1]),c&&(s.usage.bbox=c.slice(1))}return s}}function fu(e){return e.find(i=>Array.isArray(i)&&i[0]==="USAGE")?"2019":(e.find(i=>Array.isArray(i)&&i[0]==="CS")||e[0]==="BOUNDCRS"||e[0]==="PROJCRS"||e[0]==="GEOGCRS","2015")}function du(e){return(fu(e)==="2019"?uu:cu).convert(e)}function _u(e){const i=e.toUpperCase();return i.includes("PROJCRS")||i.includes("GEOGCRS")||i.includes("BOUNDCRS")||i.includes("VERTCRS")||i.includes("LENGTHUNIT")||i.includes("ANGLEUNIT")||i.includes("SCALEUNIT")?"WKT2":(i.includes("PROJCS")||i.includes("GEOGCS")||i.includes("LOCAL_CS")||i.includes("VERT_CS")||i.includes("UNIT"),"WKT1")}var gn=1,Qo=2,th=3,ms=4,eh=5,Ja=-1,mu=/\s/,gu=/[A-Za-z]/,pu=/[A-Za-z84_]/,As=/[,\]]/,ih=/[\d\.E\-\+]/;function Se(e){if(typeof e!="string")throw new Error("not a string");this.text=e.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=gn}Se.prototype.readCharicter=function(){var e=this.text[this.place++];if(this.state!==ms)for(;mu.test(e);){if(this.place>=this.text.length)return;e=this.text[this.place++]}switch(this.state){case gn:return this.neutral(e);case Qo:return this.keyword(e);case ms:return this.quoted(e);case eh:return this.afterquote(e);case th:return this.number(e);case Ja:return}};Se.prototype.afterquote=function(e){if(e==='"'){this.word+='"',this.state=ms;return}if(As.test(e)){this.word=this.word.trim(),this.afterItem(e);return}throw new Error(`havn't handled "`+e+'" in afterquote yet, index '+this.place)};Se.prototype.afterItem=function(e){if(e===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=gn;return}if(e==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=gn,this.currentObject=this.stack.pop(),this.currentObject||(this.state=Ja);return}};Se.prototype.number=function(e){if(ih.test(e)){this.word+=e;return}if(As.test(e)){this.word=parseFloat(this.word),this.afterItem(e);return}throw new Error(`havn't handled "`+e+'" in number yet, index '+this.place)};Se.prototype.quoted=function(e){if(e==='"'){this.state=eh;return}this.word+=e};Se.prototype.keyword=function(e){if(pu.test(e)){this.word+=e;return}if(e==="["){var i=[];i.push(this.word),this.level++,this.root===null?this.root=i:this.currentObject.push(i),this.stack.push(this.currentObject),this.currentObject=i,this.state=gn;return}if(As.test(e)){this.afterItem(e);return}throw new Error(`havn't handled "`+e+'" in keyword yet, index '+this.place)};Se.prototype.neutral=function(e){if(gu.test(e)){this.word=e,this.state=Qo;return}if(e==='"'){this.word="",this.state=ms;return}if(ih.test(e)){this.word=e,this.state=th;return}if(As.test(e)){this.afterItem(e);return}throw new Error(`havn't handled "`+e+'" in neutral yet, index '+this.place)};Se.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===Ja)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function vu(e){var i=new Se(e);return i.output()}function ga(e,i,s){Array.isArray(i)&&(s.unshift(i),i=null);var o=i?{}:e,r=s.reduce(function(h,u){return mi(u,h),h},o);i&&(e[i]=r)}function mi(e,i){if(!Array.isArray(e)){i[e]=!0;return}var s=e.shift();if(s==="PARAMETER"&&(s=e.shift()),e.length===1){if(Array.isArray(e[0])){i[s]={},mi(e[0],i[s]);return}i[s]=e[0];return}if(!e.length){i[s]=!0;return}if(s==="TOWGS84"){i[s]=e;return}if(s==="AXIS"){s in i||(i[s]=[]),i[s].push(e);return}Array.isArray(s)||(i[s]={});var o;switch(s){case"UNIT":case"PRIMEM":case"VERT_DATUM":i[s]={name:e[0].toLowerCase(),convert:e[1]},e.length===3&&mi(e[2],i[s]);return;case"SPHEROID":case"ELLIPSOID":i[s]={name:e[0],a:e[1],rf:e[2]},e.length===4&&mi(e[3],i[s]);return;case"EDATUM":case"ENGINEERINGDATUM":case"LOCAL_DATUM":case"DATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":e[0]=["name",e[0]],ga(i,s,e);return;case"COMPD_CS":case"COMPOUNDCRS":case"FITTED_CS":case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"ENGCRS":case"ENGINEERINGCRS":e[0]=["name",e[0]],ga(i,s,e),i[s].type=s;return;default:for(o=-1;++o<e.length;)if(!Array.isArray(e[o]))return mi(e,i[s]);return ga(i,s,e)}}var yu=.017453292519943295;function ee(e){return e*yu}function nh(e){const i=(e.projName||"").toLowerCase().replace(/_/g," ");!e.long0&&e.longc&&(i==="albers conic equal area"||i==="lambert azimuthal equal area")&&(e.long0=e.longc),!e.lat_ts&&e.lat1&&(i==="stereographic south pole"||i==="polar stereographic (variant b)")?(e.lat0=ee(e.lat1>0?90:-90),e.lat_ts=e.lat1,delete e.lat1):!e.lat_ts&&e.lat0&&(i==="polar stereographic"||i==="polar stereographic (variant a)")&&(e.lat_ts=e.lat0,e.lat0=ee(e.lat0>0?90:-90),delete e.lat1)}function ho(e){let i={units:null,to_meter:void 0};return typeof e=="string"?(i.units=e.toLowerCase(),i.units==="metre"&&(i.units="meter"),i.units==="meter"&&(i.to_meter=1)):e&&e.name&&(i.units=e.name.toLowerCase(),i.units==="metre"&&(i.units="meter"),i.to_meter=e.conversion_factor),i}function lo(e){return typeof e=="object"?e.value*e.unit.conversion_factor:e}function co(e,i){e.ellipsoid.radius?(i.a=e.ellipsoid.radius,i.rf=0):(i.a=lo(e.ellipsoid.semi_major_axis),e.ellipsoid.inverse_flattening!==void 0?i.rf=e.ellipsoid.inverse_flattening:e.ellipsoid.semi_major_axis!==void 0&&e.ellipsoid.semi_minor_axis!==void 0&&(i.rf=i.a/(i.a-lo(e.ellipsoid.semi_minor_axis))))}function gs(e,i={}){return!e||typeof e!="object"?e:e.type==="BoundCRS"?(gs(e.source_crs,i),e.transformation&&(e.transformation.method&&e.transformation.method.name==="NTv2"?i.nadgrids=e.transformation.parameters[0].value:i.datum_params=e.transformation.parameters.map(s=>s.value)),i):(Object.keys(e).forEach(s=>{const o=e[s];if(o!==null)switch(s){case"name":if(i.srsCode)break;i.name=o,i.srsCode=o;break;case"type":o==="GeographicCRS"?i.projName="longlat":o==="ProjectedCRS"&&e.conversion&&e.conversion.method&&(i.projName=e.conversion.method.name);break;case"datum":case"datum_ensemble":o.ellipsoid&&(i.ellps=o.ellipsoid.name,co(o,i)),o.prime_meridian&&(i.from_greenwich=o.prime_meridian.longitude*Math.PI/180);break;case"ellipsoid":i.ellps=o.name,co(o,i);break;case"prime_meridian":i.long0=(o.longitude||0)*Math.PI/180;break;case"coordinate_system":if(o.axis){if(i.axis=o.axis.map(r=>{const h=r.direction;if(h==="east")return"e";if(h==="north")return"n";if(h==="west")return"w";if(h==="south")return"s";throw new Error(`Unknown axis direction: ${h}`)}).join("")+"u",o.unit){const{units:r,to_meter:h}=ho(o.unit);i.units=r,i.to_meter=h}else if(o.axis[0]&&o.axis[0].unit){const{units:r,to_meter:h}=ho(o.axis[0].unit);i.units=r,i.to_meter=h}}break;case"id":o.authority&&o.code&&(i.title=o.authority+":"+o.code);break;case"conversion":o.method&&o.method.name&&(i.projName=o.method.name),o.parameters&&o.parameters.forEach(r=>{const h=r.name.toLowerCase().replace(/\s+/g,"_"),u=r.value;r.unit&&r.unit.conversion_factor?i[h]=u*r.unit.conversion_factor:r.unit==="degree"?i[h]=u*Math.PI/180:i[h]=u});break;case"unit":o.name&&(i.units=o.name.toLowerCase(),i.units==="metre"&&(i.units="meter")),o.conversion_factor&&(i.to_meter=o.conversion_factor);break;case"base_crs":gs(o,i),i.datumCode=o.id?o.id.authority+"_"+o.id.code:o.name;break}}),i.latitude_of_false_origin!==void 0&&(i.lat0=i.latitude_of_false_origin),i.longitude_of_false_origin!==void 0&&(i.long0=i.longitude_of_false_origin),i.latitude_of_standard_parallel!==void 0&&(i.lat0=i.latitude_of_standard_parallel,i.lat1=i.latitude_of_standard_parallel),i.latitude_of_1st_standard_parallel!==void 0&&(i.lat1=i.latitude_of_1st_standard_parallel),i.latitude_of_2nd_standard_parallel!==void 0&&(i.lat2=i.latitude_of_2nd_standard_parallel),i.latitude_of_projection_centre!==void 0&&(i.lat0=i.latitude_of_projection_centre),i.longitude_of_projection_centre!==void 0&&(i.longc=i.longitude_of_projection_centre),i.easting_at_false_origin!==void 0&&(i.x0=i.easting_at_false_origin),i.northing_at_false_origin!==void 0&&(i.y0=i.northing_at_false_origin),i.latitude_of_natural_origin!==void 0&&(i.lat0=i.latitude_of_natural_origin),i.longitude_of_natural_origin!==void 0&&(i.long0=i.longitude_of_natural_origin),i.longitude_of_origin!==void 0&&(i.long0=i.longitude_of_origin),i.false_easting!==void 0&&(i.x0=i.false_easting),i.easting_at_projection_centre&&(i.x0=i.easting_at_projection_centre),i.false_northing!==void 0&&(i.y0=i.false_northing),i.northing_at_projection_centre&&(i.y0=i.northing_at_projection_centre),i.standard_parallel_1!==void 0&&(i.lat1=i.standard_parallel_1),i.standard_parallel_2!==void 0&&(i.lat2=i.standard_parallel_2),i.scale_factor_at_natural_origin!==void 0&&(i.k0=i.scale_factor_at_natural_origin),i.scale_factor_at_projection_centre!==void 0&&(i.k0=i.scale_factor_at_projection_centre),i.scale_factor_on_pseudo_standard_parallel!==void 0&&(i.k0=i.scale_factor_on_pseudo_standard_parallel),i.azimuth!==void 0&&(i.alpha=i.azimuth),i.azimuth_at_projection_centre!==void 0&&(i.alpha=i.azimuth_at_projection_centre),i.angle_from_rectified_to_skew_grid&&(i.rectified_grid_angle=i.angle_from_rectified_to_skew_grid),nh(i),i)}var Mu=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function wu(e,i){var s=i[0],o=i[1];!(s in e)&&o in e&&(e[s]=e[o],i.length===3&&(e[s]=i[2](e[s])))}function sh(e){for(var i=Object.keys(e),s=0,o=i.length;s<o;++s){var r=i[s];Mu.indexOf(r)!==-1&&xu(e[r]),typeof e[r]=="object"&&sh(e[r])}}function xu(e){if(e.AUTHORITY){var i=Object.keys(e.AUTHORITY)[0];i&&i in e.AUTHORITY&&(e.title=i+":"+e.AUTHORITY[i])}if(e.type==="GEOGCS"?e.projName="longlat":e.type==="LOCAL_CS"?(e.projName="identity",e.local=!0):typeof e.PROJECTION=="object"?e.projName=Object.keys(e.PROJECTION)[0]:e.projName=e.PROJECTION,e.AXIS){for(var s="",o=0,r=e.AXIS.length;o<r;++o){var h=[e.AXIS[o][0].toLowerCase(),e.AXIS[o][1].toLowerCase()];h[0].indexOf("north")!==-1||(h[0]==="y"||h[0]==="lat")&&h[1]==="north"?s+="n":h[0].indexOf("south")!==-1||(h[0]==="y"||h[0]==="lat")&&h[1]==="south"?s+="s":h[0].indexOf("east")!==-1||(h[0]==="x"||h[0]==="lon")&&h[1]==="east"?s+="e":(h[0].indexOf("west")!==-1||(h[0]==="x"||h[0]==="lon")&&h[1]==="west")&&(s+="w")}s.length===2&&(s+="u"),s.length===3&&(e.axis=s)}e.UNIT&&(e.units=e.UNIT.name.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.UNIT.convert&&(e.type==="GEOGCS"?e.DATUM&&e.DATUM.SPHEROID&&(e.to_meter=e.UNIT.convert*e.DATUM.SPHEROID.a):e.to_meter=e.UNIT.convert));var u=e.GEOGCS;e.type==="GEOGCS"&&(u=e),u&&(u.DATUM?e.datumCode=u.DATUM.name.toLowerCase():e.datumCode=u.name.toLowerCase(),e.datumCode.slice(0,2)==="d_"&&(e.datumCode=e.datumCode.slice(2)),e.datumCode==="new_zealand_1949"&&(e.datumCode="nzgd49"),(e.datumCode==="wgs_1984"||e.datumCode==="world_geodetic_system_1984")&&(e.PROJECTION==="Mercator_Auxiliary_Sphere"&&(e.sphere=!0),e.datumCode="wgs84"),e.datumCode==="belge_1972"&&(e.datumCode="rnb72"),u.DATUM&&u.DATUM.SPHEROID&&(e.ellps=u.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),e.ellps.toLowerCase().slice(0,13)==="international"&&(e.ellps="intl"),e.a=u.DATUM.SPHEROID.a,e.rf=parseFloat(u.DATUM.SPHEROID.rf,10)),u.DATUM&&u.DATUM.TOWGS84&&(e.datum_params=u.DATUM.TOWGS84),~e.datumCode.indexOf("osgb_1936")&&(e.datumCode="osgb36"),~e.datumCode.indexOf("osni_1952")&&(e.datumCode="osni52"),(~e.datumCode.indexOf("tm65")||~e.datumCode.indexOf("geodetic_datum_of_1965"))&&(e.datumCode="ire65"),e.datumCode==="ch1903+"&&(e.datumCode="ch1903"),~e.datumCode.indexOf("israel")&&(e.datumCode="isr93")),e.b&&!isFinite(e.b)&&(e.b=e.a),e.rectified_grid_angle&&(e.rectified_grid_angle=ee(e.rectified_grid_angle));function c(v){var g=e.to_meter||1;return v*g}var d=function(v){return wu(e,v)},_=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",ee],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",ee],["x0","false_easting",c],["y0","false_northing",c],["long0","central_meridian",ee],["lat0","latitude_of_origin",ee],["lat0","standard_parallel_1",ee],["lat1","standard_parallel_1",ee],["lat2","standard_parallel_2",ee],["azimuth","Azimuth"],["alpha","azimuth",ee],["srsCode","name"]];_.forEach(d),nh(e)}function Ea(e){if(typeof e=="object")return gs(e);const i=_u(e);var s=vu(e);if(i==="WKT2"){const h=du(s);return gs(h)}var o=s[0],r={};return mi(s,r),sh(r),r[o]}function Ot(e){var i=this;if(arguments.length===2){var s=arguments[1];typeof s=="string"?s.charAt(0)==="+"?Ot[e]=Sa(arguments[1]):Ot[e]=Ea(arguments[1]):Ot[e]=s}else if(arguments.length===1){if(Array.isArray(e))return e.map(function(o){return Array.isArray(o)?Ot.apply(i,o):Ot(o)});if(typeof e=="string"){if(e in Ot)return Ot[e]}else"EPSG"in e?Ot["EPSG:"+e.EPSG]=e:"ESRI"in e?Ot["ESRI:"+e.ESRI]=e:"IAU2000"in e?Ot["IAU2000:"+e.IAU2000]=e:console.log(e);return}}nu(Ot);function Pu(e){return typeof e=="string"}function bu(e){return e in Ot}function Su(e){return e.indexOf("+")!==0&&e.indexOf("[")!==-1||typeof e=="object"&&!("srsCode"in e)}var Eu=["3857","900913","3785","102113"];function Tu(e){var i=Ie(e,"authority");if(i){var s=Ie(i,"epsg");return s&&Eu.indexOf(s)>-1}}function Lu(e){var i=Ie(e,"extension");if(i)return Ie(i,"proj4")}function Au(e){return e[0]==="+"}function Cu(e){if(Pu(e)){if(bu(e))return Ot[e];if(Su(e)){var i=Ea(e);if(Tu(i))return Ot["EPSG:3857"];var s=Lu(i);return s?Sa(s):i}if(Au(e))return Sa(e)}else return"projName"in e?e:Ea(e)}function uo(e,i){e=e||{};var s,o;if(!i)return e;for(o in i)s=i[o],s!==void 0&&(e[o]=s);return e}function fe(e,i,s){var o=e*i;return s/Math.sqrt(1-o*o)}function Pn(e){return e<0?-1:1}function k(e){return Math.abs(e)<=Mt?e:e-Pn(e)*mn}function ne(e,i,s){var o=e*s,r=.5*e;return o=Math.pow((1-o)/(1+o),r),Math.tan(.5*(G-i))/o}function pn(e,i){for(var s=.5*e,o,r,h=G-2*Math.atan(i),u=0;u<=15;u++)if(o=e*Math.sin(h),r=G-2*Math.atan(i*Math.pow((1-o)/(1+o),s))-h,h+=r,Math.abs(r)<=1e-10)return h;return-9999}function Gu(){var e=this.b/this.a;this.es=1-e*e,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=fe(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function Iu(e){var i=e.x,s=e.y;if(s*ue>90&&s*ue<-90&&i*ue>180&&i*ue<-180)return null;var o,r;if(Math.abs(Math.abs(s)-G)<=R)return null;if(this.sphere)o=this.x0+this.a*this.k0*k(i-this.long0),r=this.y0+this.a*this.k0*Math.log(Math.tan(ht+.5*s));else{var h=Math.sin(s),u=ne(this.e,s,h);o=this.x0+this.a*this.k0*k(i-this.long0),r=this.y0-this.a*this.k0*Math.log(u)}return e.x=o,e.y=r,e}function Nu(e){var i=e.x-this.x0,s=e.y-this.y0,o,r;if(this.sphere)r=G-2*Math.atan(Math.exp(-s/(this.a*this.k0)));else{var h=Math.exp(-s/(this.a*this.k0));if(r=pn(this.e,h),r===-9999)return null}return o=k(this.long0+i/(this.a*this.k0)),e.x=o,e.y=r,e}var Ou=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","Mercator_Variant_A","merc"];const Ru={init:Gu,forward:Iu,inverse:Nu,names:Ou};function ku(){}function fo(e){return e}var Du=["longlat","identity"];const Bu={init:ku,forward:fo,inverse:fo,names:Du};var zu=[Ru,Bu],He={},gi=[];function ah(e,i){var s=gi.length;return e.names?(gi[s]=e,e.names.forEach(function(o){He[o.toLowerCase()]=s}),this):(console.log(i),!0)}function rh(e){return e.replace(/[-\(\)\s]+/g," ").trim().replace(/ /g,"_")}function Fu(e){if(!e)return!1;var i=e.toLowerCase();if(typeof He[i]<"u"&&gi[He[i]]||(i=rh(i),i in He&&gi[He[i]]))return gi[He[i]]}function Zu(){zu.forEach(ah)}const Uu={start:Zu,add:ah,get:Fu};var oh={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"},andrae:{a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"},clrk80:{a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk80ign:{a:63782492e-1,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},clrk58:{a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:63558348467e-4,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"},WGS84:{a:6378137,rf:298.257223563,ellipseName:"WGS 84"},sphere:{a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}};const qu=oh.WGS84;function ju(e,i,s,o){var r=e*e,h=i*i,u=(r-h)/r,c=0;o?(e*=1-u*(ru+u*(ou+u*hu)),r=e*e,u=0):c=Math.sqrt(u);var d=(r-h)/h;return{es:u,e:c,ep2:d}}function $u(e,i,s,o,r){if(!e){var h=Ie(oh,o);h||(h=qu),e=h.a,i=h.b,s=h.rf}return s&&!i&&(i=(1-1/s)*e),(s===0||Math.abs(e-i)<R)&&(r=!0,i=e),{a:e,b:i,rf:s,sphere:r}}var cs={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},mgi:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Ordnance Survey of Great Britain 1936"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"},EPSG_5451:{towgs84:"6.41,-49.05,-11.28,1.5657,0.5242,6.9718,-5.7649"},IGNF_LURESG:{towgs84:"-192.986,13.673,-39.309,-0.4099,-2.9332,2.6881,0.43"},EPSG_4614:{towgs84:"-119.4248,-303.65872,-11.00061,1.164298,0.174458,1.096259,3.657065"},EPSG_4615:{towgs84:"-494.088,-312.129,279.877,-1.423,-1.013,1.59,-0.748"},ESRI_37241:{towgs84:"-76.822,257.457,-12.817,2.136,-0.033,-2.392,-0.031"},ESRI_37249:{towgs84:"-440.296,58.548,296.265,1.128,10.202,4.559,-0.438"},ESRI_37245:{towgs84:"-511.151,-181.269,139.609,1.05,2.703,1.798,3.071"},EPSG_4178:{towgs84:"24.9,-126.4,-93.2,-0.063,-0.247,-0.041,1.01"},EPSG_4622:{towgs84:"-472.29,-5.63,-304.12,0.4362,-0.8374,0.2563,1.8984"},EPSG_4625:{towgs84:"126.93,547.94,130.41,-2.7867,5.1612,-0.8584,13.8227"},EPSG_5252:{towgs84:"0.023,0.036,-0.068,0.00176,0.00912,-0.01136,0.00439"},EPSG_4314:{towgs84:"597.1,71.4,412.1,0.894,0.068,-1.563,7.58"},EPSG_4282:{towgs84:"-178.3,-316.7,-131.5,5.278,6.077,10.979,19.166"},EPSG_4231:{towgs84:"-83.11,-97.38,-117.22,0.0276,-0.2167,0.2147,0.1218"},EPSG_4274:{towgs84:"-230.994,102.591,25.199,0.633,-0.239,0.9,1.95"},EPSG_4134:{towgs84:"-180.624,-225.516,173.919,-0.81,-1.898,8.336,16.71006"},EPSG_4254:{towgs84:"18.38,192.45,96.82,0.056,-0.142,-0.2,-0.0013"},EPSG_4159:{towgs84:"-194.513,-63.978,-25.759,-3.4027,3.756,-3.352,-0.9175"},EPSG_4687:{towgs84:"0.072,-0.507,-0.245,0.0183,-0.0003,0.007,-0.0093"},EPSG_4227:{towgs84:"-83.58,-397.54,458.78,-17.595,-2.847,4.256,3.225"},EPSG_4746:{towgs84:"599.4,72.4,419.2,-0.062,-0.022,-2.723,6.46"},EPSG_4745:{towgs84:"612.4,77,440.2,-0.054,0.057,-2.797,2.55"},EPSG_6311:{towgs84:"8.846,-4.394,-1.122,-0.00237,-0.146528,0.130428,0.783926"},EPSG_4289:{towgs84:"565.7381,50.4018,465.2904,-1.91514,1.60363,-9.09546,4.07244"},EPSG_4230:{towgs84:"-68.863,-134.888,-111.49,-0.53,-0.14,0.57,-3.4"},EPSG_4154:{towgs84:"-123.02,-158.95,-168.47"},EPSG_4156:{towgs84:"570.8,85.7,462.8,4.998,1.587,5.261,3.56"},EPSG_4299:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4179:{towgs84:"33.4,-146.6,-76.3,-0.359,-0.053,0.844,-0.84"},EPSG_4313:{towgs84:"-106.8686,52.2978,-103.7239,0.3366,-0.457,1.8422,-1.2747"},EPSG_4194:{towgs84:"163.511,127.533,-159.789"},EPSG_4195:{towgs84:"105,326,-102.5"},EPSG_4196:{towgs84:"-45,417,-3.5"},EPSG_4611:{towgs84:"-162.619,-276.959,-161.764,0.067753,-2.243649,-1.158827,-1.094246"},EPSG_4633:{towgs84:"137.092,131.66,91.475,-1.9436,-11.5993,-4.3321,-7.4824"},EPSG_4641:{towgs84:"-408.809,366.856,-412.987,1.8842,-0.5308,2.1655,-121.0993"},EPSG_4643:{towgs84:"-480.26,-438.32,-643.429,16.3119,20.1721,-4.0349,-111.7002"},EPSG_4300:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4188:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4660:{towgs84:"982.6087,552.753,-540.873,32.39344,-153.25684,-96.2266,16.805"},EPSG_4662:{towgs84:"97.295,-263.247,310.882,-1.5999,0.8386,3.1409,13.3259"},EPSG_3906:{towgs84:"577.88891,165.22205,391.18289,4.9145,-0.94729,-13.05098,7.78664"},EPSG_4307:{towgs84:"-209.3622,-87.8162,404.6198,0.0046,3.4784,0.5805,-1.4547"},EPSG_6892:{towgs84:"-76.269,-16.683,68.562,-6.275,10.536,-4.286,-13.686"},EPSG_4690:{towgs84:"221.597,152.441,176.523,2.403,1.3893,0.884,11.4648"},EPSG_4691:{towgs84:"218.769,150.75,176.75,3.5231,2.0037,1.288,10.9817"},EPSG_4629:{towgs84:"72.51,345.411,79.241,-1.5862,-0.8826,-0.5495,1.3653"},EPSG_4630:{towgs84:"165.804,216.213,180.26,-0.6251,-0.4515,-0.0721,7.4111"},EPSG_4692:{towgs84:"217.109,86.452,23.711,0.0183,-0.0003,0.007,-0.0093"},EPSG_9333:{towgs84:"0,0,0,-8.393,0.749,-10.276,0"},EPSG_9059:{towgs84:"0,0,0"},EPSG_4312:{towgs84:"601.705,84.263,485.227,4.7354,1.3145,5.393,-2.3887"},EPSG_4123:{towgs84:"-96.062,-82.428,-121.753,4.801,0.345,-1.376,1.496"},EPSG_4309:{towgs84:"-124.45,183.74,44.64,-0.4384,0.5446,-0.9706,-2.1365"},ESRI_104106:{towgs84:"-283.088,-70.693,117.445,-1.157,0.059,-0.652,-4.058"},EPSG_4281:{towgs84:"-219.247,-73.802,269.529"},EPSG_4322:{towgs84:"0,0,4.5"},EPSG_4324:{towgs84:"0,0,1.9"},EPSG_4284:{towgs84:"43.822,-108.842,-119.585,1.455,-0.761,0.737,0.549"},EPSG_4277:{towgs84:"446.448,-125.157,542.06,0.15,0.247,0.842,-20.489"},EPSG_4207:{towgs84:"-282.1,-72.2,120,-1.529,0.145,-0.89,-4.46"},EPSG_4688:{towgs84:"347.175,1077.618,2623.677,33.9058,-70.6776,9.4013,186.0647"},EPSG_4689:{towgs84:"410.793,54.542,80.501,-2.5596,-2.3517,-0.6594,17.3218"},EPSG_4720:{towgs84:"0,0,4.5"},EPSG_4273:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},EPSG_4240:{towgs84:"204.64,834.74,293.8"},EPSG_4817:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},ESRI_104131:{towgs84:"426.62,142.62,460.09,4.98,4.49,-12.42,-17.1"},EPSG_4265:{towgs84:"-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68"},EPSG_4263:{towgs84:"-111.92,-87.85,114.5,1.875,0.202,0.219,0.032"},EPSG_4298:{towgs84:"-689.5937,623.84046,-65.93566,-0.02331,1.17094,-0.80054,5.88536"},EPSG_4270:{towgs84:"-253.4392,-148.452,386.5267,0.15605,0.43,-0.1013,-0.0424"},EPSG_4229:{towgs84:"-121.8,98.1,-10.7"},EPSG_4220:{towgs84:"-55.5,-348,-229.2"},EPSG_4214:{towgs84:"12.646,-155.176,-80.863"},EPSG_4232:{towgs84:"-345,3,223"},EPSG_4238:{towgs84:"-1.977,-13.06,-9.993,0.364,0.254,0.689,-1.037"},EPSG_4168:{towgs84:"-170,33,326"},EPSG_4131:{towgs84:"199,931,318.9"},EPSG_4152:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_5228:{towgs84:"572.213,85.334,461.94,4.9732,1.529,5.2484,3.5378"},EPSG_8351:{towgs84:"485.021,169.465,483.839,7.786342,4.397554,4.102655,0"},EPSG_4683:{towgs84:"-127.62,-67.24,-47.04,-3.068,4.903,1.578,-1.06"},EPSG_4133:{towgs84:"0,0,0"},EPSG_7373:{towgs84:"0.819,-0.5762,-1.6446,-0.00378,-0.03317,0.00318,0.0693"},EPSG_9075:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9072:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9294:{towgs84:"1.16835,-1.42001,-2.24431,-0.00822,-0.05508,0.01818,0.23388"},EPSG_4212:{towgs84:"-267.434,173.496,181.814,-13.4704,8.7154,7.3926,14.7492"},EPSG_4191:{towgs84:"-44.183,-0.58,-38.489,2.3867,2.7072,-3.5196,-8.2703"},EPSG_4237:{towgs84:"52.684,-71.194,-13.975,-0.312,-0.1063,-0.3729,1.0191"},EPSG_4740:{towgs84:"-1.08,-0.27,-0.9"},EPSG_4124:{towgs84:"419.3836,99.3335,591.3451,0.850389,1.817277,-7.862238,-0.99496"},EPSG_5681:{towgs84:"584.9636,107.7175,413.8067,1.1155,0.2824,-3.1384,7.9922"},EPSG_4141:{towgs84:"23.772,17.49,17.859,-0.3132,-1.85274,1.67299,-5.4262"},EPSG_4204:{towgs84:"-85.645,-273.077,-79.708,2.289,-1.421,2.532,3.194"},EPSG_4319:{towgs84:"226.702,-193.337,-35.371,-2.229,-4.391,9.238,0.9798"},EPSG_4200:{towgs84:"24.82,-131.21,-82.66"},EPSG_4130:{towgs84:"0,0,0"},EPSG_4127:{towgs84:"-82.875,-57.097,-156.768,-2.158,1.524,-0.982,-0.359"},EPSG_4149:{towgs84:"674.374,15.056,405.346"},EPSG_4617:{towgs84:"-0.991,1.9072,0.5129,1.25033e-7,4.6785e-8,5.6529e-8,0"},EPSG_4663:{towgs84:"-210.502,-66.902,-48.476,2.094,-15.067,-5.817,0.485"},EPSG_4664:{towgs84:"-211.939,137.626,58.3,-0.089,0.251,0.079,0.384"},EPSG_4665:{towgs84:"-105.854,165.589,-38.312,-0.003,-0.026,0.024,-0.048"},EPSG_4666:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},EPSG_4756:{towgs84:"-192.873,-39.382,-111.202,-0.00205,-0.0005,0.00335,0.0188"},EPSG_4723:{towgs84:"-179.483,-69.379,-27.584,-7.862,8.163,6.042,-13.925"},EPSG_4726:{towgs84:"8.853,-52.644,180.304,-0.393,-2.323,2.96,-24.081"},EPSG_4267:{towgs84:"-8.0,160.0,176.0"},EPSG_5365:{towgs84:"-0.16959,0.35312,0.51846,0.03385,-0.16325,0.03446,0.03693"},EPSG_4218:{towgs84:"304.5,306.5,-318.1"},EPSG_4242:{towgs84:"-33.722,153.789,94.959,-8.581,-4.478,4.54,8.95"},EPSG_4216:{towgs84:"-292.295,248.758,429.447,4.9971,2.99,6.6906,1.0289"},ESRI_104105:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},ESRI_104129:{towgs84:"0,0,0"},EPSG_4673:{towgs84:"174.05,-25.49,112.57"},EPSG_4202:{towgs84:"-124,-60,154"},EPSG_4203:{towgs84:"-117.763,-51.51,139.061,0.292,0.443,0.277,-0.191"},EPSG_3819:{towgs84:"595.48,121.69,515.35,4.115,-2.9383,0.853,-3.408"},EPSG_8694:{towgs84:"-93.799,-132.737,-219.073,-1.844,0.648,-6.37,-0.169"},EPSG_4145:{towgs84:"275.57,676.78,229.6"},EPSG_4283:{towgs84:"61.55,-10.87,-40.19,39.4924,32.7221,32.8979,-9.994"},EPSG_4317:{towgs84:"2.3287,-147.0425,-92.0802,-0.3092483,0.32482185,0.49729934,5.68906266"},EPSG_4272:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993"},EPSG_4248:{towgs84:"-307.7,265.3,-363.5"},EPSG_5561:{towgs84:"24,-121,-76"},EPSG_5233:{towgs84:"-0.293,766.95,87.713,0.195704,1.695068,3.473016,-0.039338"},ESRI_104130:{towgs84:"-86,-98,-119"},ESRI_104102:{towgs84:"682,-203,480"},ESRI_37207:{towgs84:"7,-10,-26"},EPSG_4675:{towgs84:"59.935,118.4,-10.871"},ESRI_104109:{towgs84:"-89.121,-348.182,260.871"},ESRI_104112:{towgs84:"-185.583,-230.096,281.361"},ESRI_104113:{towgs84:"25.1,-275.6,222.6"},IGNF_WGS72G:{towgs84:"0,12,6"},IGNF_NTFG:{towgs84:"-168,-60,320"},IGNF_EFATE57G:{towgs84:"-127,-769,472"},IGNF_PGP50G:{towgs84:"324.8,153.6,172.1"},IGNF_REUN47G:{towgs84:"94,-948,-1262"},IGNF_CSG67G:{towgs84:"-186,230,110"},IGNF_GUAD48G:{towgs84:"-467,-16,-300"},IGNF_TAHI51G:{towgs84:"162,117,154"},IGNF_TAHAAG:{towgs84:"65,342,77"},IGNF_NUKU72G:{towgs84:"84,274,65"},IGNF_PETRELS72G:{towgs84:"365,194,166"},IGNF_WALL78G:{towgs84:"253,-133,-127"},IGNF_MAYO50G:{towgs84:"-382,-59,-262"},IGNF_TANNAG:{towgs84:"-139,-967,436"},IGNF_IGN72G:{towgs84:"-13,-348,292"},IGNF_ATIGG:{towgs84:"1118,23,66"},IGNF_FANGA84G:{towgs84:"150.57,158.33,118.32"},IGNF_RUSAT84G:{towgs84:"202.13,174.6,-15.74"},IGNF_KAUE70G:{towgs84:"126.74,300.1,-75.49"},IGNF_MOP90G:{towgs84:"-10.8,-1.8,12.77"},IGNF_MHPF67G:{towgs84:"338.08,212.58,-296.17"},IGNF_TAHI79G:{towgs84:"160.61,116.05,153.69"},IGNF_ANAA92G:{towgs84:"1.5,3.84,4.81"},IGNF_MARQUI72G:{towgs84:"330.91,-13.92,58.56"},IGNF_APAT86G:{towgs84:"143.6,197.82,74.05"},IGNF_TUBU69G:{towgs84:"237.17,171.61,-77.84"},IGNF_STPM50G:{towgs84:"11.363,424.148,373.13"},EPSG_4150:{towgs84:"674.374,15.056,405.346"},EPSG_4754:{towgs84:"-208.4058,-109.8777,-2.5764"},ESRI_104101:{towgs84:"374,150,588"},EPSG_4693:{towgs84:"0,-0.15,0.68"},EPSG_6207:{towgs84:"293.17,726.18,245.36"},EPSG_4153:{towgs84:"-133.63,-157.5,-158.62"},EPSG_4132:{towgs84:"-241.54,-163.64,396.06"},EPSG_4221:{towgs84:"-154.5,150.7,100.4"},EPSG_4266:{towgs84:"-80.7,-132.5,41.1"},EPSG_4193:{towgs84:"-70.9,-151.8,-41.4"},EPSG_5340:{towgs84:"-0.41,0.46,-0.35"},EPSG_4246:{towgs84:"-294.7,-200.1,525.5"},EPSG_4318:{towgs84:"-3.2,-5.7,2.8"},EPSG_4121:{towgs84:"-199.87,74.79,246.62"},EPSG_4223:{towgs84:"-260.1,5.5,432.2"},EPSG_4158:{towgs84:"-0.465,372.095,171.736"},EPSG_4285:{towgs84:"-128.16,-282.42,21.93"},EPSG_4613:{towgs84:"-404.78,685.68,45.47"},EPSG_4607:{towgs84:"195.671,332.517,274.607"},EPSG_4475:{towgs84:"-381.788,-57.501,-256.673"},EPSG_4208:{towgs84:"-157.84,308.54,-146.6"},EPSG_4743:{towgs84:"70.995,-335.916,262.898"},EPSG_4710:{towgs84:"-323.65,551.39,-491.22"},EPSG_7881:{towgs84:"-0.077,0.079,0.086"},EPSG_4682:{towgs84:"283.729,735.942,261.143"},EPSG_4739:{towgs84:"-156,-271,-189"},EPSG_4679:{towgs84:"-80.01,253.26,291.19"},EPSG_4750:{towgs84:"-56.263,16.136,-22.856"},EPSG_4644:{towgs84:"-10.18,-350.43,291.37"},EPSG_4695:{towgs84:"-103.746,-9.614,-255.95"},EPSG_4292:{towgs84:"-355,21,72"},EPSG_4302:{towgs84:"-61.702,284.488,472.052"},EPSG_4143:{towgs84:"-124.76,53,466.79"},EPSG_4606:{towgs84:"-153,153,307"},EPSG_4699:{towgs84:"-770.1,158.4,-498.2"},EPSG_4247:{towgs84:"-273.5,110.6,-357.9"},EPSG_4160:{towgs84:"8.88,184.86,106.69"},EPSG_4161:{towgs84:"-233.43,6.65,173.64"},EPSG_9251:{towgs84:"-9.5,122.9,138.2"},EPSG_9253:{towgs84:"-78.1,101.6,133.3"},EPSG_4297:{towgs84:"-198.383,-240.517,-107.909"},EPSG_4269:{towgs84:"0,0,0"},EPSG_4301:{towgs84:"-147,506,687"},EPSG_4618:{towgs84:"-59,-11,-52"},EPSG_4612:{towgs84:"0,0,0"},EPSG_4678:{towgs84:"44.585,-131.212,-39.544"},EPSG_4250:{towgs84:"-130,29,364"},EPSG_4144:{towgs84:"214,804,268"},EPSG_4147:{towgs84:"-17.51,-108.32,-62.39"},EPSG_4259:{towgs84:"-254.1,-5.36,-100.29"},EPSG_4164:{towgs84:"-76,-138,67"},EPSG_4211:{towgs84:"-378.873,676.002,-46.255"},EPSG_4182:{towgs84:"-422.651,-172.995,84.02"},EPSG_4224:{towgs84:"-143.87,243.37,-33.52"},EPSG_4225:{towgs84:"-205.57,168.77,-4.12"},EPSG_5527:{towgs84:"-67.35,3.88,-38.22"},EPSG_4752:{towgs84:"98,390,-22"},EPSG_4310:{towgs84:"-30,190,89"},EPSG_9248:{towgs84:"-192.26,65.72,132.08"},EPSG_4680:{towgs84:"124.5,-63.5,-281"},EPSG_4701:{towgs84:"-79.9,-158,-168.9"},EPSG_4706:{towgs84:"-146.21,112.63,4.05"},EPSG_4805:{towgs84:"682,-203,480"},EPSG_4201:{towgs84:"-165,-11,206"},EPSG_4210:{towgs84:"-157,-2,-299"},EPSG_4183:{towgs84:"-104,167,-38"},EPSG_4139:{towgs84:"11,72,-101"},EPSG_4668:{towgs84:"-86,-98,-119"},EPSG_4717:{towgs84:"-2,151,181"},EPSG_4732:{towgs84:"102,52,-38"},EPSG_4280:{towgs84:"-377,681,-50"},EPSG_4209:{towgs84:"-138,-105,-289"},EPSG_4261:{towgs84:"31,146,47"},EPSG_4658:{towgs84:"-73,46,-86"},EPSG_4721:{towgs84:"265.025,384.929,-194.046"},EPSG_4222:{towgs84:"-136,-108,-292"},EPSG_4601:{towgs84:"-255,-15,71"},EPSG_4602:{towgs84:"725,685,536"},EPSG_4603:{towgs84:"72,213.7,93"},EPSG_4605:{towgs84:"9,183,236"},EPSG_4621:{towgs84:"137,248,-430"},EPSG_4657:{towgs84:"-28,199,5"},EPSG_4316:{towgs84:"103.25,-100.4,-307.19"},EPSG_4642:{towgs84:"-13,-348,292"},EPSG_4698:{towgs84:"145,-187,103"},EPSG_4192:{towgs84:"-206.1,-174.7,-87.7"},EPSG_4311:{towgs84:"-265,120,-358"},EPSG_4135:{towgs84:"58,-283,-182"},ESRI_104138:{towgs84:"198,-226,-347"},EPSG_4245:{towgs84:"-11,851,5"},EPSG_4142:{towgs84:"-125,53,467"},EPSG_4213:{towgs84:"-106,-87,188"},EPSG_4253:{towgs84:"-133,-77,-51"},EPSG_4129:{towgs84:"-132,-110,-335"},EPSG_4713:{towgs84:"-77,-128,142"},EPSG_4239:{towgs84:"217,823,299"},EPSG_4146:{towgs84:"295,736,257"},EPSG_4155:{towgs84:"-83,37,124"},EPSG_4165:{towgs84:"-173,253,27"},EPSG_4672:{towgs84:"175,-38,113"},EPSG_4236:{towgs84:"-637,-549,-203"},EPSG_4251:{towgs84:"-90,40,88"},EPSG_4271:{towgs84:"-2,374,172"},EPSG_4175:{towgs84:"-88,4,101"},EPSG_4716:{towgs84:"298,-304,-375"},EPSG_4315:{towgs84:"-23,259,-9"},EPSG_4744:{towgs84:"-242.2,-144.9,370.3"},EPSG_4244:{towgs84:"-97,787,86"},EPSG_4293:{towgs84:"616,97,-251"},EPSG_4714:{towgs84:"-127,-769,472"},EPSG_4736:{towgs84:"260,12,-147"},EPSG_6883:{towgs84:"-235,-110,393"},EPSG_6894:{towgs84:"-63,176,185"},EPSG_4205:{towgs84:"-43,-163,45"},EPSG_4256:{towgs84:"41,-220,-134"},EPSG_4262:{towgs84:"639,405,60"},EPSG_4604:{towgs84:"174,359,365"},EPSG_4169:{towgs84:"-115,118,426"},EPSG_4620:{towgs84:"-106,-129,165"},EPSG_4184:{towgs84:"-203,141,53"},EPSG_4616:{towgs84:"-289,-124,60"},EPSG_9403:{towgs84:"-307,-92,127"},EPSG_4684:{towgs84:"-133,-321,50"},EPSG_4708:{towgs84:"-491,-22,435"},EPSG_4707:{towgs84:"114,-116,-333"},EPSG_4709:{towgs84:"145,75,-272"},EPSG_4712:{towgs84:"-205,107,53"},EPSG_4711:{towgs84:"124,-234,-25"},EPSG_4718:{towgs84:"230,-199,-752"},EPSG_4719:{towgs84:"211,147,111"},EPSG_4724:{towgs84:"208,-435,-229"},EPSG_4725:{towgs84:"189,-79,-202"},EPSG_4735:{towgs84:"647,1777,-1124"},EPSG_4722:{towgs84:"-794,119,-298"},EPSG_4728:{towgs84:"-307,-92,127"},EPSG_4734:{towgs84:"-632,438,-609"},EPSG_4727:{towgs84:"912,-58,1227"},EPSG_4729:{towgs84:"185,165,42"},EPSG_4730:{towgs84:"170,42,84"},EPSG_4733:{towgs84:"276,-57,149"},ESRI_37218:{towgs84:"230,-199,-752"},ESRI_37240:{towgs84:"-7,215,225"},ESRI_37221:{towgs84:"252,-209,-751"},ESRI_4305:{towgs84:"-123,-206,219"},ESRI_104139:{towgs84:"-73,-247,227"},EPSG_4748:{towgs84:"51,391,-36"},EPSG_4219:{towgs84:"-384,664,-48"},EPSG_4255:{towgs84:"-333,-222,114"},EPSG_4257:{towgs84:"-587.8,519.75,145.76"},EPSG_4646:{towgs84:"-963,510,-359"},EPSG_6881:{towgs84:"-24,-203,268"},EPSG_6882:{towgs84:"-183,-15,273"},EPSG_4715:{towgs84:"-104,-129,239"},IGNF_RGF93GDD:{towgs84:"0,0,0"},IGNF_RGM04GDD:{towgs84:"0,0,0"},IGNF_RGSPM06GDD:{towgs84:"0,0,0"},IGNF_RGTAAF07GDD:{towgs84:"0,0,0"},IGNF_RGFG95GDD:{towgs84:"0,0,0"},IGNF_RGNCG:{towgs84:"0,0,0"},IGNF_RGPFGDD:{towgs84:"0,0,0"},IGNF_ETRS89G:{towgs84:"0,0,0"},IGNF_RGR92GDD:{towgs84:"0,0,0"},EPSG_4173:{towgs84:"0,0,0"},EPSG_4180:{towgs84:"0,0,0"},EPSG_4619:{towgs84:"0,0,0"},EPSG_4667:{towgs84:"0,0,0"},EPSG_4075:{towgs84:"0,0,0"},EPSG_6706:{towgs84:"0,0,0"},EPSG_7798:{towgs84:"0,0,0"},EPSG_4661:{towgs84:"0,0,0"},EPSG_4669:{towgs84:"0,0,0"},EPSG_8685:{towgs84:"0,0,0"},EPSG_4151:{towgs84:"0,0,0"},EPSG_9702:{towgs84:"0,0,0"},EPSG_4758:{towgs84:"0,0,0"},EPSG_4761:{towgs84:"0,0,0"},EPSG_4765:{towgs84:"0,0,0"},EPSG_8997:{towgs84:"0,0,0"},EPSG_4023:{towgs84:"0,0,0"},EPSG_4670:{towgs84:"0,0,0"},EPSG_4694:{towgs84:"0,0,0"},EPSG_4148:{towgs84:"0,0,0"},EPSG_4163:{towgs84:"0,0,0"},EPSG_4167:{towgs84:"0,0,0"},EPSG_4189:{towgs84:"0,0,0"},EPSG_4190:{towgs84:"0,0,0"},EPSG_4176:{towgs84:"0,0,0"},EPSG_4659:{towgs84:"0,0,0"},EPSG_3824:{towgs84:"0,0,0"},EPSG_3889:{towgs84:"0,0,0"},EPSG_4046:{towgs84:"0,0,0"},EPSG_4081:{towgs84:"0,0,0"},EPSG_4558:{towgs84:"0,0,0"},EPSG_4483:{towgs84:"0,0,0"},EPSG_5013:{towgs84:"0,0,0"},EPSG_5264:{towgs84:"0,0,0"},EPSG_5324:{towgs84:"0,0,0"},EPSG_5354:{towgs84:"0,0,0"},EPSG_5371:{towgs84:"0,0,0"},EPSG_5373:{towgs84:"0,0,0"},EPSG_5381:{towgs84:"0,0,0"},EPSG_5393:{towgs84:"0,0,0"},EPSG_5489:{towgs84:"0,0,0"},EPSG_5593:{towgs84:"0,0,0"},EPSG_6135:{towgs84:"0,0,0"},EPSG_6365:{towgs84:"0,0,0"},EPSG_5246:{towgs84:"0,0,0"},EPSG_7886:{towgs84:"0,0,0"},EPSG_8431:{towgs84:"0,0,0"},EPSG_8427:{towgs84:"0,0,0"},EPSG_8699:{towgs84:"0,0,0"},EPSG_8818:{towgs84:"0,0,0"},EPSG_4757:{towgs84:"0,0,0"},EPSG_9140:{towgs84:"0,0,0"},EPSG_8086:{towgs84:"0,0,0"},EPSG_4686:{towgs84:"0,0,0"},EPSG_4737:{towgs84:"0,0,0"},EPSG_4702:{towgs84:"0,0,0"},EPSG_4747:{towgs84:"0,0,0"},EPSG_4749:{towgs84:"0,0,0"},EPSG_4674:{towgs84:"0,0,0"},EPSG_4755:{towgs84:"0,0,0"},EPSG_4759:{towgs84:"0,0,0"},EPSG_4762:{towgs84:"0,0,0"},EPSG_4763:{towgs84:"0,0,0"},EPSG_4764:{towgs84:"0,0,0"},EPSG_4166:{towgs84:"0,0,0"},EPSG_4170:{towgs84:"0,0,0"},EPSG_5546:{towgs84:"0,0,0"},EPSG_7844:{towgs84:"0,0,0"},EPSG_4818:{towgs84:"589,76,480"}};for(var Hu in cs){var pa=cs[Hu];pa.datumName&&(cs[pa.datumName]=pa)}function Vu(e,i,s,o,r,h,u){var c={};return e===void 0||e==="none"?c.datum_type=ba:c.datum_type=su,i&&(c.datum_params=i.map(parseFloat),(c.datum_params[0]!==0||c.datum_params[1]!==0||c.datum_params[2]!==0)&&(c.datum_type=Ke),c.datum_params.length>3&&(c.datum_params[3]!==0||c.datum_params[4]!==0||c.datum_params[5]!==0||c.datum_params[6]!==0)&&(c.datum_type=Xe,c.datum_params[3]*=on,c.datum_params[4]*=on,c.datum_params[5]*=on,c.datum_params[6]=c.datum_params[6]/1e6+1)),u&&(c.datum_type=wi,c.grids=u),c.a=s,c.b=o,c.es=r,c.ep2=h,c}var Qa={};function Wu(e,i,s){return i instanceof ArrayBuffer?Ku(e,i,s):{ready:Xu(e,i)}}function Ku(e,i,s){var o=!0;s!==void 0&&s.includeErrorFields===!1&&(o=!1);var r=new DataView(i),h=Qu(r),u=tf(r,h),c=ef(r,u,h,o),d={header:u,subgrids:c};return Qa[e]=d,d}async function Xu(e,i){for(var s=[],o=await i.getImageCount(),r=o-1;r>=0;r--){var h=await i.getImage(r),u=await h.readRasters(),c=u,d=[h.getWidth(),h.getHeight()],_=h.getBoundingBox().map(_o),v=[h.fileDirectory.ModelPixelScale[0],h.fileDirectory.ModelPixelScale[1]].map(_o),g=_[0]+(d[0]-1)*v[0],p=_[3]-(d[1]-1)*v[1],M=c[0],w=c[1],P=[];for(let T=d[1]-1;T>=0;T--)for(let S=d[0]-1;S>=0;S--){var x=T*d[0]+S;P.push([-Ae(w[x]),Ae(M[x])])}s.push({del:v,lim:d,ll:[-g,p],cvs:P})}var A={header:{nSubgrids:o},subgrids:s};return Qa[e]=A,A}function Yu(e){if(e===void 0)return null;var i=e.split(",");return i.map(Ju)}function Ju(e){if(e.length===0)return null;var i=e[0]==="@";return i&&(e=e.slice(1)),e==="null"?{name:"null",mandatory:!i,grid:null,isNull:!0}:{name:e,mandatory:!i,grid:Qa[e]||null,isNull:!1}}function _o(e){return e*Math.PI/180}function Ae(e){return e/3600*Math.PI/180}function Qu(e){var i=e.getInt32(8,!1);return i===11?!1:(i=e.getInt32(8,!0),i!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function tf(e,i){return{nFields:e.getInt32(8,i),nSubgridFields:e.getInt32(24,i),nSubgrids:e.getInt32(40,i),shiftType:Ta(e,56,64).trim(),fromSemiMajorAxis:e.getFloat64(120,i),fromSemiMinorAxis:e.getFloat64(136,i),toSemiMajorAxis:e.getFloat64(152,i),toSemiMinorAxis:e.getFloat64(168,i)}}function Ta(e,i,s){return String.fromCharCode.apply(null,new Uint8Array(e.buffer.slice(i,s)))}function ef(e,i,s,o){for(var r=176,h=[],u=0;u<i.nSubgrids;u++){var c=sf(e,r,s),d=af(e,r,c,s,o),_=Math.round(1+(c.upperLongitude-c.lowerLongitude)/c.longitudeInterval),v=Math.round(1+(c.upperLatitude-c.lowerLatitude)/c.latitudeInterval);h.push({ll:[Ae(c.lowerLongitude),Ae(c.lowerLatitude)],del:[Ae(c.longitudeInterval),Ae(c.latitudeInterval)],lim:[_,v],count:c.gridNodeCount,cvs:nf(d)});var g=16;o===!1&&(g=8),r+=176+c.gridNodeCount*g}return h}function nf(e){return e.map(function(i){return[Ae(i.longitudeShift),Ae(i.latitudeShift)]})}function sf(e,i,s){return{name:Ta(e,i+8,i+16).trim(),parent:Ta(e,i+24,i+24+8).trim(),lowerLatitude:e.getFloat64(i+72,s),upperLatitude:e.getFloat64(i+88,s),lowerLongitude:e.getFloat64(i+104,s),upperLongitude:e.getFloat64(i+120,s),latitudeInterval:e.getFloat64(i+136,s),longitudeInterval:e.getFloat64(i+152,s),gridNodeCount:e.getInt32(i+168,s)}}function af(e,i,s,o,r){var h=i+176,u=16;r===!1&&(u=8);for(var c=[],d=0;d<s.gridNodeCount;d++){var _={latitudeShift:e.getFloat32(h+d*u,o),longitudeShift:e.getFloat32(h+d*u+4,o)};r!==!1&&(_.latitudeAccuracy=e.getFloat32(h+d*u+8,o),_.longitudeAccuracy=e.getFloat32(h+d*u+12,o)),c.push(_)}return c}function se(e,i){if(!(this instanceof se))return new se(e);this.forward=null,this.inverse=null,this.init=null,this.name,this.names=null,this.title,i=i||function(_){if(_)throw _};var s=Cu(e);if(typeof s!="object"){i("Could not parse to valid json: "+e);return}var o=se.projections.get(s.projName);if(!o){i("Could not get projection name from: "+e);return}if(s.datumCode&&s.datumCode!=="none"){var r=Ie(cs,s.datumCode);r&&(s.datum_params=s.datum_params||(r.towgs84?r.towgs84.split(","):null),s.ellps=r.ellipse,s.datumName=r.datumName?r.datumName:s.datumCode)}s.k0=s.k0||1,s.axis=s.axis||"enu",s.ellps=s.ellps||"wgs84",s.lat1=s.lat1||s.lat0;var h=$u(s.a,s.b,s.rf,s.ellps,s.sphere),u=ju(h.a,h.b,h.rf,s.R_A),c=Yu(s.nadgrids),d=s.datum||Vu(s.datumCode,s.datum_params,h.a,h.b,u.es,u.ep2,c);uo(this,s),uo(this,o),this.a=h.a,this.b=h.b,this.rf=h.rf,this.sphere=h.sphere,this.es=u.es,this.e=u.e,this.ep2=u.ep2,this.datum=d,"init"in this&&typeof this.init=="function"&&this.init(),i(null,this)}se.projections=Uu;se.projections.start();function rf(e,i){return e.datum_type!==i.datum_type||e.a!==i.a||Math.abs(e.es-i.es)>5e-11?!1:e.datum_type===Ke?e.datum_params[0]===i.datum_params[0]&&e.datum_params[1]===i.datum_params[1]&&e.datum_params[2]===i.datum_params[2]:e.datum_type===Xe?e.datum_params[0]===i.datum_params[0]&&e.datum_params[1]===i.datum_params[1]&&e.datum_params[2]===i.datum_params[2]&&e.datum_params[3]===i.datum_params[3]&&e.datum_params[4]===i.datum_params[4]&&e.datum_params[5]===i.datum_params[5]&&e.datum_params[6]===i.datum_params[6]:!0}function hh(e,i,s){var o=e.x,r=e.y,h=e.z?e.z:0,u,c,d,_;if(r<-G&&r>-1.001*G)r=-G;else if(r>G&&r<1.001*G)r=G;else{if(r<-G)return{x:-1/0,y:-1/0,z:e.z};if(r>G)return{x:1/0,y:1/0,z:e.z}}return o>Math.PI&&(o-=2*Math.PI),c=Math.sin(r),_=Math.cos(r),d=c*c,u=s/Math.sqrt(1-i*d),{x:(u+h)*_*Math.cos(o),y:(u+h)*_*Math.sin(o),z:(u*(1-i)+h)*c}}function lh(e,i,s,o){var r=1e-12,h=r*r,u=30,c,d,_,v,g,p,M,w,P,x,A,T,S,I=e.x,O=e.y,N=e.z?e.z:0,B,q,j;if(c=Math.sqrt(I*I+O*O),d=Math.sqrt(I*I+O*O+N*N),c/s<r){if(B=0,d/s<r)return q=G,j=-o,{x:e.x,y:e.y,z:e.z}}else B=Math.atan2(O,I);_=N/d,v=c/d,g=1/Math.sqrt(1-i*(2-i)*v*v),w=v*(1-i)*g,P=_*g,S=0;do S++,M=s/Math.sqrt(1-i*P*P),j=c*w+N*P-M*(1-i*P*P),p=i*M/(M+j),g=1/Math.sqrt(1-p*(2-p)*v*v),x=v*(1-p)*g,A=_*g,T=A*w-x*P,w=x,P=A;while(T*T>h&&S<u);return q=Math.atan(A/Math.abs(x)),{x:B,y:q,z:j}}function of(e,i,s){if(i===Ke)return{x:e.x+s[0],y:e.y+s[1],z:e.z+s[2]};if(i===Xe){var o=s[0],r=s[1],h=s[2],u=s[3],c=s[4],d=s[5],_=s[6];return{x:_*(e.x-d*e.y+c*e.z)+o,y:_*(d*e.x+e.y-u*e.z)+r,z:_*(-c*e.x+u*e.y+e.z)+h}}}function hf(e,i,s){if(i===Ke)return{x:e.x-s[0],y:e.y-s[1],z:e.z-s[2]};if(i===Xe){var o=s[0],r=s[1],h=s[2],u=s[3],c=s[4],d=s[5],_=s[6],v=(e.x-o)/_,g=(e.y-r)/_,p=(e.z-h)/_;return{x:v+d*g-c*p,y:-d*v+g+u*p,z:c*v-u*g+p}}}function rs(e){return e===Ke||e===Xe}function lf(e,i,s){if(rf(e,i)||e.datum_type===ba||i.datum_type===ba)return s;var o=e.a,r=e.es;if(e.datum_type===wi){var h=mo(e,!1,s);if(h!==0)return;o=ao,r=ro}var u=i.a,c=i.b,d=i.es;if(i.datum_type===wi&&(u=ao,c=au,d=ro),r===d&&o===u&&!rs(e.datum_type)&&!rs(i.datum_type))return s;if(s=hh(s,r,o),rs(e.datum_type)&&(s=of(s,e.datum_type,e.datum_params)),rs(i.datum_type)&&(s=hf(s,i.datum_type,i.datum_params)),s=lh(s,d,u,c),i.datum_type===wi){var _=mo(i,!0,s);if(_!==0)return}return s}function mo(e,i,s){if(e.grids===null||e.grids.length===0)return console.log("Grid shift grids not found"),-1;var o={x:-s.x,y:s.y},r={x:Number.NaN,y:Number.NaN},h=[];t:for(var u=0;u<e.grids.length;u++){var c=e.grids[u];if(h.push(c.name),c.isNull){r=o;break}if(c.grid===null){if(c.mandatory)return console.log("Unable to find mandatory grid '"+c.name+"'"),-1;continue}for(var d=c.grid.subgrids,_=0,v=d.length;_<v;_++){var g=d[_],p=(Math.abs(g.del[1])+Math.abs(g.del[0]))/1e4,M=g.ll[0]-p,w=g.ll[1]-p,P=g.ll[0]+(g.lim[0]-1)*g.del[0]+p,x=g.ll[1]+(g.lim[1]-1)*g.del[1]+p;if(!(w>o.y||M>o.x||x<o.y||P<o.x)&&(r=cf(o,i,g),!isNaN(r.x)))break t}}return isNaN(r.x)?(console.log("Failed to find a grid shift table for location '"+-o.x*ue+" "+o.y*ue+" tried: '"+h+"'"),-1):(s.x=-r.x,s.y=r.y,0)}function cf(e,i,s){var o={x:Number.NaN,y:Number.NaN};if(isNaN(e.x))return o;var r={x:e.x,y:e.y};r.x-=s.ll[0],r.y-=s.ll[1],r.x=k(r.x-Math.PI)+Math.PI;var h=go(r,s);if(i){if(isNaN(h.x))return o;h.x=r.x-h.x,h.y=r.y-h.y;var u=9,c=1e-12,d,_;do{if(_=go(h,s),isNaN(_.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}d={x:r.x-(_.x+h.x),y:r.y-(_.y+h.y)},h.x+=d.x,h.y+=d.y}while(u--&&Math.abs(d.x)>c&&Math.abs(d.y)>c);if(u<0)return console.log("Inverse grid shift iterator failed to converge."),o;o.x=k(h.x+s.ll[0]),o.y=h.y+s.ll[1]}else isNaN(h.x)||(o.x=e.x+h.x,o.y=e.y+h.y);return o}function go(e,i){var s={x:e.x/i.del[0],y:e.y/i.del[1]},o={x:Math.floor(s.x),y:Math.floor(s.y)},r={x:s.x-1*o.x,y:s.y-1*o.y},h={x:Number.NaN,y:Number.NaN},u;if(o.x<0||o.x>=i.lim[0]||o.y<0||o.y>=i.lim[1])return h;u=o.y*i.lim[0]+o.x;var c={x:i.cvs[u][0],y:i.cvs[u][1]};u++;var d={x:i.cvs[u][0],y:i.cvs[u][1]};u+=i.lim[0];var _={x:i.cvs[u][0],y:i.cvs[u][1]};u--;var v={x:i.cvs[u][0],y:i.cvs[u][1]},g=r.x*r.y,p=r.x*(1-r.y),M=(1-r.x)*(1-r.y),w=(1-r.x)*r.y;return h.x=M*c.x+p*d.x+w*v.x+g*_.x,h.y=M*c.y+p*d.y+w*v.y+g*_.y,h}function po(e,i,s){var o=s.x,r=s.y,h=s.z||0,u,c,d,_={};for(d=0;d<3;d++)if(!(i&&d===2&&s.z===void 0))switch(d===0?(u=o,"ew".indexOf(e.axis[d])!==-1?c="x":c="y"):d===1?(u=r,"ns".indexOf(e.axis[d])!==-1?c="y":c="x"):(u=h,c="z"),e.axis[d]){case"e":_[c]=u;break;case"w":_[c]=-u;break;case"n":_[c]=u;break;case"s":_[c]=-u;break;case"u":s[c]!==void 0&&(_.z=u);break;case"d":s[c]!==void 0&&(_.z=-u);break;default:return null}return _}function ch(e){var i={x:e[0],y:e[1]};return e.length>2&&(i.z=e[2]),e.length>3&&(i.m=e[3]),i}function uf(e){vo(e.x),vo(e.y)}function vo(e){if(typeof Number.isFinite=="function"){if(Number.isFinite(e))return;throw new TypeError("coordinates must be finite numbers")}if(typeof e!="number"||e!==e||!isFinite(e))throw new TypeError("coordinates must be finite numbers")}function ff(e,i){return(e.datum.datum_type===Ke||e.datum.datum_type===Xe||e.datum.datum_type===wi)&&i.datumCode!=="WGS84"||(i.datum.datum_type===Ke||i.datum.datum_type===Xe||i.datum.datum_type===wi)&&e.datumCode!=="WGS84"}function ps(e,i,s,o){var r;Array.isArray(s)?s=ch(s):s={x:s.x,y:s.y,z:s.z,m:s.m};var h=s.z!==void 0;if(uf(s),e.datum&&i.datum&&ff(e,i)&&(r=new se("WGS84"),s=ps(e,r,s,o),e=r),o&&e.axis!=="enu"&&(s=po(e,!1,s)),e.projName==="longlat")s={x:s.x*Lt,y:s.y*Lt,z:s.z||0};else if(e.to_meter&&(s={x:s.x*e.to_meter,y:s.y*e.to_meter,z:s.z||0}),s=e.inverse(s),!s)return;if(e.from_greenwich&&(s.x+=e.from_greenwich),s=lf(e.datum,i.datum,s),!!s)return s=s,i.from_greenwich&&(s={x:s.x-i.from_greenwich,y:s.y,z:s.z||0}),i.projName==="longlat"?s={x:s.x*ue,y:s.y*ue,z:s.z||0}:(s=i.forward(s),i.to_meter&&(s={x:s.x/i.to_meter,y:s.y/i.to_meter,z:s.z||0})),o&&i.axis!=="enu"?po(i,!0,s):(s&&!h&&delete s.z,s)}var yo=se("WGS84");function va(e,i,s,o){var r,h,u;return Array.isArray(s)?(r=ps(e,i,s,o)||{x:NaN,y:NaN},s.length>2?typeof e.name<"u"&&e.name==="geocent"||typeof i.name<"u"&&i.name==="geocent"?typeof r.z=="number"?[r.x,r.y,r.z].concat(s.slice(3)):[r.x,r.y,s[2]].concat(s.slice(3)):[r.x,r.y].concat(s.slice(2)):[r.x,r.y]):(h=ps(e,i,s,o),u=Object.keys(s),u.length===2||u.forEach(function(c){if(typeof e.name<"u"&&e.name==="geocent"||typeof i.name<"u"&&i.name==="geocent"){if(c==="x"||c==="y"||c==="z")return}else if(c==="x"||c==="y")return;h[c]=s[c]}),h)}function os(e){return e instanceof se?e:typeof e=="object"&&"oProj"in e?e.oProj:se(e)}function df(e,i,s){var o,r,h=!1,u;return typeof i>"u"?(r=os(e),o=yo,h=!0):(typeof i.x<"u"||Array.isArray(i))&&(s=i,r=os(e),o=yo,h=!0),o||(o=os(e)),r||(r=os(i)),s?va(o,r,s):(u={forward:function(c,d){return va(o,r,c,d)},inverse:function(c,d){return va(r,o,c,d)}},h&&(u.oProj=r),u)}var Mo=6,uh="AJSAJS",fh="AFAFAF",pi=65,Bt=73,Vt=79,en=86,nn=90;const _f={forward:dh,inverse:mf,toPoint:_h};function dh(e,i){return i=i||5,vf(gf({lat:e[1],lon:e[0]}),i)}function mf(e){var i=tr(gh(e.toUpperCase()));return i.lat&&i.lon?[i.lon,i.lat,i.lon,i.lat]:[i.left,i.bottom,i.right,i.top]}function _h(e){var i=tr(gh(e.toUpperCase()));return i.lat&&i.lon?[i.lon,i.lat]:[(i.left+i.right)/2,(i.top+i.bottom)/2]}function ya(e){return e*(Math.PI/180)}function wo(e){return 180*(e/Math.PI)}function gf(e){var i=e.lat,s=e.lon,o=6378137,r=.00669438,h=.9996,u,c,d,_,v,g,p,M=ya(i),w=ya(s),P,x;x=Math.floor((s+180)/6)+1,s===180&&(x=60),i>=56&&i<64&&s>=3&&s<12&&(x=32),i>=72&&i<84&&(s>=0&&s<9?x=31:s>=9&&s<21?x=33:s>=21&&s<33?x=35:s>=33&&s<42&&(x=37)),u=(x-1)*6-180+3,P=ya(u),c=r/(1-r),d=o/Math.sqrt(1-r*Math.sin(M)*Math.sin(M)),_=Math.tan(M)*Math.tan(M),v=c*Math.cos(M)*Math.cos(M),g=Math.cos(M)*(w-P),p=o*((1-r/4-3*r*r/64-5*r*r*r/256)*M-(3*r/8+3*r*r/32+45*r*r*r/1024)*Math.sin(2*M)+(15*r*r/256+45*r*r*r/1024)*Math.sin(4*M)-35*r*r*r/3072*Math.sin(6*M));var A=h*d*(g+(1-_+v)*g*g*g/6+(5-18*_+_*_+72*v-58*c)*g*g*g*g*g/120)+5e5,T=h*(p+d*Math.tan(M)*(g*g/2+(5-_+9*v+4*v*v)*g*g*g*g/24+(61-58*_+_*_+600*v-330*c)*g*g*g*g*g*g/720));return i<0&&(T+=1e7),{northing:Math.round(T),easting:Math.round(A),zoneNumber:x,zoneLetter:pf(i)}}function tr(e){var i=e.northing,s=e.easting,o=e.zoneLetter,r=e.zoneNumber;if(r<0||r>60)return null;var h=.9996,u=6378137,c=.00669438,d,_=(1-Math.sqrt(1-c))/(1+Math.sqrt(1-c)),v,g,p,M,w,P,x,A,T,S=s-5e5,I=i;o<"N"&&(I-=1e7),x=(r-1)*6-180+3,d=c/(1-c),P=I/h,A=P/(u*(1-c/4-3*c*c/64-5*c*c*c/256)),T=A+(3*_/2-27*_*_*_/32)*Math.sin(2*A)+(21*_*_/16-55*_*_*_*_/32)*Math.sin(4*A)+151*_*_*_/96*Math.sin(6*A),v=u/Math.sqrt(1-c*Math.sin(T)*Math.sin(T)),g=Math.tan(T)*Math.tan(T),p=d*Math.cos(T)*Math.cos(T),M=u*(1-c)/Math.pow(1-c*Math.sin(T)*Math.sin(T),1.5),w=S/(v*h);var O=T-v*Math.tan(T)/M*(w*w/2-(5+3*g+10*p-4*p*p-9*d)*w*w*w*w/24+(61+90*g+298*p+45*g*g-252*d-3*p*p)*w*w*w*w*w*w/720);O=wo(O);var N=(w-(1+2*g+p)*w*w*w/6+(5-2*p+28*g-3*p*p+8*d+24*g*g)*w*w*w*w*w/120)/Math.cos(T);N=x+wo(N);var B;if(e.accuracy){var q=tr({northing:e.northing+e.accuracy,easting:e.easting+e.accuracy,zoneLetter:e.zoneLetter,zoneNumber:e.zoneNumber});B={top:q.lat,right:q.lon,bottom:O,left:N}}else B={lat:O,lon:N};return B}function pf(e){var i="Z";return 84>=e&&e>=72?i="X":72>e&&e>=64?i="W":64>e&&e>=56?i="V":56>e&&e>=48?i="U":48>e&&e>=40?i="T":40>e&&e>=32?i="S":32>e&&e>=24?i="R":24>e&&e>=16?i="Q":16>e&&e>=8?i="P":8>e&&e>=0?i="N":0>e&&e>=-8?i="M":-8>e&&e>=-16?i="L":-16>e&&e>=-24?i="K":-24>e&&e>=-32?i="J":-32>e&&e>=-40?i="H":-40>e&&e>=-48?i="G":-48>e&&e>=-56?i="F":-56>e&&e>=-64?i="E":-64>e&&e>=-72?i="D":-72>e&&e>=-80&&(i="C"),i}function vf(e,i){var s="00000"+e.easting,o="00000"+e.northing;return e.zoneNumber+e.zoneLetter+yf(e.easting,e.northing,e.zoneNumber)+s.substr(s.length-5,i)+o.substr(o.length-5,i)}function yf(e,i,s){var o=mh(s),r=Math.floor(e/1e5),h=Math.floor(i/1e5)%20;return Mf(r,h,o)}function mh(e){var i=e%Mo;return i===0&&(i=Mo),i}function Mf(e,i,s){var o=s-1,r=uh.charCodeAt(o),h=fh.charCodeAt(o),u=r+e-1,c=h+i,d=!1;u>nn&&(u=u-nn+pi-1,d=!0),(u===Bt||r<Bt&&u>Bt||(u>Bt||r<Bt)&&d)&&u++,(u===Vt||r<Vt&&u>Vt||(u>Vt||r<Vt)&&d)&&(u++,u===Bt&&u++),u>nn&&(u=u-nn+pi-1),c>en?(c=c-en+pi-1,d=!0):d=!1,(c===Bt||h<Bt&&c>Bt||(c>Bt||h<Bt)&&d)&&c++,(c===Vt||h<Vt&&c>Vt||(c>Vt||h<Vt)&&d)&&(c++,c===Bt&&c++),c>en&&(c=c-en+pi-1);var _=String.fromCharCode(u)+String.fromCharCode(c);return _}function gh(e){if(e&&e.length===0)throw"MGRSPoint coverting from nothing";for(var i=e.length,s=null,o="",r,h=0;!/[A-Z]/.test(r=e.charAt(h));){if(h>=2)throw"MGRSPoint bad conversion from: "+e;o+=r,h++}var u=parseInt(o,10);if(h===0||h+3>i)throw"MGRSPoint bad conversion from: "+e;var c=e.charAt(h++);if(c<="A"||c==="B"||c==="Y"||c>="Z"||c==="I"||c==="O")throw"MGRSPoint zone letter "+c+" not handled: "+e;s=e.substring(h,h+=2);for(var d=mh(u),_=wf(s.charAt(0),d),v=xf(s.charAt(1),d);v<Pf(c);)v+=2e6;var g=i-h;if(g%2!==0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+e;var p=g/2,M=0,w=0,P,x,A,T,S;return p>0&&(P=1e5/Math.pow(10,p),x=e.substring(h,h+p),M=parseFloat(x)*P,A=e.substring(h+p),w=parseFloat(A)*P),T=M+_,S=w+v,{easting:T,northing:S,zoneLetter:c,zoneNumber:u,accuracy:P}}function wf(e,i){for(var s=uh.charCodeAt(i-1),o=1e5,r=!1;s!==e.charCodeAt(0);){if(s++,s===Bt&&s++,s===Vt&&s++,s>nn){if(r)throw"Bad character: "+e;s=pi,r=!0}o+=1e5}return o}function xf(e,i){if(e>"V")throw"MGRSPoint given invalid Northing "+e;for(var s=fh.charCodeAt(i-1),o=0,r=!1;s!==e.charCodeAt(0);){if(s++,s===Bt&&s++,s===Vt&&s++,s>en){if(r)throw"Bad character: "+e;s=pi,r=!0}o+=1e5}return o}function Pf(e){var i;switch(e){case"C":i=11e5;break;case"D":i=2e6;break;case"E":i=28e5;break;case"F":i=37e5;break;case"G":i=46e5;break;case"H":i=55e5;break;case"J":i=64e5;break;case"K":i=73e5;break;case"L":i=82e5;break;case"M":i=91e5;break;case"N":i=0;break;case"P":i=8e5;break;case"Q":i=17e5;break;case"R":i=26e5;break;case"S":i=35e5;break;case"T":i=44e5;break;case"U":i=53e5;break;case"V":i=62e5;break;case"W":i=7e6;break;case"X":i=79e5;break;default:i=-1}if(i>=0)return i;throw"Invalid zone letter: "+e}function bi(e,i,s){if(!(this instanceof bi))return new bi(e,i,s);if(Array.isArray(e))this.x=e[0],this.y=e[1],this.z=e[2]||0;else if(typeof e=="object")this.x=e.x,this.y=e.y,this.z=e.z||0;else if(typeof e=="string"&&typeof i>"u"){var o=e.split(",");this.x=parseFloat(o[0]),this.y=parseFloat(o[1]),this.z=parseFloat(o[2])||0}else this.x=e,this.y=i,this.z=s||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}bi.fromMGRS=function(e){return new bi(_h(e))};bi.prototype.toMGRS=function(e){return dh([this.x,this.y],e)};var bf=1,Sf=.25,xo=.046875,Po=.01953125,bo=.01068115234375,Ef=.75,Tf=.46875,Lf=.013020833333333334,Af=.007120768229166667,Cf=.3645833333333333,Gf=.005696614583333333,If=.3076171875;function er(e){var i=[];i[0]=bf-e*(Sf+e*(xo+e*(Po+e*bo))),i[1]=e*(Ef-e*(xo+e*(Po+e*bo)));var s=e*e;return i[2]=s*(Tf-e*(Lf+e*Af)),s*=e,i[3]=s*(Cf-e*Gf),i[4]=s*e*If,i}function Li(e,i,s,o){return s*=i,i*=i,o[0]*e-s*(o[1]+i*(o[2]+i*(o[3]+i*o[4])))}var Nf=20;function ir(e,i,s){for(var o=1/(1-i),r=e,h=Nf;h;--h){var u=Math.sin(r),c=1-i*u*u;if(c=(Li(r,u,Math.cos(r),s)-e)*(c*Math.sqrt(c))*o,r-=c,Math.abs(c)<R)return r}return r}function Of(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=er(this.es),this.ml0=Li(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function Rf(e){var i=e.x,s=e.y,o=k(i-this.long0),r,h,u,c=Math.sin(s),d=Math.cos(s);if(this.es){var v=d*o,g=Math.pow(v,2),p=this.ep2*Math.pow(d,2),M=Math.pow(p,2),w=Math.abs(d)>R?Math.tan(s):0,P=Math.pow(w,2),x=Math.pow(P,2);r=1-this.es*Math.pow(c,2),v=v/Math.sqrt(r);var A=Li(s,c,d,this.en);h=this.a*(this.k0*v*(1+g/6*(1-P+p+g/20*(5-18*P+x+14*p-58*P*p+g/42*(61+179*x-x*P-479*P)))))+this.x0,u=this.a*(this.k0*(A-this.ml0+c*o*v/2*(1+g/12*(5-P+9*p+4*M+g/30*(61+x-58*P+270*p-330*P*p+g/56*(1385+543*x-x*P-3111*P))))))+this.y0}else{var _=d*Math.sin(o);if(Math.abs(Math.abs(_)-1)<R)return 93;if(h=.5*this.a*this.k0*Math.log((1+_)/(1-_))+this.x0,u=d*Math.cos(o)/Math.sqrt(1-Math.pow(_,2)),_=Math.abs(u),_>=1){if(_-1>R)return 93;u=0}else u=Math.acos(u);s<0&&(u=-u),u=this.a*this.k0*(u-this.lat0)+this.y0}return e.x=h,e.y=u,e}function kf(e){var i,s,o,r,h=(e.x-this.x0)*(1/this.a),u=(e.y-this.y0)*(1/this.a);if(this.es)if(i=this.ml0+u/this.k0,s=ir(i,this.es,this.en),Math.abs(s)<G){var g=Math.sin(s),p=Math.cos(s),M=Math.abs(p)>R?Math.tan(s):0,w=this.ep2*Math.pow(p,2),P=Math.pow(w,2),x=Math.pow(M,2),A=Math.pow(x,2);i=1-this.es*Math.pow(g,2);var T=h*Math.sqrt(i)/this.k0,S=Math.pow(T,2);i=i*M,o=s-i*S/(1-this.es)*.5*(1-S/12*(5+3*x-9*w*x+w-4*P-S/30*(61+90*x-252*w*x+45*A+46*w-S/56*(1385+3633*x+4095*A+1574*A*x)))),r=k(this.long0+T*(1-S/6*(1+2*x+w-S/20*(5+28*x+24*A+8*w*x+6*w-S/42*(61+662*x+1320*A+720*A*x))))/p)}else o=G*Pn(u),r=0;else{var c=Math.exp(h/this.k0),d=.5*(c-1/c),_=this.lat0+u/this.k0,v=Math.cos(_);i=Math.sqrt((1-Math.pow(v,2))/(1+Math.pow(d,2))),o=Math.asin(i),u<0&&(o=-o),d===0&&v===0?r=0:r=k(Math.atan2(d,v)+this.long0)}return e.x=r,e.y=o,e}var Df=["Fast_Transverse_Mercator","Fast Transverse Mercator"];const us={init:Of,forward:Rf,inverse:kf,names:Df};function ph(e){var i=Math.exp(e);return i=(i-1/i)/2,i}function zt(e,i){e=Math.abs(e),i=Math.abs(i);var s=Math.max(e,i),o=Math.min(e,i)/(s||1);return s*Math.sqrt(1+Math.pow(o,2))}function Bf(e){var i=1+e,s=i-1;return s===0?e:e*Math.log(i)/s}function zf(e){var i=Math.abs(e);return i=Bf(i*(1+i/(zt(1,i)+1))),e<0?-i:i}function nr(e,i){for(var s=2*Math.cos(2*i),o=e.length-1,r=e[o],h=0,u;--o>=0;)u=-h+s*r+e[o],h=r,r=u;return i+u*Math.sin(2*i)}function Ff(e,i){for(var s=2*Math.cos(i),o=e.length-1,r=e[o],h=0,u;--o>=0;)u=-h+s*r+e[o],h=r,r=u;return Math.sin(i)*u}function Zf(e){var i=Math.exp(e);return i=(i+1/i)/2,i}function vh(e,i,s){for(var o=Math.sin(i),r=Math.cos(i),h=ph(s),u=Zf(s),c=2*r*u,d=-2*o*h,_=e.length-1,v=e[_],g=0,p=0,M=0,w,P;--_>=0;)w=p,P=g,p=v,g=M,v=-w+c*p-d*g+e[_],M=-P+d*p+c*g;return c=o*u,d=r*h,[c*v-d*M,c*M+d*v]}function Uf(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(us.init.apply(this),this.forward=us.forward,this.inverse=us.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var e=this.es/(1+Math.sqrt(1-this.es)),i=e/(2-e),s=i;this.cgb[0]=i*(2+i*(-2/3+i*(-2+i*(116/45+i*(26/45+i*(-2854/675)))))),this.cbg[0]=i*(-2+i*(2/3+i*(4/3+i*(-82/45+i*(32/45+i*(4642/4725)))))),s=s*i,this.cgb[1]=s*(7/3+i*(-8/5+i*(-227/45+i*(2704/315+i*(2323/945))))),this.cbg[1]=s*(5/3+i*(-16/15+i*(-13/9+i*(904/315+i*(-1522/945))))),s=s*i,this.cgb[2]=s*(56/15+i*(-136/35+i*(-1262/105+i*(73814/2835)))),this.cbg[2]=s*(-26/15+i*(34/21+i*(8/5+i*(-12686/2835)))),s=s*i,this.cgb[3]=s*(4279/630+i*(-332/35+i*(-399572/14175))),this.cbg[3]=s*(1237/630+i*(-12/5+i*(-24832/14175))),s=s*i,this.cgb[4]=s*(4174/315+i*(-144838/6237)),this.cbg[4]=s*(-734/315+i*(109598/31185)),s=s*i,this.cgb[5]=s*(601676/22275),this.cbg[5]=s*(444337/155925),s=Math.pow(i,2),this.Qn=this.k0/(1+i)*(1+s*(1/4+s*(1/64+s/256))),this.utg[0]=i*(-.5+i*(2/3+i*(-37/96+i*(1/360+i*(81/512+i*(-96199/604800)))))),this.gtu[0]=i*(.5+i*(-2/3+i*(5/16+i*(41/180+i*(-127/288+i*(7891/37800)))))),this.utg[1]=s*(-1/48+i*(-1/15+i*(437/1440+i*(-46/105+i*(1118711/3870720))))),this.gtu[1]=s*(13/48+i*(-3/5+i*(557/1440+i*(281/630+i*(-1983433/1935360))))),s=s*i,this.utg[2]=s*(-17/480+i*(37/840+i*(209/4480+i*(-5569/90720)))),this.gtu[2]=s*(61/240+i*(-103/140+i*(15061/26880+i*(167603/181440)))),s=s*i,this.utg[3]=s*(-4397/161280+i*(11/504+i*(830251/7257600))),this.gtu[3]=s*(49561/161280+i*(-179/168+i*(6601661/7257600))),s=s*i,this.utg[4]=s*(-4583/161280+i*(108847/3991680)),this.gtu[4]=s*(34729/80640+i*(-3418889/1995840)),s=s*i,this.utg[5]=s*(-20648693/638668800),this.gtu[5]=s*(212378941/319334400);var o=nr(this.cbg,this.lat0);this.Zb=-this.Qn*(o+Ff(this.gtu,2*o))}function qf(e){var i=k(e.x-this.long0),s=e.y;s=nr(this.cbg,s);var o=Math.sin(s),r=Math.cos(s),h=Math.sin(i),u=Math.cos(i);s=Math.atan2(o,u*r),i=Math.atan2(h*r,zt(o,r*u)),i=zf(Math.tan(i));var c=vh(this.gtu,2*s,2*i);s=s+c[0],i=i+c[1];var d,_;return Math.abs(i)<=2.623395162778?(d=this.a*(this.Qn*i)+this.x0,_=this.a*(this.Qn*s+this.Zb)+this.y0):(d=1/0,_=1/0),e.x=d,e.y=_,e}function jf(e){var i=(e.x-this.x0)*(1/this.a),s=(e.y-this.y0)*(1/this.a);s=(s-this.Zb)/this.Qn,i=i/this.Qn;var o,r;if(Math.abs(i)<=2.623395162778){var h=vh(this.utg,2*s,2*i);s=s+h[0],i=i+h[1],i=Math.atan(ph(i));var u=Math.sin(s),c=Math.cos(s),d=Math.sin(i),_=Math.cos(i);s=Math.atan2(u*_,zt(d,_*c)),i=Math.atan2(d,_*c),o=k(i+this.long0),r=nr(this.cgb,s)}else o=1/0,r=1/0;return e.x=o,e.y=r,e}var $f=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"];const fs={init:Uf,forward:qf,inverse:jf,names:$f};function Hf(e,i){if(e===void 0){if(e=Math.floor((k(i)+Math.PI)*30/Math.PI)+1,e<0)return 0;if(e>60)return 60}return e}var Vf="etmerc";function Wf(){var e=Hf(this.zone,this.long0);if(e===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(e)-183)*Lt,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,fs.init.apply(this),this.forward=fs.forward,this.inverse=fs.inverse}var Kf=["Universal Transverse Mercator System","utm"];const Xf={init:Wf,names:Kf,dependsOn:Vf};function sr(e,i){return Math.pow((1-e)/(1+e),i)}var Yf=20;function Jf(){var e=Math.sin(this.lat0),i=Math.cos(this.lat0);i*=i,this.rc=Math.sqrt(1-this.es)/(1-this.es*e*e),this.C=Math.sqrt(1+this.es*i*i/(1-this.es)),this.phic0=Math.asin(e/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+ht)/(Math.pow(Math.tan(.5*this.lat0+ht),this.C)*sr(this.e*e,this.ratexp))}function Qf(e){var i=e.x,s=e.y;return e.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*s+ht),this.C)*sr(this.e*Math.sin(s),this.ratexp))-G,e.x=this.C*i,e}function t0(e){for(var i=1e-14,s=e.x/this.C,o=e.y,r=Math.pow(Math.tan(.5*o+ht)/this.K,1/this.C),h=Yf;h>0&&(o=2*Math.atan(r*sr(this.e*Math.sin(e.y),-.5*this.e))-G,!(Math.abs(o-e.y)<i));--h)e.y=o;return h?(e.x=s,e.y=o,e):null}const ar={init:Jf,forward:Qf,inverse:t0};function e0(){ar.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function i0(e){var i,s,o,r;return e.x=k(e.x-this.long0),ar.forward.apply(this,[e]),i=Math.sin(e.y),s=Math.cos(e.y),o=Math.cos(e.x),r=this.k0*this.R2/(1+this.sinc0*i+this.cosc0*s*o),e.x=r*s*Math.sin(e.x),e.y=r*(this.cosc0*i-this.sinc0*s*o),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function n0(e){var i,s,o,r,h;if(e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,e.x/=this.k0,e.y/=this.k0,h=zt(e.x,e.y)){var u=2*Math.atan2(h,this.R2);i=Math.sin(u),s=Math.cos(u),r=Math.asin(s*this.sinc0+e.y*i*this.cosc0/h),o=Math.atan2(e.x*i,h*this.cosc0*s-e.y*this.sinc0*i)}else r=this.phic0,o=0;return e.x=o,e.y=r,ar.inverse.apply(this,[e]),e.x=k(e.x+this.long0),e}var s0=["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"];const a0={init:e0,forward:i0,inverse:n0,names:s0};function rr(e,i,s){return i*=s,Math.tan(.5*(G+e))*Math.pow((1-i)/(1+i),.5*s)}function r0(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=R&&(this.k0=.5*(1+Pn(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=R&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=R&&Math.abs(Math.cos(this.lat_ts))>R&&(this.k0=.5*this.cons*fe(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/ne(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=fe(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(rr(this.lat0,this.sinlat0,this.e))-G,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function o0(e){var i=e.x,s=e.y,o=Math.sin(s),r=Math.cos(s),h,u,c,d,_,v,g=k(i-this.long0);return Math.abs(Math.abs(i-this.long0)-Math.PI)<=R&&Math.abs(s+this.lat0)<=R?(e.x=NaN,e.y=NaN,e):this.sphere?(h=2*this.k0/(1+this.sinlat0*o+this.coslat0*r*Math.cos(g)),e.x=this.a*h*r*Math.sin(g)+this.x0,e.y=this.a*h*(this.coslat0*o-this.sinlat0*r*Math.cos(g))+this.y0,e):(u=2*Math.atan(rr(s,o,this.e))-G,d=Math.cos(u),c=Math.sin(u),Math.abs(this.coslat0)<=R?(_=ne(this.e,s*this.con,this.con*o),v=2*this.a*this.k0*_/this.cons,e.x=this.x0+v*Math.sin(i-this.long0),e.y=this.y0-this.con*v*Math.cos(i-this.long0),e):(Math.abs(this.sinlat0)<R?(h=2*this.a*this.k0/(1+d*Math.cos(g)),e.y=h*c):(h=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*c+this.cosX0*d*Math.cos(g))),e.y=h*(this.cosX0*c-this.sinX0*d*Math.cos(g))+this.y0),e.x=h*d*Math.sin(g)+this.x0,e))}function h0(e){e.x-=this.x0,e.y-=this.y0;var i,s,o,r,h,u=Math.sqrt(e.x*e.x+e.y*e.y);if(this.sphere){var c=2*Math.atan(u/(2*this.a*this.k0));return i=this.long0,s=this.lat0,u<=R?(e.x=i,e.y=s,e):(s=Math.asin(Math.cos(c)*this.sinlat0+e.y*Math.sin(c)*this.coslat0/u),Math.abs(this.coslat0)<R?this.lat0>0?i=k(this.long0+Math.atan2(e.x,-1*e.y)):i=k(this.long0+Math.atan2(e.x,e.y)):i=k(this.long0+Math.atan2(e.x*Math.sin(c),u*this.coslat0*Math.cos(c)-e.y*this.sinlat0*Math.sin(c))),e.x=i,e.y=s,e)}else if(Math.abs(this.coslat0)<=R){if(u<=R)return s=this.lat0,i=this.long0,e.x=i,e.y=s,e;e.x*=this.con,e.y*=this.con,o=u*this.cons/(2*this.a*this.k0),s=this.con*pn(this.e,o),i=this.con*k(this.con*this.long0+Math.atan2(e.x,-1*e.y))}else r=2*Math.atan(u*this.cosX0/(2*this.a*this.k0*this.ms1)),i=this.long0,u<=R?h=this.X0:(h=Math.asin(Math.cos(r)*this.sinX0+e.y*Math.sin(r)*this.cosX0/u),i=k(this.long0+Math.atan2(e.x*Math.sin(r),u*this.cosX0*Math.cos(r)-e.y*this.sinX0*Math.sin(r)))),s=-1*pn(this.e,Math.tan(.5*(G+h)));return e.x=i,e.y=s,e}var l0=["stere","Stereographic_South_Pole","Polar_Stereographic_variant_A","Polar_Stereographic_variant_B","Polar_Stereographic"];const c0={init:r0,forward:o0,inverse:h0,names:l0,ssfn_:rr};function u0(){var e=this.lat0;this.lambda0=this.long0;var i=Math.sin(e),s=this.a,o=this.rf,r=1/o,h=2*r-Math.pow(r,2),u=this.e=Math.sqrt(h);this.R=this.k0*s*Math.sqrt(1-h)/(1-h*Math.pow(i,2)),this.alpha=Math.sqrt(1+h/(1-h)*Math.pow(Math.cos(e),4)),this.b0=Math.asin(i/this.alpha);var c=Math.log(Math.tan(Math.PI/4+this.b0/2)),d=Math.log(Math.tan(Math.PI/4+e/2)),_=Math.log((1+u*i)/(1-u*i));this.K=c-this.alpha*d+this.alpha*u/2*_}function f0(e){var i=Math.log(Math.tan(Math.PI/4-e.y/2)),s=this.e/2*Math.log((1+this.e*Math.sin(e.y))/(1-this.e*Math.sin(e.y))),o=-this.alpha*(i+s)+this.K,r=2*(Math.atan(Math.exp(o))-Math.PI/4),h=this.alpha*(e.x-this.lambda0),u=Math.atan(Math.sin(h)/(Math.sin(this.b0)*Math.tan(r)+Math.cos(this.b0)*Math.cos(h))),c=Math.asin(Math.cos(this.b0)*Math.sin(r)-Math.sin(this.b0)*Math.cos(r)*Math.cos(h));return e.y=this.R/2*Math.log((1+Math.sin(c))/(1-Math.sin(c)))+this.y0,e.x=this.R*u+this.x0,e}function d0(e){for(var i=e.x-this.x0,s=e.y-this.y0,o=i/this.R,r=2*(Math.atan(Math.exp(s/this.R))-Math.PI/4),h=Math.asin(Math.cos(this.b0)*Math.sin(r)+Math.sin(this.b0)*Math.cos(r)*Math.cos(o)),u=Math.atan(Math.sin(o)/(Math.cos(this.b0)*Math.cos(o)-Math.sin(this.b0)*Math.tan(r))),c=this.lambda0+u/this.alpha,d=0,_=h,v=-1e3,g=0;Math.abs(_-v)>1e-7;){if(++g>20)return;d=1/this.alpha*(Math.log(Math.tan(Math.PI/4+h/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(_))/2)),v=_,_=2*Math.atan(Math.exp(d))-Math.PI/2}return e.x=c,e.y=_,e}var _0=["somerc"];const m0={init:u0,forward:f0,inverse:d0,names:_0};var _i=1e-7;function g0(e){var i=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],s=typeof e.projName=="object"?Object.keys(e.projName)[0]:e.projName;return"no_uoff"in e||"no_off"in e||i.indexOf(s)!==-1||i.indexOf(rh(s))!==-1}function p0(){var e,i,s,o,r,h,u,c,d,_,v=0,g,p=0,M=0,w=0,P=0,x=0,A=0;this.no_off=g0(this),this.no_rot="no_rot"in this;var T=!1;"alpha"in this&&(T=!0);var S=!1;if("rectified_grid_angle"in this&&(S=!0),T&&(A=this.alpha),S&&(v=this.rectified_grid_angle),T||S)p=this.longc;else if(M=this.long1,P=this.lat1,w=this.long2,x=this.lat2,Math.abs(P-x)<=_i||(e=Math.abs(P))<=_i||Math.abs(e-G)<=_i||Math.abs(Math.abs(this.lat0)-G)<=_i||Math.abs(Math.abs(x)-G)<=_i)throw new Error;var I=1-this.es;i=Math.sqrt(I),Math.abs(this.lat0)>R?(c=Math.sin(this.lat0),s=Math.cos(this.lat0),e=1-this.es*c*c,this.B=s*s,this.B=Math.sqrt(1+this.es*this.B*this.B/I),this.A=this.B*this.k0*i/e,o=this.B*i/(s*Math.sqrt(e)),r=o*o-1,r<=0?r=0:(r=Math.sqrt(r),this.lat0<0&&(r=-r)),this.E=r+=o,this.E*=Math.pow(ne(this.e,this.lat0,c),this.B)):(this.B=1/i,this.A=this.k0,this.E=o=r=1),T||S?(T?(g=Math.asin(Math.sin(A)/o),S||(v=A)):(g=v,A=Math.asin(o*Math.sin(g))),this.lam0=p-Math.asin(.5*(r-1/r)*Math.tan(g))/this.B):(h=Math.pow(ne(this.e,P,Math.sin(P)),this.B),u=Math.pow(ne(this.e,x,Math.sin(x)),this.B),r=this.E/h,d=(u-h)/(u+h),_=this.E*this.E,_=(_-u*h)/(_+u*h),e=M-w,e<-Math.PI?w-=mn:e>Math.PI&&(w+=mn),this.lam0=k(.5*(M+w)-Math.atan(_*Math.tan(.5*this.B*(M-w))/d)/this.B),g=Math.atan(2*Math.sin(this.B*k(M-this.lam0))/(r-1/r)),v=A=Math.asin(o*Math.sin(g))),this.singam=Math.sin(g),this.cosgam=Math.cos(g),this.sinrot=Math.sin(v),this.cosrot=Math.cos(v),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(o*o-1)/Math.cos(A))),this.lat0<0&&(this.u_0=-this.u_0)),r=.5*g,this.v_pole_n=this.ArB*Math.log(Math.tan(ht-r)),this.v_pole_s=this.ArB*Math.log(Math.tan(ht+r))}function v0(e){var i={},s,o,r,h,u,c,d,_;if(e.x=e.x-this.lam0,Math.abs(Math.abs(e.y)-G)>R){if(u=this.E/Math.pow(ne(this.e,e.y,Math.sin(e.y)),this.B),c=1/u,s=.5*(u-c),o=.5*(u+c),h=Math.sin(this.B*e.x),r=(s*this.singam-h*this.cosgam)/o,Math.abs(Math.abs(r)-1)<R)throw new Error;_=.5*this.ArB*Math.log((1-r)/(1+r)),c=Math.cos(this.B*e.x),Math.abs(c)<_i?d=this.A*e.x:d=this.ArB*Math.atan2(s*this.cosgam+h*this.singam,c)}else _=e.y>0?this.v_pole_n:this.v_pole_s,d=this.ArB*e.y;return this.no_rot?(i.x=d,i.y=_):(d-=this.u_0,i.x=_*this.cosrot+d*this.sinrot,i.y=d*this.cosrot-_*this.sinrot),i.x=this.a*i.x+this.x0,i.y=this.a*i.y+this.y0,i}function y0(e){var i,s,o,r,h,u,c,d={};if(e.x=(e.x-this.x0)*(1/this.a),e.y=(e.y-this.y0)*(1/this.a),this.no_rot?(s=e.y,i=e.x):(s=e.x*this.cosrot-e.y*this.sinrot,i=e.y*this.cosrot+e.x*this.sinrot+this.u_0),o=Math.exp(-this.BrA*s),r=.5*(o-1/o),h=.5*(o+1/o),u=Math.sin(this.BrA*i),c=(u*this.cosgam+r*this.singam)/h,Math.abs(Math.abs(c)-1)<R)d.x=0,d.y=c<0?-G:G;else{if(d.y=this.E/Math.sqrt((1+c)/(1-c)),d.y=pn(this.e,Math.pow(d.y,1/this.B)),d.y===1/0)throw new Error;d.x=-this.rB*Math.atan2(r*this.cosgam-u*this.singam,Math.cos(this.BrA*i))}return d.x+=this.lam0,d}var M0=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Variant_B","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"];const w0={init:p0,forward:v0,inverse:y0,names:M0};function x0(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<R)){var e=this.b/this.a;this.e=Math.sqrt(1-e*e);var i=Math.sin(this.lat1),s=Math.cos(this.lat1),o=fe(this.e,i,s),r=ne(this.e,this.lat1,i),h=Math.sin(this.lat2),u=Math.cos(this.lat2),c=fe(this.e,h,u),d=ne(this.e,this.lat2,h),_=Math.abs(Math.abs(this.lat0)-G)<R?0:ne(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>R?this.ns=Math.log(o/c)/Math.log(r/d):this.ns=i,isNaN(this.ns)&&(this.ns=i),this.f0=o/(this.ns*Math.pow(r,this.ns)),this.rh=this.a*this.f0*Math.pow(_,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function P0(e){var i=e.x,s=e.y;Math.abs(2*Math.abs(s)-Math.PI)<=R&&(s=Pn(s)*(G-2*R));var o=Math.abs(Math.abs(s)-G),r,h;if(o>R)r=ne(this.e,s,Math.sin(s)),h=this.a*this.f0*Math.pow(r,this.ns);else{if(o=s*this.ns,o<=0)return null;h=0}var u=this.ns*k(i-this.long0);return e.x=this.k0*(h*Math.sin(u))+this.x0,e.y=this.k0*(this.rh-h*Math.cos(u))+this.y0,e}function b0(e){var i,s,o,r,h,u=(e.x-this.x0)/this.k0,c=this.rh-(e.y-this.y0)/this.k0;this.ns>0?(i=Math.sqrt(u*u+c*c),s=1):(i=-Math.sqrt(u*u+c*c),s=-1);var d=0;if(i!==0&&(d=Math.atan2(s*u,s*c)),i!==0||this.ns>0){if(s=1/this.ns,o=Math.pow(i/(this.a*this.f0),s),r=pn(this.e,o),r===-9999)return null}else r=-G;return h=k(d/this.ns+this.long0),e.x=h,e.y=r,e}var S0=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"];const E0={init:x0,forward:P0,inverse:b0,names:S0};function T0(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function L0(e){var i,s,o,r,h,u,c,d=e.x,_=e.y,v=k(d-this.long0);return i=Math.pow((1+this.e*Math.sin(_))/(1-this.e*Math.sin(_)),this.alfa*this.e/2),s=2*(Math.atan(this.k*Math.pow(Math.tan(_/2+this.s45),this.alfa)/i)-this.s45),o=-v*this.alfa,r=Math.asin(Math.cos(this.ad)*Math.sin(s)+Math.sin(this.ad)*Math.cos(s)*Math.cos(o)),h=Math.asin(Math.cos(s)*Math.sin(o)/Math.cos(r)),u=this.n*h,c=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(r/2+this.s45),this.n),e.y=c*Math.cos(u)/1,e.x=c*Math.sin(u)/1,this.czech||(e.y*=-1,e.x*=-1),e}function A0(e){var i,s,o,r,h,u,c,d,_=e.x;e.x=e.y,e.y=_,this.czech||(e.y*=-1,e.x*=-1),u=Math.sqrt(e.x*e.x+e.y*e.y),h=Math.atan2(e.y,e.x),r=h/Math.sin(this.s0),o=2*(Math.atan(Math.pow(this.ro0/u,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),i=Math.asin(Math.cos(this.ad)*Math.sin(o)-Math.sin(this.ad)*Math.cos(o)*Math.cos(r)),s=Math.asin(Math.cos(o)*Math.sin(r)/Math.cos(i)),e.x=this.long0-s/this.alfa,c=i,d=0;var v=0;do e.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(i/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(c))/(1-this.e*Math.sin(c)),this.e/2))-this.s45),Math.abs(c-e.y)<1e-10&&(d=1),c=e.y,v+=1;while(d===0&&v<15);return v>=15?null:e}var C0=["Krovak","krovak"];const G0={init:T0,forward:L0,inverse:A0,names:C0};function Rt(e,i,s,o,r){return e*r-i*Math.sin(2*r)+s*Math.sin(4*r)-o*Math.sin(6*r)}function bn(e){return 1-.25*e*(1+e/16*(3+1.25*e))}function Sn(e){return .375*e*(1+.25*e*(1+.46875*e))}function En(e){return .05859375*e*e*(1+.75*e)}function Tn(e){return e*e*e*(35/3072)}function or(e,i,s){var o=i*s;return e/Math.sqrt(1-o*o)}function Re(e){return Math.abs(e)<G?e:e-Pn(e)*Math.PI}function vs(e,i,s,o,r){var h,u;h=e/i;for(var c=0;c<15;c++)if(u=(e-(i*h-s*Math.sin(2*h)+o*Math.sin(4*h)-r*Math.sin(6*h)))/(i-2*s*Math.cos(2*h)+4*o*Math.cos(4*h)-6*r*Math.cos(6*h)),h+=u,Math.abs(u)<=1e-10)return h;return NaN}function I0(){this.sphere||(this.e0=bn(this.es),this.e1=Sn(this.es),this.e2=En(this.es),this.e3=Tn(this.es),this.ml0=this.a*Rt(this.e0,this.e1,this.e2,this.e3,this.lat0))}function N0(e){var i,s,o=e.x,r=e.y;if(o=k(o-this.long0),this.sphere)i=this.a*Math.asin(Math.cos(r)*Math.sin(o)),s=this.a*(Math.atan2(Math.tan(r),Math.cos(o))-this.lat0);else{var h=Math.sin(r),u=Math.cos(r),c=or(this.a,this.e,h),d=Math.tan(r)*Math.tan(r),_=o*Math.cos(r),v=_*_,g=this.es*u*u/(1-this.es),p=this.a*Rt(this.e0,this.e1,this.e2,this.e3,r);i=c*_*(1-v*d*(1/6-(8-d+8*g)*v/120)),s=p-this.ml0+c*h/u*v*(.5+(5-d+6*g)*v/24)}return e.x=i+this.x0,e.y=s+this.y0,e}function O0(e){e.x-=this.x0,e.y-=this.y0;var i=e.x/this.a,s=e.y/this.a,o,r;if(this.sphere){var h=s+this.lat0;o=Math.asin(Math.sin(h)*Math.cos(i)),r=Math.atan2(Math.tan(i),Math.cos(h))}else{var u=this.ml0/this.a+s,c=vs(u,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(c)-G)<=R)return e.x=this.long0,e.y=G,s<0&&(e.y*=-1),e;var d=or(this.a,this.e,Math.sin(c)),_=d*d*d/this.a/this.a*(1-this.es),v=Math.pow(Math.tan(c),2),g=i*this.a/d,p=g*g;o=c-d*Math.tan(c)/_*g*g*(.5-(1+3*v)*g*g/24),r=g*(1-p*(v/3+(1+3*v)*v*p/15))/Math.cos(c)}return e.x=k(r+this.long0),e.y=Re(o),e}var R0=["Cassini","Cassini_Soldner","cass"];const k0={init:I0,forward:N0,inverse:O0,names:R0};function Ge(e,i){var s;return e>1e-7?(s=e*i,(1-e*e)*(i/(1-s*s)-.5/e*Math.log((1-s)/(1+s)))):2*i}var La=1,Aa=2,Ca=3,ds=4;function D0(){var e=Math.abs(this.lat0);if(Math.abs(e-G)<R?this.mode=this.lat0<0?La:Aa:Math.abs(e)<R?this.mode=Ca:this.mode=ds,this.es>0){var i;switch(this.qp=Ge(this.e,1),this.mmf=.5/(1-this.es),this.apa=H0(this.es),this.mode){case Aa:this.dd=1;break;case La:this.dd=1;break;case Ca:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case ds:this.rq=Math.sqrt(.5*this.qp),i=Math.sin(this.lat0),this.sinb1=Ge(this.e,i)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*i*i)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===ds&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function B0(e){var i,s,o,r,h,u,c,d,_,v,g=e.x,p=e.y;if(g=k(g-this.long0),this.sphere){if(h=Math.sin(p),v=Math.cos(p),o=Math.cos(g),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(s=this.mode===this.EQUIT?1+v*o:1+this.sinph0*h+this.cosph0*v*o,s<=R)return null;s=Math.sqrt(2/s),i=s*v*Math.sin(g),s*=this.mode===this.EQUIT?h:this.cosph0*h-this.sinph0*v*o}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(o=-o),Math.abs(p+this.lat0)<R)return null;s=ht-p*.5,s=2*(this.mode===this.S_POLE?Math.cos(s):Math.sin(s)),i=s*Math.sin(g),s*=o}}else{switch(c=0,d=0,_=0,o=Math.cos(g),r=Math.sin(g),h=Math.sin(p),u=Ge(this.e,h),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(c=u/this.qp,d=Math.sqrt(1-c*c)),this.mode){case this.OBLIQ:_=1+this.sinb1*c+this.cosb1*d*o;break;case this.EQUIT:_=1+d*o;break;case this.N_POLE:_=G+p,u=this.qp-u;break;case this.S_POLE:_=p-G,u=this.qp+u;break}if(Math.abs(_)<R)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:_=Math.sqrt(2/_),this.mode===this.OBLIQ?s=this.ymf*_*(this.cosb1*c-this.sinb1*d*o):s=(_=Math.sqrt(2/(1+d*o)))*c*this.ymf,i=this.xmf*_*d*r;break;case this.N_POLE:case this.S_POLE:u>=0?(i=(_=Math.sqrt(u))*r,s=o*(this.mode===this.S_POLE?_:-_)):i=s=0;break}}return e.x=this.a*i+this.x0,e.y=this.a*s+this.y0,e}function z0(e){e.x-=this.x0,e.y-=this.y0;var i=e.x/this.a,s=e.y/this.a,o,r,h,u,c,d,_;if(this.sphere){var v=0,g,p=0;if(g=Math.sqrt(i*i+s*s),r=g*.5,r>1)return null;switch(r=2*Math.asin(r),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(p=Math.sin(r),v=Math.cos(r)),this.mode){case this.EQUIT:r=Math.abs(g)<=R?0:Math.asin(s*p/g),i*=p,s=v*g;break;case this.OBLIQ:r=Math.abs(g)<=R?this.lat0:Math.asin(v*this.sinph0+s*p*this.cosph0/g),i*=p*this.cosph0,s=(v-Math.sin(r)*this.sinph0)*g;break;case this.N_POLE:s=-s,r=G-r;break;case this.S_POLE:r-=G;break}o=s===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(i,s)}else{if(_=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(i/=this.dd,s*=this.dd,d=Math.sqrt(i*i+s*s),d<R)return e.x=this.long0,e.y=this.lat0,e;u=2*Math.asin(.5*d/this.rq),h=Math.cos(u),i*=u=Math.sin(u),this.mode===this.OBLIQ?(_=h*this.sinb1+s*u*this.cosb1/d,c=this.qp*_,s=d*this.cosb1*h-s*this.sinb1*u):(_=s*u/d,c=this.qp*_,s=d*h)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(s=-s),c=i*i+s*s,!c)return e.x=this.long0,e.y=this.lat0,e;_=1-c/this.qp,this.mode===this.S_POLE&&(_=-_)}o=Math.atan2(i,s),r=V0(Math.asin(_),this.apa)}return e.x=k(this.long0+o),e.y=r,e}var F0=.3333333333333333,Z0=.17222222222222222,U0=.10257936507936508,q0=.06388888888888888,j0=.0664021164021164,$0=.016415012942191543;function H0(e){var i,s=[];return s[0]=e*F0,i=e*e,s[0]+=i*Z0,s[1]=i*q0,i*=e,s[0]+=i*U0,s[1]+=i*j0,s[2]=i*$0,s}function V0(e,i){var s=e+e;return e+i[0]*Math.sin(s)+i[1]*Math.sin(s+s)+i[2]*Math.sin(s+s+s)}var W0=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"];const K0={init:D0,forward:B0,inverse:z0,names:W0,S_POLE:La,N_POLE:Aa,EQUIT:Ca,OBLIQ:ds};function Ne(e){return Math.abs(e)>1&&(e=e>1?1:-1),Math.asin(e)}function X0(){Math.abs(this.lat1+this.lat2)<R||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=fe(this.e3,this.sin_po,this.cos_po),this.qs1=Ge(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=fe(this.e3,this.sin_po,this.cos_po),this.qs2=Ge(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Ge(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>R?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function Y0(e){var i=e.x,s=e.y;this.sin_phi=Math.sin(s),this.cos_phi=Math.cos(s);var o=Ge(this.e3,this.sin_phi),r=this.a*Math.sqrt(this.c-this.ns0*o)/this.ns0,h=this.ns0*k(i-this.long0),u=r*Math.sin(h)+this.x0,c=this.rh-r*Math.cos(h)+this.y0;return e.x=u,e.y=c,e}function J0(e){var i,s,o,r,h,u;return e.x-=this.x0,e.y=this.rh-e.y+this.y0,this.ns0>=0?(i=Math.sqrt(e.x*e.x+e.y*e.y),o=1):(i=-Math.sqrt(e.x*e.x+e.y*e.y),o=-1),r=0,i!==0&&(r=Math.atan2(o*e.x,o*e.y)),o=i*this.ns0/this.a,this.sphere?u=Math.asin((this.c-o*o)/(2*this.ns0)):(s=(this.c-o*o)/this.ns0,u=this.phi1z(this.e3,s)),h=k(r/this.ns0+this.long0),e.x=h,e.y=u,e}function Q0(e,i){var s,o,r,h,u,c=Ne(.5*i);if(e<R)return c;for(var d=e*e,_=1;_<=25;_++)if(s=Math.sin(c),o=Math.cos(c),r=e*s,h=1-r*r,u=.5*h*h/o*(i/(1-d)-s/h+.5/e*Math.log((1-r)/(1+r))),c=c+u,Math.abs(u)<=1e-7)return c;return null}var td=["Albers_Conic_Equal_Area","Albers_Equal_Area","Albers","aea"];const ed={init:X0,forward:Y0,inverse:J0,names:td,phi1z:Q0};function id(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function nd(e){var i,s,o,r,h,u,c,d,_=e.x,v=e.y;return o=k(_-this.long0),i=Math.sin(v),s=Math.cos(v),r=Math.cos(o),u=this.sin_p14*i+this.cos_p14*s*r,h=1,u>0||Math.abs(u)<=R?(c=this.x0+this.a*h*s*Math.sin(o)/u,d=this.y0+this.a*h*(this.cos_p14*i-this.sin_p14*s*r)/u):(c=this.x0+this.infinity_dist*s*Math.sin(o),d=this.y0+this.infinity_dist*(this.cos_p14*i-this.sin_p14*s*r)),e.x=c,e.y=d,e}function sd(e){var i,s,o,r,h,u;return e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,e.x/=this.k0,e.y/=this.k0,(i=Math.sqrt(e.x*e.x+e.y*e.y))?(r=Math.atan2(i,this.rc),s=Math.sin(r),o=Math.cos(r),u=Ne(o*this.sin_p14+e.y*s*this.cos_p14/i),h=Math.atan2(e.x*s,i*this.cos_p14*o-e.y*this.sin_p14*s),h=k(this.long0+h)):(u=this.phic0,h=0),e.x=h,e.y=u,e}var ad=["gnom"];const rd={init:id,forward:nd,inverse:sd,names:ad};function od(e,i){var s=1-(1-e*e)/(2*e)*Math.log((1-e)/(1+e));if(Math.abs(Math.abs(i)-s)<1e-6)return i<0?-1*G:G;for(var o=Math.asin(.5*i),r,h,u,c,d=0;d<30;d++)if(h=Math.sin(o),u=Math.cos(o),c=e*h,r=Math.pow(1-c*c,2)/(2*u)*(i/(1-e*e)-h/(1-c*c)+.5/e*Math.log((1-c)/(1+c))),o+=r,Math.abs(r)<=1e-10)return o;return NaN}function hd(){this.sphere||(this.k0=fe(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function ld(e){var i=e.x,s=e.y,o,r,h=k(i-this.long0);if(this.sphere)o=this.x0+this.a*h*Math.cos(this.lat_ts),r=this.y0+this.a*Math.sin(s)/Math.cos(this.lat_ts);else{var u=Ge(this.e,Math.sin(s));o=this.x0+this.a*this.k0*h,r=this.y0+this.a*u*.5/this.k0}return e.x=o,e.y=r,e}function cd(e){e.x-=this.x0,e.y-=this.y0;var i,s;return this.sphere?(i=k(this.long0+e.x/this.a/Math.cos(this.lat_ts)),s=Math.asin(e.y/this.a*Math.cos(this.lat_ts))):(s=od(this.e,2*e.y*this.k0/this.a),i=k(this.long0+e.x/(this.a*this.k0))),e.x=i,e.y=s,e}var ud=["cea"];const fd={init:hd,forward:ld,inverse:cd,names:ud};function dd(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function _d(e){var i=e.x,s=e.y,o=k(i-this.long0),r=Re(s-this.lat0);return e.x=this.x0+this.a*o*this.rc,e.y=this.y0+this.a*r,e}function md(e){var i=e.x,s=e.y;return e.x=k(this.long0+(i-this.x0)/(this.a*this.rc)),e.y=Re(this.lat0+(s-this.y0)/this.a),e}var gd=["Equirectangular","Equidistant_Cylindrical","Equidistant_Cylindrical_Spherical","eqc"];const pd={init:dd,forward:_d,inverse:md,names:gd};var So=20;function vd(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=bn(this.es),this.e1=Sn(this.es),this.e2=En(this.es),this.e3=Tn(this.es),this.ml0=this.a*Rt(this.e0,this.e1,this.e2,this.e3,this.lat0)}function yd(e){var i=e.x,s=e.y,o,r,h,u=k(i-this.long0);if(h=u*Math.sin(s),this.sphere)Math.abs(s)<=R?(o=this.a*u,r=-1*this.a*this.lat0):(o=this.a*Math.sin(h)/Math.tan(s),r=this.a*(Re(s-this.lat0)+(1-Math.cos(h))/Math.tan(s)));else if(Math.abs(s)<=R)o=this.a*u,r=-1*this.ml0;else{var c=or(this.a,this.e,Math.sin(s))/Math.tan(s);o=c*Math.sin(h),r=this.a*Rt(this.e0,this.e1,this.e2,this.e3,s)-this.ml0+c*(1-Math.cos(h))}return e.x=o+this.x0,e.y=r+this.y0,e}function Md(e){var i,s,o,r,h,u,c,d,_;if(o=e.x-this.x0,r=e.y-this.y0,this.sphere)if(Math.abs(r+this.a*this.lat0)<=R)i=k(o/this.a+this.long0),s=0;else{u=this.lat0+r/this.a,c=o*o/this.a/this.a+u*u,d=u;var v;for(h=So;h;--h)if(v=Math.tan(d),_=-1*(u*(d*v+1)-d-.5*(d*d+c)*v)/((d-u)/v-1),d+=_,Math.abs(_)<=R){s=d;break}i=k(this.long0+Math.asin(o*Math.tan(d)/this.a)/Math.sin(s))}else if(Math.abs(r+this.ml0)<=R)s=0,i=k(this.long0+o/this.a);else{u=(this.ml0+r)/this.a,c=o*o/this.a/this.a+u*u,d=u;var g,p,M,w,P;for(h=So;h;--h)if(P=this.e*Math.sin(d),g=Math.sqrt(1-P*P)*Math.tan(d),p=this.a*Rt(this.e0,this.e1,this.e2,this.e3,d),M=this.e0-2*this.e1*Math.cos(2*d)+4*this.e2*Math.cos(4*d)-6*this.e3*Math.cos(6*d),w=p/this.a,_=(u*(g*w+1)-w-.5*g*(w*w+c))/(this.es*Math.sin(2*d)*(w*w+c-2*u*w)/(4*g)+(u-w)*(g*M-2/Math.sin(2*d))-M),d-=_,Math.abs(_)<=R){s=d;break}g=Math.sqrt(1-this.es*Math.pow(Math.sin(s),2))*Math.tan(s),i=k(this.long0+Math.asin(o*g/this.a)/Math.sin(s))}return e.x=i,e.y=s,e}var wd=["Polyconic","American_Polyconic","poly"];const xd={init:vd,forward:yd,inverse:Md,names:wd};function Pd(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function bd(e){var i,s=e.x,o=e.y,r=o-this.lat0,h=s-this.long0,u=r/on*1e-5,c=h,d=1,_=0;for(i=1;i<=10;i++)d=d*u,_=_+this.A[i]*d;var v=_,g=c,p=1,M=0,w,P,x=0,A=0;for(i=1;i<=6;i++)w=p*v-M*g,P=M*v+p*g,p=w,M=P,x=x+this.B_re[i]*p-this.B_im[i]*M,A=A+this.B_im[i]*p+this.B_re[i]*M;return e.x=A*this.a+this.x0,e.y=x*this.a+this.y0,e}function Sd(e){var i,s=e.x,o=e.y,r=s-this.x0,h=o-this.y0,u=h/this.a,c=r/this.a,d=1,_=0,v,g,p=0,M=0;for(i=1;i<=6;i++)v=d*u-_*c,g=_*u+d*c,d=v,_=g,p=p+this.C_re[i]*d-this.C_im[i]*_,M=M+this.C_im[i]*d+this.C_re[i]*_;for(var w=0;w<this.iterations;w++){var P=p,x=M,A,T,S=u,I=c;for(i=2;i<=6;i++)A=P*p-x*M,T=x*p+P*M,P=A,x=T,S=S+(i-1)*(this.B_re[i]*P-this.B_im[i]*x),I=I+(i-1)*(this.B_im[i]*P+this.B_re[i]*x);P=1,x=0;var O=this.B_re[1],N=this.B_im[1];for(i=2;i<=6;i++)A=P*p-x*M,T=x*p+P*M,P=A,x=T,O=O+i*(this.B_re[i]*P-this.B_im[i]*x),N=N+i*(this.B_im[i]*P+this.B_re[i]*x);var B=O*O+N*N;p=(S*O+I*N)/B,M=(I*O-S*N)/B}var q=p,j=M,$=1,F=0;for(i=1;i<=9;i++)$=$*q,F=F+this.D[i]*$;var K=this.lat0+F*on*1e5,ct=this.long0+j;return e.x=ct,e.y=K,e}var Ed=["New_Zealand_Map_Grid","nzmg"];const Td={init:Pd,forward:bd,inverse:Sd,names:Ed};function Ld(){}function Ad(e){var i=e.x,s=e.y,o=k(i-this.long0),r=this.x0+this.a*o,h=this.y0+this.a*Math.log(Math.tan(Math.PI/4+s/2.5))*1.25;return e.x=r,e.y=h,e}function Cd(e){e.x-=this.x0,e.y-=this.y0;var i=k(this.long0+e.x/this.a),s=2.5*(Math.atan(Math.exp(.8*e.y/this.a))-Math.PI/4);return e.x=i,e.y=s,e}var Gd=["Miller_Cylindrical","mill"];const Id={init:Ld,forward:Ad,inverse:Cd,names:Gd};var Nd=20;function Od(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=er(this.es)}function Rd(e){var i,s,o=e.x,r=e.y;if(o=k(o-this.long0),this.sphere){if(!this.m)r=this.n!==1?Math.asin(this.n*Math.sin(r)):r;else for(var h=this.n*Math.sin(r),u=Nd;u;--u){var c=(this.m*r+Math.sin(r)-h)/(this.m+Math.cos(r));if(r-=c,Math.abs(c)<R)break}i=this.a*this.C_x*o*(this.m+Math.cos(r)),s=this.a*this.C_y*r}else{var d=Math.sin(r),_=Math.cos(r);s=this.a*Li(r,d,_,this.en),i=this.a*o*_/Math.sqrt(1-this.es*d*d)}return e.x=i,e.y=s,e}function kd(e){var i,s,o,r;return e.x-=this.x0,o=e.x/this.a,e.y-=this.y0,i=e.y/this.a,this.sphere?(i/=this.C_y,o=o/(this.C_x*(this.m+Math.cos(i))),this.m?i=Ne((this.m*i+Math.sin(i))/this.n):this.n!==1&&(i=Ne(Math.sin(i)/this.n)),o=k(o+this.long0),i=Re(i)):(i=ir(e.y/this.a,this.es,this.en),r=Math.abs(i),r<G?(r=Math.sin(i),s=this.long0+e.x*Math.sqrt(1-this.es*r*r)/(this.a*Math.cos(i)),o=k(s)):r-R<G&&(o=this.long0)),e.x=o,e.y=i,e}var Dd=["Sinusoidal","sinu"];const Bd={init:Od,forward:Rd,inverse:kd,names:Dd};function zd(){}function Fd(e){for(var i=e.x,s=e.y,o=k(i-this.long0),r=s,h=Math.PI*Math.sin(s);;){var u=-(r+Math.sin(r)-h)/(1+Math.cos(r));if(r+=u,Math.abs(u)<R)break}r/=2,Math.PI/2-Math.abs(s)<R&&(o=0);var c=.900316316158*this.a*o*Math.cos(r)+this.x0,d=1.4142135623731*this.a*Math.sin(r)+this.y0;return e.x=c,e.y=d,e}function Zd(e){var i,s;e.x-=this.x0,e.y-=this.y0,s=e.y/(1.4142135623731*this.a),Math.abs(s)>.999999999999&&(s=.999999999999),i=Math.asin(s);var o=k(this.long0+e.x/(.900316316158*this.a*Math.cos(i)));o<-Math.PI&&(o=-Math.PI),o>Math.PI&&(o=Math.PI),s=(2*i+Math.sin(2*i))/Math.PI,Math.abs(s)>1&&(s=1);var r=Math.asin(s);return e.x=o,e.y=r,e}var Ud=["Mollweide","moll"];const qd={init:zd,forward:Fd,inverse:Zd,names:Ud};function jd(){Math.abs(this.lat1+this.lat2)<R||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=bn(this.es),this.e1=Sn(this.es),this.e2=En(this.es),this.e3=Tn(this.es),this.sin_phi=Math.sin(this.lat1),this.cos_phi=Math.cos(this.lat1),this.ms1=fe(this.e,this.sin_phi,this.cos_phi),this.ml1=Rt(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<R?this.ns=this.sin_phi:(this.sin_phi=Math.sin(this.lat2),this.cos_phi=Math.cos(this.lat2),this.ms2=fe(this.e,this.sin_phi,this.cos_phi),this.ml2=Rt(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=Rt(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function $d(e){var i=e.x,s=e.y,o;if(this.sphere)o=this.a*(this.g-s);else{var r=Rt(this.e0,this.e1,this.e2,this.e3,s);o=this.a*(this.g-r)}var h=this.ns*k(i-this.long0),u=this.x0+o*Math.sin(h),c=this.y0+this.rh-o*Math.cos(h);return e.x=u,e.y=c,e}function Hd(e){e.x-=this.x0,e.y=this.rh-e.y+this.y0;var i,s,o,r;this.ns>=0?(s=Math.sqrt(e.x*e.x+e.y*e.y),i=1):(s=-Math.sqrt(e.x*e.x+e.y*e.y),i=-1);var h=0;if(s!==0&&(h=Math.atan2(i*e.x,i*e.y)),this.sphere)return r=k(this.long0+h/this.ns),o=Re(this.g-s/this.a),e.x=r,e.y=o,e;var u=this.g-s/this.a;return o=vs(u,this.e0,this.e1,this.e2,this.e3),r=k(this.long0+h/this.ns),e.x=r,e.y=o,e}var Vd=["Equidistant_Conic","eqdc"];const Wd={init:jd,forward:$d,inverse:Hd,names:Vd};function Kd(){this.R=this.a}function Xd(e){var i=e.x,s=e.y,o=k(i-this.long0),r,h;Math.abs(s)<=R&&(r=this.x0+this.R*o,h=this.y0);var u=Ne(2*Math.abs(s/Math.PI));(Math.abs(o)<=R||Math.abs(Math.abs(s)-G)<=R)&&(r=this.x0,s>=0?h=this.y0+Math.PI*this.R*Math.tan(.5*u):h=this.y0+Math.PI*this.R*-Math.tan(.5*u));var c=.5*Math.abs(Math.PI/o-o/Math.PI),d=c*c,_=Math.sin(u),v=Math.cos(u),g=v/(_+v-1),p=g*g,M=g*(2/_-1),w=M*M,P=Math.PI*this.R*(c*(g-w)+Math.sqrt(d*(g-w)*(g-w)-(w+d)*(p-w)))/(w+d);o<0&&(P=-P),r=this.x0+P;var x=d+g;return P=Math.PI*this.R*(M*x-c*Math.sqrt((w+d)*(d+1)-x*x))/(w+d),s>=0?h=this.y0+P:h=this.y0-P,e.x=r,e.y=h,e}function Yd(e){var i,s,o,r,h,u,c,d,_,v,g,p,M;return e.x-=this.x0,e.y-=this.y0,g=Math.PI*this.R,o=e.x/g,r=e.y/g,h=o*o+r*r,u=-Math.abs(r)*(1+h),c=u-2*r*r+o*o,d=-2*u+1+2*r*r+h*h,M=r*r/d+(2*c*c*c/d/d/d-9*u*c/d/d)/27,_=(u-c*c/3/d)/d,v=2*Math.sqrt(-_/3),g=3*M/_/v,Math.abs(g)>1&&(g>=0?g=1:g=-1),p=Math.acos(g)/3,e.y>=0?s=(-v*Math.cos(p+Math.PI/3)-c/3/d)*Math.PI:s=-(-v*Math.cos(p+Math.PI/3)-c/3/d)*Math.PI,Math.abs(o)<R?i=this.long0:i=k(this.long0+Math.PI*(h-1+Math.sqrt(1+2*(o*o-r*r)+h*h))/2/o),e.x=i,e.y=s,e}var Jd=["Van_der_Grinten_I","VanDerGrinten","Van_der_Grinten","vandg"];const Qd={init:Kd,forward:Xd,inverse:Yd,names:Jd};function t_(e,i,s,o,r,h){const u=o-i,c=Math.atan((1-h)*Math.tan(e)),d=Math.atan((1-h)*Math.tan(s)),_=Math.sin(c),v=Math.cos(c),g=Math.sin(d),p=Math.cos(d);let M=u,w,P=100,x,A,T,S,I,O,N,B,q,j,$,F,K,ct;do{if(x=Math.sin(M),A=Math.cos(M),T=Math.sqrt(p*x*(p*x)+(v*g-_*p*A)*(v*g-_*p*A)),T===0)return{azi1:0,s12:0};S=_*g+v*p*A,I=Math.atan2(T,S),O=v*p*x/T,N=1-O*O,B=N!==0?S-2*_*g/N:0,q=h/16*N*(4+h*(4-3*N)),w=M,M=u+(1-q)*h*O*(I+q*T*(B+q*S*(-1+2*B*B)))}while(Math.abs(M-w)>1e-12&&--P>0);return P===0?{azi1:NaN,s12:NaN}:(j=N*(r*r-r*(1-h)*(r*(1-h)))/(r*(1-h)*(r*(1-h))),$=1+j/16384*(4096+j*(-768+j*(320-175*j))),F=j/1024*(256+j*(-128+j*(74-47*j))),K=F*T*(B+F/4*(S*(-1+2*B*B)-F/6*B*(-3+4*T*T)*(-3+4*B*B))),ct=r*(1-h)*$*(I-K),{azi1:Math.atan2(p*x,v*g-_*p*A),s12:ct})}function e_(e,i,s,o,r,h){const u=Math.atan((1-h)*Math.tan(e)),c=Math.sin(u),d=Math.cos(u),_=Math.sin(s),v=Math.cos(s),g=Math.atan2(c,d*v),p=d*_,M=1-p*p,w=M*(r*r-r*(1-h)*(r*(1-h)))/(r*(1-h)*(r*(1-h))),P=1+w/16384*(4096+w*(-768+w*(320-175*w))),x=w/1024*(256+w*(-128+w*(74-47*w)));let A=o/(r*(1-h)*P),T,S=100,I,O,N,B;do I=Math.cos(2*g+A),O=Math.sin(A),N=Math.cos(A),B=x*O*(I+x/4*(N*(-1+2*I*I)-x/6*I*(-3+4*O*O)*(-3+4*I*I))),T=A,A=o/(r*(1-h)*P)+B;while(Math.abs(A-T)>1e-12&&--S>0);if(S===0)return{lat2:NaN,lon2:NaN};const q=c*O-d*N*v,j=Math.atan2(c*N+d*O*v,(1-h)*Math.sqrt(p*p+q*q)),$=Math.atan2(O*_,d*N-c*O*v),F=h/16*M*(4+h*(4-3*M)),K=$-(1-F)*h*p*(A+F*O*(I+F*N*(-1+2*I*I))),ct=i+K;return{lat2:j,lon2:ct}}function i_(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0),this.f=this.es/(1+Math.sqrt(1-this.es))}function n_(e){var i=e.x,s=e.y,o=Math.sin(e.y),r=Math.cos(e.y),h=k(i-this.long0),u,c,d,_,v,g,p,M,w,P,x;return this.sphere?Math.abs(this.sin_p12-1)<=R?(e.x=this.x0+this.a*(G-s)*Math.sin(h),e.y=this.y0-this.a*(G-s)*Math.cos(h),e):Math.abs(this.sin_p12+1)<=R?(e.x=this.x0+this.a*(G+s)*Math.sin(h),e.y=this.y0+this.a*(G+s)*Math.cos(h),e):(w=this.sin_p12*o+this.cos_p12*r*Math.cos(h),p=Math.acos(w),M=p?p/Math.sin(p):1,e.x=this.x0+this.a*M*r*Math.sin(h),e.y=this.y0+this.a*M*(this.cos_p12*o-this.sin_p12*r*Math.cos(h)),e):(u=bn(this.es),c=Sn(this.es),d=En(this.es),_=Tn(this.es),Math.abs(this.sin_p12-1)<=R?(v=this.a*Rt(u,c,d,_,G),g=this.a*Rt(u,c,d,_,s),e.x=this.x0+(v-g)*Math.sin(h),e.y=this.y0-(v-g)*Math.cos(h),e):Math.abs(this.sin_p12+1)<=R?(v=this.a*Rt(u,c,d,_,G),g=this.a*Rt(u,c,d,_,s),e.x=this.x0+(v+g)*Math.sin(h),e.y=this.y0+(v+g)*Math.cos(h),e):Math.abs(i)<R&&Math.abs(s-this.lat0)<R?(e.x=e.y=0,e):(P=t_(this.lat0,this.long0,s,i,this.a,this.f),x=P.azi1,e.x=P.s12*Math.sin(x),e.y=P.s12*Math.cos(x),e))}function s_(e){e.x-=this.x0,e.y-=this.y0;var i,s,o,r,h,u,c,d,_,v,g,p,M,w,P,x;return this.sphere?(i=Math.sqrt(e.x*e.x+e.y*e.y),i>2*G*this.a?void 0:(s=i/this.a,o=Math.sin(s),r=Math.cos(s),h=this.long0,Math.abs(i)<=R?u=this.lat0:(u=Ne(r*this.sin_p12+e.y*o*this.cos_p12/i),c=Math.abs(this.lat0)-G,Math.abs(c)<=R?this.lat0>=0?h=k(this.long0+Math.atan2(e.x,-e.y)):h=k(this.long0-Math.atan2(-e.x,e.y)):h=k(this.long0+Math.atan2(e.x*o,i*this.cos_p12*r-e.y*this.sin_p12*o))),e.x=h,e.y=u,e)):(d=bn(this.es),_=Sn(this.es),v=En(this.es),g=Tn(this.es),Math.abs(this.sin_p12-1)<=R?(p=this.a*Rt(d,_,v,g,G),i=Math.sqrt(e.x*e.x+e.y*e.y),M=p-i,u=vs(M/this.a,d,_,v,g),h=k(this.long0+Math.atan2(e.x,-1*e.y)),e.x=h,e.y=u,e):Math.abs(this.sin_p12+1)<=R?(p=this.a*Rt(d,_,v,g,G),i=Math.sqrt(e.x*e.x+e.y*e.y),M=i-p,u=vs(M/this.a,d,_,v,g),h=k(this.long0+Math.atan2(e.x,e.y)),e.x=h,e.y=u,e):(w=Math.atan2(e.x,e.y),P=Math.sqrt(e.x*e.x+e.y*e.y),x=e_(this.lat0,this.long0,w,P,this.a,this.f),e.x=x.lon2,e.y=x.lat2,e))}var a_=["Azimuthal_Equidistant","aeqd"];const r_={init:i_,forward:n_,inverse:s_,names:a_};function o_(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function h_(e){var i,s,o,r,h,u,c,d,_=e.x,v=e.y;return o=k(_-this.long0),i=Math.sin(v),s=Math.cos(v),r=Math.cos(o),u=this.sin_p14*i+this.cos_p14*s*r,h=1,(u>0||Math.abs(u)<=R)&&(c=this.a*h*s*Math.sin(o),d=this.y0+this.a*h*(this.cos_p14*i-this.sin_p14*s*r)),e.x=c,e.y=d,e}function l_(e){var i,s,o,r,h,u,c;return e.x-=this.x0,e.y-=this.y0,i=Math.sqrt(e.x*e.x+e.y*e.y),s=Ne(i/this.a),o=Math.sin(s),r=Math.cos(s),u=this.long0,Math.abs(i)<=R?(c=this.lat0,e.x=u,e.y=c,e):(c=Ne(r*this.sin_p14+e.y*o*this.cos_p14/i),h=Math.abs(this.lat0)-G,Math.abs(h)<=R?(this.lat0>=0?u=k(this.long0+Math.atan2(e.x,-e.y)):u=k(this.long0-Math.atan2(-e.x,e.y)),e.x=u,e.y=c,e):(u=k(this.long0+Math.atan2(e.x*o,i*this.cos_p14*r-e.y*this.sin_p14*o)),e.x=u,e.y=c,e))}var c_=["ortho"];const u_={init:o_,forward:h_,inverse:l_,names:c_};var vt={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},lt={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function f_(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=G-ht/2?this.face=vt.TOP:this.lat0<=-(G-ht/2)?this.face=vt.BOTTOM:Math.abs(this.long0)<=ht?this.face=vt.FRONT:Math.abs(this.long0)<=G+ht?this.face=this.long0>0?vt.RIGHT:vt.LEFT:this.face=vt.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function d_(e){var i={x:0,y:0},s,o,r,h,u,c,d={value:0};if(e.x-=this.long0,this.es!==0?s=Math.atan(this.one_minus_f_squared*Math.tan(e.y)):s=e.y,o=e.x,this.face===vt.TOP)h=G-s,o>=ht&&o<=G+ht?(d.value=lt.AREA_0,r=o-G):o>G+ht||o<=-(G+ht)?(d.value=lt.AREA_1,r=o>0?o-Mt:o+Mt):o>-(G+ht)&&o<=-ht?(d.value=lt.AREA_2,r=o+G):(d.value=lt.AREA_3,r=o);else if(this.face===vt.BOTTOM)h=G+s,o>=ht&&o<=G+ht?(d.value=lt.AREA_0,r=-o+G):o<ht&&o>=-ht?(d.value=lt.AREA_1,r=-o):o<-ht&&o>=-(G+ht)?(d.value=lt.AREA_2,r=-o-G):(d.value=lt.AREA_3,r=o>0?-o+Mt:-o-Mt);else{var _,v,g,p,M,w,P;this.face===vt.RIGHT?o=xi(o,+G):this.face===vt.BACK?o=xi(o,+Mt):this.face===vt.LEFT&&(o=xi(o,-G)),p=Math.sin(s),M=Math.cos(s),w=Math.sin(o),P=Math.cos(o),_=M*P,v=M*w,g=p,this.face===vt.FRONT?(h=Math.acos(_),r=hs(h,g,v,d)):this.face===vt.RIGHT?(h=Math.acos(v),r=hs(h,g,-_,d)):this.face===vt.BACK?(h=Math.acos(-_),r=hs(h,g,-v,d)):this.face===vt.LEFT?(h=Math.acos(-v),r=hs(h,g,_,d)):(h=r=0,d.value=lt.AREA_0)}return c=Math.atan(12/Mt*(r+Math.acos(Math.sin(r)*Math.cos(ht))-G)),u=Math.sqrt((1-Math.cos(h))/(Math.cos(c)*Math.cos(c))/(1-Math.cos(Math.atan(1/Math.cos(r))))),d.value===lt.AREA_1?c+=G:d.value===lt.AREA_2?c+=Mt:d.value===lt.AREA_3&&(c+=1.5*Mt),i.x=u*Math.cos(c),i.y=u*Math.sin(c),i.x=i.x*this.a+this.x0,i.y=i.y*this.a+this.y0,e.x=i.x,e.y=i.y,e}function __(e){var i={lam:0,phi:0},s,o,r,h,u,c,d,_,v,g={value:0};if(e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,o=Math.atan(Math.sqrt(e.x*e.x+e.y*e.y)),s=Math.atan2(e.y,e.x),e.x>=0&&e.x>=Math.abs(e.y)?g.value=lt.AREA_0:e.y>=0&&e.y>=Math.abs(e.x)?(g.value=lt.AREA_1,s-=G):e.x<0&&-e.x>=Math.abs(e.y)?(g.value=lt.AREA_2,s=s<0?s+Mt:s-Mt):(g.value=lt.AREA_3,s+=G),v=Mt/12*Math.tan(s),u=Math.sin(v)/(Math.cos(v)-1/Math.sqrt(2)),c=Math.atan(u),r=Math.cos(s),h=Math.tan(o),d=1-r*r*h*h*(1-Math.cos(Math.atan(1/Math.cos(c)))),d<-1?d=-1:d>1&&(d=1),this.face===vt.TOP)_=Math.acos(d),i.phi=G-_,g.value===lt.AREA_0?i.lam=c+G:g.value===lt.AREA_1?i.lam=c<0?c+Mt:c-Mt:g.value===lt.AREA_2?i.lam=c-G:i.lam=c;else if(this.face===vt.BOTTOM)_=Math.acos(d),i.phi=_-G,g.value===lt.AREA_0?i.lam=-c+G:g.value===lt.AREA_1?i.lam=-c:g.value===lt.AREA_2?i.lam=-c-G:i.lam=c<0?-c-Mt:-c+Mt;else{var p,M,w;p=d,v=p*p,v>=1?w=0:w=Math.sqrt(1-v)*Math.sin(c),v+=w*w,v>=1?M=0:M=Math.sqrt(1-v),g.value===lt.AREA_1?(v=M,M=-w,w=v):g.value===lt.AREA_2?(M=-M,w=-w):g.value===lt.AREA_3&&(v=M,M=w,w=-v),this.face===vt.RIGHT?(v=p,p=-M,M=v):this.face===vt.BACK?(p=-p,M=-M):this.face===vt.LEFT&&(v=p,p=M,M=-v),i.phi=Math.acos(-w)-G,i.lam=Math.atan2(M,p),this.face===vt.RIGHT?i.lam=xi(i.lam,-G):this.face===vt.BACK?i.lam=xi(i.lam,-Mt):this.face===vt.LEFT&&(i.lam=xi(i.lam,+G))}if(this.es!==0){var P,x,A;P=i.phi<0?1:0,x=Math.tan(i.phi),A=this.b/Math.sqrt(x*x+this.one_minus_f_squared),i.phi=Math.atan(Math.sqrt(this.a*this.a-A*A)/(this.one_minus_f*A)),P&&(i.phi=-i.phi)}return i.lam+=this.long0,e.x=i.lam,e.y=i.phi,e}function hs(e,i,s,o){var r;return e<R?(o.value=lt.AREA_0,r=0):(r=Math.atan2(i,s),Math.abs(r)<=ht?o.value=lt.AREA_0:r>ht&&r<=G+ht?(o.value=lt.AREA_1,r-=G):r>G+ht||r<=-(G+ht)?(o.value=lt.AREA_2,r=r>=0?r-Mt:r+Mt):(o.value=lt.AREA_3,r+=G)),r}function xi(e,i){var s=e+i;return s<-Mt?s+=mn:s>+Mt&&(s-=mn),s}var m_=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"];const g_={init:f_,forward:d_,inverse:__,names:m_};var Ga=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],sn=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],yh=.8487,Mh=1.3523,wh=ue/5,p_=1/wh,vi=18,ys=function(e,i){return e[0]+i*(e[1]+i*(e[2]+i*e[3]))},v_=function(e,i){return e[1]+i*(2*e[2]+i*3*e[3])};function y_(e,i,s,o){for(var r=i;o;--o){var h=e(r);if(r-=h,Math.abs(h)<s)break}return r}function M_(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function w_(e){var i=k(e.x-this.long0),s=Math.abs(e.y),o=Math.floor(s*wh);o<0?o=0:o>=vi&&(o=vi-1),s=ue*(s-p_*o);var r={x:ys(Ga[o],s)*i,y:ys(sn[o],s)};return e.y<0&&(r.y=-r.y),r.x=r.x*this.a*yh+this.x0,r.y=r.y*this.a*Mh+this.y0,r}function x_(e){var i={x:(e.x-this.x0)/(this.a*yh),y:Math.abs(e.y-this.y0)/(this.a*Mh)};if(i.y>=1)i.x/=Ga[vi][0],i.y=e.y<0?-G:G;else{var s=Math.floor(i.y*vi);for(s<0?s=0:s>=vi&&(s=vi-1);;)if(sn[s][0]>i.y)--s;else if(sn[s+1][0]<=i.y)++s;else break;var o=sn[s],r=5*(i.y-o[0])/(sn[s+1][0]-o[0]);r=y_(function(h){return(ys(o,h)-i.y)/v_(o,h)},r,R,100),i.x/=ys(Ga[s],r),i.y=(5*s+r)*Lt,e.y<0&&(i.y=-i.y)}return i.x=k(i.x+this.long0),i}var P_=["Robinson","robin"];const b_={init:M_,forward:w_,inverse:x_,names:P_};function S_(){this.name="geocent"}function E_(e){var i=hh(e,this.es,this.a);return i}function T_(e){var i=lh(e,this.es,this.a,this.b);return i}var L_=["Geocentric","geocentric","geocent","Geocent"];const A_={init:S_,forward:E_,inverse:T_,names:L_};var Ct={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},Qi={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function C_(){if(Object.keys(Qi).forEach(function(s){if(typeof this[s]>"u")this[s]=Qi[s].def;else{if(Qi[s].num&&isNaN(this[s]))throw new Error("Invalid parameter value, must be numeric "+s+" = "+this[s]);Qi[s].num&&(this[s]=parseFloat(this[s]))}Qi[s].degrees&&(this[s]=this[s]*Lt)}.bind(this)),Math.abs(Math.abs(this.lat0)-G)<R?this.mode=this.lat0<0?Ct.S_POLE:Ct.N_POLE:Math.abs(this.lat0)<R?this.mode=Ct.EQUIT:(this.mode=Ct.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var e=this.tilt,i=this.azi;this.cg=Math.cos(i),this.sg=Math.sin(i),this.cw=Math.cos(e),this.sw=Math.sin(e)}function G_(e){e.x-=this.long0;var i=Math.sin(e.y),s=Math.cos(e.y),o=Math.cos(e.x),r,h;switch(this.mode){case Ct.OBLIQ:h=this.sinph0*i+this.cosph0*s*o;break;case Ct.EQUIT:h=s*o;break;case Ct.S_POLE:h=-i;break;case Ct.N_POLE:h=i;break}switch(h=this.pn1/(this.p-h),r=h*s*Math.sin(e.x),this.mode){case Ct.OBLIQ:h*=this.cosph0*i-this.sinph0*s*o;break;case Ct.EQUIT:h*=i;break;case Ct.N_POLE:h*=-(s*o);break;case Ct.S_POLE:h*=s*o;break}var u,c;return u=h*this.cg+r*this.sg,c=1/(u*this.sw*this.h1+this.cw),r=(r*this.cg-h*this.sg)*this.cw*c,h=u*c,e.x=r*this.a,e.y=h*this.a,e}function I_(e){e.x/=this.a,e.y/=this.a;var i={x:e.x,y:e.y},s,o,r;r=1/(this.pn1-e.y*this.sw),s=this.pn1*e.x*r,o=this.pn1*e.y*this.cw*r,e.x=s*this.cg+o*this.sg,e.y=o*this.cg-s*this.sg;var h=zt(e.x,e.y);if(Math.abs(h)<R)i.x=0,i.y=e.y;else{var u,c;switch(c=1-h*h*this.pfact,c=(this.p-Math.sqrt(c))/(this.pn1/h+h/this.pn1),u=Math.sqrt(1-c*c),this.mode){case Ct.OBLIQ:i.y=Math.asin(u*this.sinph0+e.y*c*this.cosph0/h),e.y=(u-this.sinph0*Math.sin(i.y))*h,e.x*=c*this.cosph0;break;case Ct.EQUIT:i.y=Math.asin(e.y*c/h),e.y=u*h,e.x*=c;break;case Ct.N_POLE:i.y=Math.asin(u),e.y=-e.y;break;case Ct.S_POLE:i.y=-Math.asin(u);break}i.x=Math.atan2(e.x,e.y)}return e.x=i.x+this.long0,e.y=i.y,e}var N_=["Tilted_Perspective","tpers"];const O_={init:C_,forward:G_,inverse:I_,names:N_};function R_(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var e=1-this.es,i=1/e;this.radius_p=Math.sqrt(e),this.radius_p2=e,this.radius_p_inv2=i,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")}function k_(e){var i=e.x,s=e.y,o,r,h,u;if(i=i-this.long0,this.shape==="ellipse"){s=Math.atan(this.radius_p2*Math.tan(s));var c=this.radius_p/zt(this.radius_p*Math.cos(s),Math.sin(s));if(r=c*Math.cos(i)*Math.cos(s),h=c*Math.sin(i)*Math.cos(s),u=c*Math.sin(s),(this.radius_g-r)*r-h*h-u*u*this.radius_p_inv2<0)return e.x=Number.NaN,e.y=Number.NaN,e;o=this.radius_g-r,this.flip_axis?(e.x=this.radius_g_1*Math.atan(h/zt(u,o)),e.y=this.radius_g_1*Math.atan(u/o)):(e.x=this.radius_g_1*Math.atan(h/o),e.y=this.radius_g_1*Math.atan(u/zt(h,o)))}else this.shape==="sphere"&&(o=Math.cos(s),r=Math.cos(i)*o,h=Math.sin(i)*o,u=Math.sin(s),o=this.radius_g-r,this.flip_axis?(e.x=this.radius_g_1*Math.atan(h/zt(u,o)),e.y=this.radius_g_1*Math.atan(u/o)):(e.x=this.radius_g_1*Math.atan(h/o),e.y=this.radius_g_1*Math.atan(u/zt(h,o))));return e.x=e.x*this.a,e.y=e.y*this.a,e}function D_(e){var i=-1,s=0,o=0,r,h,u,c;if(e.x=e.x/this.a,e.y=e.y/this.a,this.shape==="ellipse"){this.flip_axis?(o=Math.tan(e.y/this.radius_g_1),s=Math.tan(e.x/this.radius_g_1)*zt(1,o)):(s=Math.tan(e.x/this.radius_g_1),o=Math.tan(e.y/this.radius_g_1)*zt(1,s));var d=o/this.radius_p;if(r=s*s+d*d+i*i,h=2*this.radius_g*i,u=h*h-4*r*this.C,u<0)return e.x=Number.NaN,e.y=Number.NaN,e;c=(-h-Math.sqrt(u))/(2*r),i=this.radius_g+c*i,s*=c,o*=c,e.x=Math.atan2(s,i),e.y=Math.atan(o*Math.cos(e.x)/i),e.y=Math.atan(this.radius_p_inv2*Math.tan(e.y))}else if(this.shape==="sphere"){if(this.flip_axis?(o=Math.tan(e.y/this.radius_g_1),s=Math.tan(e.x/this.radius_g_1)*Math.sqrt(1+o*o)):(s=Math.tan(e.x/this.radius_g_1),o=Math.tan(e.y/this.radius_g_1)*Math.sqrt(1+s*s)),r=s*s+o*o+i*i,h=2*this.radius_g*i,u=h*h-4*r*this.C,u<0)return e.x=Number.NaN,e.y=Number.NaN,e;c=(-h-Math.sqrt(u))/(2*r),i=this.radius_g+c*i,s*=c,o*=c,e.x=Math.atan2(s,i),e.y=Math.atan(o*Math.cos(e.x)/i)}return e.x=e.x+this.long0,e}var B_=["Geostationary Satellite View","Geostationary_Satellite","geos"];const z_={init:R_,forward:k_,inverse:D_,names:B_};var hn=1.340264,ln=-.081106,cn=893e-6,un=.003796,Ms=Math.sqrt(3)/2;function F_(){this.es=0,this.long0=this.long0!==void 0?this.long0:0}function Z_(e){var i=k(e.x-this.long0),s=e.y,o=Math.asin(Ms*Math.sin(s)),r=o*o,h=r*r*r;return e.x=i*Math.cos(o)/(Ms*(hn+3*ln*r+h*(7*cn+9*un*r))),e.y=o*(hn+ln*r+h*(cn+un*r)),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function U_(e){e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a;var i=1e-9,s=12,o=e.y,r,h,u,c,d,_;for(_=0;_<s&&(r=o*o,h=r*r*r,u=o*(hn+ln*r+h*(cn+un*r))-e.y,c=hn+3*ln*r+h*(7*cn+9*un*r),o-=d=u/c,!(Math.abs(d)<i));++_);return r=o*o,h=r*r*r,e.x=Ms*e.x*(hn+3*ln*r+h*(7*cn+9*un*r))/Math.cos(o),e.y=Math.asin(Math.sin(o)/Ms),e.x=k(e.x+this.long0),e}var q_=["eqearth","Equal Earth","Equal_Earth"];const j_={init:F_,forward:Z_,inverse:U_,names:q_};var vn=1e-10;function $_(){var e;if(this.phi1=this.lat1,Math.abs(this.phi1)<vn)throw new Error;this.es?(this.en=er(this.es),this.m1=Li(this.phi1,this.am1=Math.sin(this.phi1),e=Math.cos(this.phi1),this.en),this.am1=e/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=V_,this.forward=H_):(Math.abs(this.phi1)+vn>=G?this.cphi1=0:this.cphi1=1/Math.tan(this.phi1),this.inverse=K_,this.forward=W_)}function H_(e){var i=k(e.x-(this.long0||0)),s=e.y,o,r,h;return o=this.am1+this.m1-Li(s,r=Math.sin(s),h=Math.cos(s),this.en),r=h*i/(o*Math.sqrt(1-this.es*r*r)),e.x=o*Math.sin(r),e.y=this.am1-o*Math.cos(r),e.x=this.a*e.x+(this.x0||0),e.y=this.a*e.y+(this.y0||0),e}function V_(e){e.x=(e.x-(this.x0||0))/this.a,e.y=(e.y-(this.y0||0))/this.a;var i,s,o,r;if(s=zt(e.x,e.y=this.am1-e.y),r=ir(this.am1+this.m1-s,this.es,this.en),(i=Math.abs(r))<G)i=Math.sin(r),o=s*Math.atan2(e.x,e.y)*Math.sqrt(1-this.es*i*i)/Math.cos(r);else if(Math.abs(i-G)<=vn)o=0;else throw new Error;return e.x=k(o+(this.long0||0)),e.y=Re(r),e}function W_(e){var i=k(e.x-(this.long0||0)),s=e.y,o,r;return r=this.cphi1+this.phi1-s,Math.abs(r)>vn?(e.x=r*Math.sin(o=i*Math.cos(s)/r),e.y=this.cphi1-r*Math.cos(o)):e.x=e.y=0,e.x=this.a*e.x+(this.x0||0),e.y=this.a*e.y+(this.y0||0),e}function K_(e){e.x=(e.x-(this.x0||0))/this.a,e.y=(e.y-(this.y0||0))/this.a;var i,s,o=zt(e.x,e.y=this.cphi1-e.y);if(s=this.cphi1+this.phi1-o,Math.abs(s)>G)throw new Error;return Math.abs(Math.abs(s)-G)<=vn?i=0:i=o*Math.atan2(e.x,e.y)/Math.cos(s),e.x=k(i+(this.long0||0)),e.y=Re(s),e}var X_=["bonne","Bonne (Werner lat_1=90)"];const Y_={init:$_,names:X_};function J_(e){e.Proj.projections.add(us),e.Proj.projections.add(fs),e.Proj.projections.add(Xf),e.Proj.projections.add(a0),e.Proj.projections.add(c0),e.Proj.projections.add(m0),e.Proj.projections.add(w0),e.Proj.projections.add(E0),e.Proj.projections.add(G0),e.Proj.projections.add(k0),e.Proj.projections.add(K0),e.Proj.projections.add(ed),e.Proj.projections.add(rd),e.Proj.projections.add(fd),e.Proj.projections.add(pd),e.Proj.projections.add(xd),e.Proj.projections.add(Td),e.Proj.projections.add(Id),e.Proj.projections.add(Bd),e.Proj.projections.add(qd),e.Proj.projections.add(Wd),e.Proj.projections.add(Qd),e.Proj.projections.add(r_),e.Proj.projections.add(u_),e.Proj.projections.add(g_),e.Proj.projections.add(b_),e.Proj.projections.add(A_),e.Proj.projections.add(O_),e.Proj.projections.add(z_),e.Proj.projections.add(j_),e.Proj.projections.add(Y_)}const Pi=Object.assign(df,{defaultDatum:"WGS84",Proj:se,WGS84:new se("WGS84"),Point:bi,toPoint:ch,defs:Ot,nadgrid:Wu,transform:ps,mgrs:_f,version:"__VERSION__"});J_(Pi);const Eo=void 0;let ws=[];const fn=new Map,yn=new Set,Ia=new Set,Q_=new Map,xh=Pt.latLngBounds([38.9,16.2],[39.7,17.1]);let be=new Date().toISOString().slice(0,10),Ye=be;const xs=document.getElementById("loadingOverlay");let _s=0;const Ma=document.getElementById("brandLogo"),Na=document.getElementById("areasPanel"),To=document.getElementById("toggleAreas"),Lo=document.getElementById("closeAreas"),tn=document.getElementById("areasList"),Ps=document.getElementById("areaDrawStart"),We=document.getElementById("areaDrawFinish"),bs=document.getElementById("areaDrawCancel"),yi=document.getElementById("areaDrawHelp"),tm=Object.assign({"./areas/Laghetto di Zarella.geojson":zl,"./areas/Pianori di Macchialonga.geojson":Fl,"./areas/ZSC Carlomagno.geojson":Zl,"./areas/ZSC Macchia Sacra.geojson":Ul}),de=Object.entries(tm).map(([e,i])=>{let s;try{s=JSON.parse(i)}catch(u){console.warn("Failed to parse area GeoJSON",e,u),s=null}const o=e.split("/").pop()||"Area",r=o.replace(/\.geojson$/i,"");return{id:r.toLowerCase().replace(/[^a-z0-9]+/g,"-"),label:r,fileName:o,data:s,isCustom:!1}}).filter(e=>e.data&&typeof e.data=="object").sort((e,i)=>e.label.localeCompare(i.label)),Je=new Map(de.map(e=>[e.id,e])),Pe=new Map,Ph="sila_custom_areas_v1";let Qe=null,Ss=1,_t=null;const bh=yi?.textContent??"";let $e=null;const ls=im();Array.isArray(ls)&&ls.length&&(ls.forEach(e=>{!e||!e.id||Je.has(e.id)||(e.isCustom=!0,de.push(e),Je.set(e.id,e))}),hr(),Ss=Math.max(Ss,ls.length+1));const Es={color:"#2a6fdb",weight:2,opacity:.85,dashArray:"6 4",fillColor:"#2a6fdb",fillOpacity:.08},dn={color:"#1c4e9f",weight:3,opacity:1,dashArray:null,fillColor:"#2a6fdb",fillOpacity:.22};function Si(e,{temporary:i=!1,duration:s=3200}={}){yi&&(i?($e&&window.clearTimeout($e),yi.textContent=e,$e=window.setTimeout(()=>{yi.textContent=bh,$e=null},s)):($e&&(window.clearTimeout($e),$e=null),yi.textContent=e))}function Oa(){yi&&Si(bh)}function hr(){de.sort((e,i)=>e.label.localeCompare(i.label))}function em(e){if(!e||typeof e!="object")return null;const i=typeof e.id=="string"&&e.id.trim()?e.id.trim():null,s=typeof e.label=="string"&&e.label.trim()?e.label.trim():null,o=e.data&&typeof e.data=="object"?e.data:null;return!i||!s||!o||o.type!=="FeatureCollection"||!Array.isArray(o.features)?null:{id:i,label:s,fileName:`${i}.geojson`,data:o,isCustom:!0}}function im(){if(typeof window>"u"||!window.localStorage)return[];try{const e=window.localStorage.getItem(Ph);if(!e)return[];const i=JSON.parse(e);return Array.isArray(i)?i.map(em).filter(Boolean):[]}catch(e){return console.warn("Failed to load custom areas",e),[]}}function Sh(){if(!(typeof window>"u"||!window.localStorage))try{const e=de.filter(i=>i.isCustom).map(i=>({id:i.id,label:i.label,data:i.data}));window.localStorage.setItem(Ph,JSON.stringify(e))}catch(e){console.warn("Failed to save custom areas",e)}}function Ln(){if(!We)return;if(!_t){We.disabled=!0;return}const e=_t.vertices.length>=3;We.disabled=!e}function Mn(e){const i=e==="active";Ps&&(Ps.disabled=i),bs&&(bs.disabled=!i),i?Ln():We&&(We.disabled=!0)}function lr({keepHelp:e=!1}={}){if(!_t){e||Oa(),Mn("idle");return}nt.off("click",Eh),nt.off("mousemove",Th),nt.off("dblclick",Lh),_t.layerGroup&&nt.removeLayer(_t.layerGroup),_t.doubleClickZoomWasEnabled&&nt.doubleClickZoom&&nt.doubleClickZoom.enable&&nt.doubleClickZoom.enable(),nt.getContainer().style.cursor="",_t=null,e||Oa(),Mn("idle"),Ln()}function cr(e){if(!_t)return;const i=_t.vertices.slice();e&&i.length&&i.push(e),_t.previewLine.setLatLngs(i),_t.vertices.length>=3?_t.polygon.setLatLngs([_t.vertices]):_t.polygon.setLatLngs([])}function nm(e){if(!_t)return;_t.vertices.push(e);const i=Pt.circleMarker(e,{radius:5,color:dn.color,weight:2,fillColor:"#fff",fillOpacity:.9,interactive:!1});_t.layerGroup.addLayer(i),cr(null),Ln()}function Eh(e){if(!_t||!e?.latlng)return;const i=e.originalEvent?.detail;Number.isFinite(i)&&i>1||nm(e.latlng)}function Th(e){!_t||!e?.latlng||_t.vertices.length&&cr(e.latlng)}function Lh(e){_t&&(e?.originalEvent&&Pt.DomEvent.stop(e.originalEvent),cr(null),Ah())}function sm(){lr({keepHelp:!1});const e=Pt.layerGroup().addTo(nt),i=Pt.polyline([],{color:dn.color,weight:2,dashArray:"6 6",opacity:.85,interactive:!1}),s=Pt.polygon([],{color:dn.color,weight:2,dashArray:"4 4",fillColor:dn.fillColor,fillOpacity:.18,opacity:.9,interactive:!1});e.addLayer(i),e.addLayer(s);const o=nt.doubleClickZoom,r=!!(o&&o.enabled());r&&o.disable(),_t={vertices:[],layerGroup:e,polygon:s,previewLine:i,doubleClickZoomWasEnabled:r},nt.on("click",Eh),nt.on("mousemove",Th),nt.on("dblclick",Lh),nt.getContainer().style.cursor="crosshair",Mn("active"),Si("Drawing mode: click to add vertices, double-click or press Finish to save."),Ln()}function am(e){const i=(e||"area").toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"")||"area";let s=i,o=1;for(;Je.has(s);)o+=1,s=`${i}-${o}`;return s}function Ah(){if(!_t)return;if(_t.vertices.length<3){Si("Add at least three points to complete the area.",{temporary:!0,duration:3e3});return}const e=_t.vertices.map(_=>[Number(_.lng),Number(_.lat)]),i=e[0],s=e[e.length-1];i&&s&&(i[0]!==s[0]||i[1]!==s[1])&&e.push([...i]);const o=`Custom area ${Ss}`,r=window.prompt("Name for the new area:",o),h=r&&r.trim()?r.trim():o;Ss+=1;const u=am(h),c={type:"Feature",properties:{name:h,source:"custom",createdAt:new Date().toISOString()},geometry:{type:"Polygon",coordinates:[e]}},d={id:u,label:h,fileName:`${u}.geojson`,data:{type:"FeatureCollection",features:[c]},isCustom:!0};de.push(d),Je.set(u,d),hr(),Nh(d),Sh(),lr({keepHelp:!0}),wn(u),Gs(!0),Si(`Area "${h}" added and selected.`,{temporary:!0,duration:3600})}function rm(){if(!_t){Oa(),Mn("idle");return}lr({keepHelp:!0}),Si("Drawing cancelled.",{temporary:!0,duration:2600})}function om(e){if(!e)return;const i=Je.get(e);if(!i||!i.isCustom||!window.confirm(`Delete custom area "${i.label}"?`))return;const o=de.findIndex(h=>h.id===e);o!==-1&&de.splice(o,1),Je.delete(e);const r=Pe.get(e);r&&(r.layer&&nt.hasLayer(r.layer)&&nt.removeLayer(r.layer),Pe.delete(e)),hr(),Sh(),Qe===e?wn(null):ur(),Si(`Area "${i.label}" deleted.`,{temporary:!0,duration:2600})}function hm(){_s+=1,xs&&xs.classList.add("visible")}function lm(){_s=Math.max(0,_s-1),xs&&_s===0&&xs.classList.remove("visible")}function Ao(){Ma&&(yn.size>0?Ma.classList.add("overlay-active"):Ma.classList.remove("overlay-active"))}function Ve(e){if(!e)return;const[i,s,o]=e.split("-");return!i||!s||!o?e:`${o}-${s}-${i}`}function cm(e){const i=e.replace(/\.(tif|tiff)$/i,""),s=Gh(e),o=Ve(s);return o||i.replace(/_/g," ")}function ie(e){return e?e.slice(0,10).replace(/[^0-9-]/g,""):void 0}async function Ch(e){const i=await fetch(e);if(!i.ok)throw new Error(`Failed to fetch GeoTIFF (${i.status} ${i.statusText})`);const s=await i.arrayBuffer();return await iu(s)}async function Co({data:e,width:i,height:s,noData:o,ctx:r}){const h=r.createImageData(i,s),u=e.length,c=5e5;let d=0;for(;d<u;){const _=Math.min(d+c,u);for(;d<_;d++){const v=e[d],g=d*4;if(v==null||Number.isNaN(v)||v===o){h.data[g+3]=0;continue}const[p,M,w,P]=kh(v);h.data[g]=p,h.data[g+1]=M,h.data[g+2]=w,h.data[g+3]=P}await new Promise(requestAnimationFrame)}r.putImageData(h,0,0)}async function um(e,i){let s=1/0,o=-1/0;const r=5e5;let h=0;for(;h<e.length;){const u=Math.min(h+r,e.length);for(let c=h;c<u;c++){const d=e[c];d==null||Number.isNaN(d)||d===i||(d<s&&(s=d),d>o&&(o=d))}h=u,h<e.length&&await new Promise(requestAnimationFrame)}return Number.isFinite(s)||(s=0),Number.isFinite(o)||(o=1),{obsMin:s,obsMax:o}}const fm="https://gibs.earthdata.nasa.gov/wmts/epsg3857/best/MODIS_Terra_CorrectedReflectance_TrueColor/default/{date}/GoogleMapsCompatible_Level9/{z}/{y}/{x}.jpg";function Go(e,i){const s=ie(e||be||Ye);return fm.replace("{date}",s).replace("{z}",String(i.z)).replace("{y}",String(i.y)).replace("{x}",String(i.x))}function dm(e,i){return`/basemap/${ie(e||Ye)}/${i.z}/${i.x}/${i.y}.png`}function Ra(e){const i=ie(e||be||Ye);i&&(Ye=i)}function ka(){if(yn.size>0){const e=Array.from(yn).sort(),i=e[e.length-1];Ra(i)}else Ra(be)}Pt.TileLayer.extend({initialize(e={}){const i={minZoom:0,maxZoom:9,tileSize:256,crossOrigin:"anonymous",attribution:"Imagery  NASA Blue Marble, MODIS, and VIIRS, hosted by NASA GIBS",...e};Pt.TileLayer.prototype.initialize.call(this,"",i),this._currentDate=ie(e.date)||ie(be)},setDate(e){const i=ie(e||be||this._currentDate);!i||i===this._currentDate||(this._currentDate=i,this.redraw())},createTile(e,i){const s=document.createElement("img");return s.alt="",s.setAttribute("role","presentation"),this.options.crossOrigin&&(s.crossOrigin=this.options.crossOrigin),Pt.DomEvent.on(s,"load",Pt.Util.bind(this._tileOnLoad,this,i,s)),Pt.DomEvent.on(s,"error",()=>this._handleTileError(i,s,e)),this._setTileSrc(s,e,!1),s},_setTileSrc(e,i,s){const o=ie(this._currentDate||Ye||be);!s&&o&&Ia.has(o)?(e.dataset.retry="local",e.src=dm(o,i)):(e.dataset.retry="remote",e.src=Go(o,i))},_handleTileError(e,i,s){i.dataset.retry==="local"?(i.dataset.retry="remote",i.src=Go(this._currentDate||Ye||be,s)):(i.dataset.retry="failed",this._tileOnError(e,i,s))}});function Gh(e){const s=e.replace(/\.(tif|tiff)$/i,"").match(/20\d{6}/);if(!s)return;const o=s[0];return`${o.slice(0,4)}-${o.slice(4,6)}-${o.slice(6,8)}`}const Ih=document.getElementById("sidebar"),_m=document.getElementById("toggleSidebar"),mm=document.getElementById("closeSidebar"),an=document.getElementById("layers");function Cs(e){Ih.classList.toggle("open",e)}_m.addEventListener("click",()=>Cs(!Ih.classList.contains("open")));mm.addEventListener("click",()=>Cs(!1));function Gs(e){Na&&Na.classList.toggle("open",e)}To&&To.addEventListener("click",()=>{const e=!Na?.classList.contains("open");Gs(e)});Lo&&Lo.addEventListener("click",()=>Gs(!1));Ps&&Ps.addEventListener("click",()=>{Gs(!0),sm()});We&&We.addEventListener("click",()=>Ah());bs&&bs.addEventListener("click",()=>rm());Mn("idle");Ln();function ur(){if(!tn)return;if(tn.textContent="",!de.length){const h=document.createElement("p");h.textContent="No areas available.",h.style.fontSize="13px",h.style.color="#616e7c",h.style.margin="0",tn.appendChild(h);return}const e=document.createElement("label");e.className="areas-option";const i=document.createElement("input");i.type="radio",i.name="areaSelection",i.value="",i.checked=!Qe,i.addEventListener("change",()=>{i.checked&&wn(null,{focus:!1})});const s=document.createElement("div");s.className="areas-meta";const o=document.createElement("strong");o.textContent="All areas";const r=document.createElement("span");r.textContent="Show full raster extent",s.appendChild(o),s.appendChild(r),e.appendChild(i),e.appendChild(s),tn.appendChild(e),de.forEach(h=>{const u=document.createElement("label");u.className="areas-option";const c=document.createElement("input");c.type="radio",c.name="areaSelection",c.value=h.id,c.checked=Qe===h.id,c.addEventListener("change",()=>{c.checked&&wn(h.id)});const d=document.createElement("div");d.className="areas-meta";const _=document.createElement("strong");_.textContent=h.label,d.appendChild(_);const v=document.createElement("span");if(v.textContent="Focus map & filter rasters",d.appendChild(v),u.appendChild(c),u.appendChild(d),h.isCustom){const g=document.createElement("button");g.type="button",g.className="delete-area-btn",g.textContent="Delete",g.addEventListener("click",p=>{p.preventDefault(),p.stopPropagation(),om(h.id)}),u.appendChild(g)}tn.appendChild(u)})}function Nh(e){if(!e||!e.id||!e.data||Pe.has(e.id))return;const i=Pt.geoJSON(e.data,{style:()=>({...Es}),onEachFeature:(o,r)=>{r.on("click",()=>{wn(e.id,{focus:!1})})}});i.setStyle(Es);const s=i.getBounds&&i.getBounds();Pe.set(e.id,{layer:i,bounds:s})}const nt=Pt.map("map",{center:[39.2,16.6],zoom:9,worldCopyJump:!0,maxBounds:xh.pad(1)});Pt.tileLayer("https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{minZoom:0,maxZoom:19,attribution:"Tiles  Esri, Maxar, Earthstar Geographics, GIS User Community"}).addTo(nt);nt.fitBounds(xh.pad(.5));function gm(){de.forEach(Nh),ur()}function Ts(e,{force:i=!1}={}){if(!e||!e.layer||!e.canvas)return;const{canvas:s,layer:o,bounds:r}=e,h=s.width,u=s.height;if(!h||!u)return;const c=Qe?Je.get(Qe):null,d=c?c.id:"ALL";if(!i&&e.lastMaskKey===d)return;if(!c){const N=s.toDataURL("image/png");o.setUrl&&o.setUrl(N),e.lastMaskKey=d;return}if(!r||!r.isValid||!r.isValid()){const N=s.toDataURL("image/png");o.setUrl&&o.setUrl(N),e.lastMaskKey=d;return}const _=r.getNorthWest(),v=r.getSouthEast(),g=nt.options.crs.project(_),p=nt.options.crs.project(v),M=p.x-g.x,w=g.y-p.y;if(!Number.isFinite(M)||!Number.isFinite(w)||Math.abs(M)<1e-6||Math.abs(w)<1e-6){const N=s.toDataURL("image/png");o.setUrl&&o.setUrl(N),e.lastMaskKey=d;return}const P=document.createElement("canvas");P.width=h,P.height=u;const x=P.getContext("2d");if(!x){const N=s.toDataURL("image/png");o.setUrl&&o.setUrl(N),e.lastMaskKey=d;return}x.imageSmoothingEnabled=!0,x.drawImage(s,0,0),x.globalCompositeOperation="destination-in",x.beginPath();const A=(N,B)=>{const q=nt.options.crs.project(Pt.latLng(B,N)),j=(q.x-g.x)/M*h,$=(g.y-q.y)/w*u;return[j,$]},T=N=>{!Array.isArray(N)||N.length===0||(N.forEach((B,q)=>{if(!Array.isArray(B)||B.length<2)return;const j=Number(B[0]),$=Number(B[1]);if(!Number.isFinite(j)||!Number.isFinite($))return;const[F,K]=A(j,$);q===0?x.moveTo(F,K):x.lineTo(F,K)}),x.closePath())};let S=!1;if((Array.isArray(c?.data?.features)?c.data.features:[]).forEach(N=>{const B=N?.geometry;B&&(B.type==="Polygon"?(Array.isArray(B.coordinates)?B.coordinates:[]).forEach(j=>{T(j),S=!0}):B.type==="MultiPolygon"&&(Array.isArray(B.coordinates)?B.coordinates:[]).forEach(j=>{(Array.isArray(j)?j:[]).forEach(F=>{T(F),S=!0})}))}),!S){const N=s.toDataURL("image/png");o.setUrl&&o.setUrl(N),e.lastMaskKey=d;return}x.fill("evenodd"),x.globalCompositeOperation="source-over";const O=P.toDataURL("image/png");o.setUrl&&o.setUrl(O),e.lastMaskKey=d}function pm(){xe.forEach(e=>Ts(e))}function wn(e,{focus:i=!0}={}){const s=e&&Pe.has(e)?e:null;if(Qe===s){if(i&&s){const o=Pe.get(s);if(o?.bounds&&o.bounds.isValid&&o.bounds.isValid())try{nt.fitBounds(o.bounds.pad(.05))}catch{}}return}if(Qe=s,Pe.forEach((o,r)=>{o?.layer&&(r===s?(o.layer.setStyle(dn),nt.hasLayer(o.layer)||o.layer.addTo(nt),o.layer.bringToFront&&o.layer.bringToFront()):(o.layer.setStyle(Es),nt.hasLayer(o.layer)&&nt.removeLayer(o.layer)))}),ur(),s&&i){const o=Pe.get(s);if(o?.bounds&&o.bounds.isValid&&o.bounds.isValid())try{nt.fitBounds(o.bounds.pad(.08))}catch{}}s||Pe.forEach(o=>{o?.layer&&(nt.hasLayer(o.layer)&&nt.removeLayer(o.layer),o.layer.setStyle(Es))}),pm()}gm();const xe=new Map;let Da="grayscale",Ce=!0;function vm(e){if(!Number.isFinite(e))return!1;const i=Number(e),s=`EPSG:${i}`;try{return Pi(s,"EPSG:4326",[0,0]),!0}catch{const r=i>=32601&&i<=32660,h=i>=32701&&i<=32760;if(r||h){const c=`+proj=utm +zone=${r?i-32600:i-32700} +datum=WGS84 ${h?"+south ":""}+units=m +no_defs +type=crs`;Pi.defs(s,c);try{return Pi(s,"EPSG:4326",[0,0]),!0}catch{return!1}}return!1}}function Oh(e){const i=e.getWidth(),s=e.getHeight(),o=e.getGeoKeys?.()||{},r=typeof e.getFileDirectory=="function"?e.getFileDirectory():{},h=o.GTModelTypeGeoKey;let u;Number.isFinite(Eo)?u=Eo:h===2&&Number.isFinite(o.GeographicTypeGeoKey)?u=o.GeographicTypeGeoKey:h===1&&Number.isFinite(o.ProjectedCSTypeGeoKey)?u=o.ProjectedCSTypeGeoKey:u=o.GeographicTypeGeoKey??o.ProjectedCSTypeGeoKey;const c=o.GTRasterTypeGeoKey||o.RasterTypeGeoKey,d=Array.isArray(r?.ModelTransformation)?r.ModelTransformation:null,_=typeof e.getTiePoints=="function"?e.getTiePoints():[],v=r&&Array.isArray(r.ModelPixelScale)?r.ModelPixelScale:null;let g;const p=e.getBoundingBox?.();if(p&&p.every(S=>Number.isFinite(S)))if(c===2&&Array.isArray(r?.ModelPixelScale)){const S=Math.abs(Number(r.ModelPixelScale[0])||0),I=Math.abs(Number(r.ModelPixelScale[1])||0);S>0&&I>0?g=[p[0]-S/2,p[1]-I/2,p[2]+S/2,p[3]+I/2]:g=p}else g=p;else if(d&&d.length===16){const S=d,I=c===2?.5:0,O=[[-I,-I],[i-I,-I],[i-I,s-I],[-I,s-I]],N=($,F)=>{const K=S[0]*$+S[1]*F+S[3],ct=S[4]*$+S[5]*F+S[7],mt=S[12]*$+S[13]*F+S[15];return[K/(mt||1),ct/(mt||1)]},B=O.map(([$,F])=>N($,F)),q=B.map($=>$[0]),j=B.map($=>$[1]);g=[Math.min(...q),Math.min(...j),Math.max(...q),Math.max(...j)]}else if(Array.isArray(_)&&_.length>0&&v&&v.length>=2){const S=_[0],I=Number.isFinite(S.i)?S.i:0,O=Number.isFinite(S.j)?S.j:0,N=Number.isFinite(S.x)?S.x:0,B=Number.isFinite(S.y)?S.y:0,q=Number(v[0])||1,j=Number(v[1])||1,$=c===2?.5:0,F=[[-$,-$],[i-$,-$],[i-$,s-$],[-$,s-$]],K=(et,Et)=>[N+(et-I)*q,B-(Et-O)*j],ct=F.map(([et,Et])=>K(et,Et)),mt=ct.map(et=>et[0]),tt=ct.map(et=>et[1]);g=[Math.min(...mt),Math.min(...tt),Math.max(...mt),Math.max(...tt)]}else g=[-.5,-.5,.5,.5];let M,w=!1,P,x,A,T;if(u&&Number.isFinite(u)&&u!==4326){const S=vm(u);if(w=S,S){const I=`EPSG:${u}`,O=c===2?.5:0,N=[[-O,-O],[i-O,-O],[i-O,s-O],[-O,s-O]],B=(F,K)=>{if(d&&d.length===16){const tt=d,et=tt[0]*F+tt[1]*K+tt[3],Et=tt[4]*F+tt[5]*K+tt[7],Z=tt[12]*F+tt[13]*K+tt[15];return[et/(Z||1),Et/(Z||1)]}else if(Array.isArray(_)&&_.length>0&&v&&v.length>=2){const tt=_[0],et=Number.isFinite(tt.i)?tt.i:0,Et=Number.isFinite(tt.j)?tt.j:0,Z=Number.isFinite(tt.x)?tt.x:g[0],gt=Number.isFinite(tt.y)?tt.y:g[3],U=Number(v[0])||(g[2]-g[0])/i,at=Number(v[1])||(g[3]-g[1])/s,rt=Z+(F-et)*U,ut=gt-(K-Et)*at;return[rt,ut]}const ct=g[0]+F/i*(g[2]-g[0]),mt=g[3]-K/s*(g[3]-g[1]);return[ct,mt]},q=N.map(([F,K])=>{const[ct,mt]=B(F,K),[tt,et]=Pi(I,"EPSG:4326",[ct,mt]);return[tt,et]}),j=q.map(F=>F[0]),$=q.map(F=>F[1]);P=Math.min(...j),x=Math.max(...j),A=Math.min(...$),T=Math.max(...$),M=Pt.latLngBounds([A,P],[T,x])}else M=Pt.latLngBounds([g[1],g[0]],[g[3],g[2]]),P=M.getWest(),x=M.getEast(),A=M.getSouth(),T=M.getNorth()}else M=Pt.latLngBounds([g[1],g[0]],[g[3],g[2]]),P=M.getWest(),x=M.getEast(),A=M.getSouth(),T=M.getNorth();return{width:i,height:s,geoKeys:o,fileDirectory:r,projCode:u,projectionDefined:w,rasterType:c,transform:d,ties:_,scale:v,bbox:g,bounds:M,lonMin:P,lonMax:x,latMin:A,latMax:T}}async function ym(){let e;{const r=await fetch("/rasters/manifest.json");if(!r.ok)throw new Error("Failed to load raster manifest");e=await r.json()}const i=e?.dir||"rasters";ws=(Array.isArray(e?.items)?e.items:[]).map(r=>{const h=Gh(r.file);return{label:cm(r.file),file:r.file,dir:i,isoDate:h,displayDate:Ve(h)}});const o=ws.map(r=>r.isoDate).filter(Boolean).sort();o.length>0&&(be=ie(o[o.length-1])),ka()}async function Mm(){try{const e=await fetch("/api/basemaps");if(!e.ok)return;const i=await e.json();Ia.clear(),Array.isArray(i?.dates)&&i.dates.forEach(s=>{const o=ie(String(s));o&&Ia.add(o)}),Ra(Ye)}catch(e){console.warn("Failed to load basemap cache list",e)}}function Rh(e,i){return`/rasters/${i}`}function kh(e){switch(e=Math.max(0,Math.min(1,e)),Da){case"grayscale":{const i=Math.round(255*e);return[i,i,i,255]}case"viridis":{const i=Math.round(255*(.267+2.39*e-2.64*e*e+.95*e*e*e)),s=Math.round(255*(.004+1.73*e-.89*e*e)),o=Math.round(255*(.329+.71*e+.28*e*e));return[Math.max(0,Math.min(255,i)),Math.max(0,Math.min(255,s)),Math.max(0,Math.min(255,o)),255]}case"magma":{const i=Math.round(255*Math.pow(e,.4)),s=Math.round(255*Math.pow(e,2)*.8),o=Math.round(255*(.2+.8*(1-Math.pow(1-e,3))));return[i,s,o,255]}case"heat":{const i=4*e,s=Math.round(255*Math.max(0,Math.min(1,i-1.5))),o=Math.round(255*Math.max(0,Math.min(1,i-.5))),r=Math.round(255*Math.max(0,Math.min(1,1.5-i)));return[s,o,r,255]}default:{const i=Math.round(255*e);return[i,i,i,255]}}}function Io(){const e=document.getElementById("legendCanvas");if(!e)return;const i=e.getContext("2d"),s=e.width,o=e.height,r=i.createImageData(s,o);for(let h=0;h<s;h++){const u=h/(s-1),[c,d,_,v]=kh(u);for(let g=0;g<o;g++){const p=(g*s+h)*4;r.data[p]=c,r.data[p+1]=d,r.data[p+2]=_,r.data[p+3]=v}}i.putImageData(r,0,0)}function wm(){const e=an;e.textContent="",ws.forEach(({label:i,dir:s,file:o,isoDate:r,displayDate:h})=>{const u=Rh(s,o),c=document.createElement("div");c.className="raster-item";const d=document.createElement("div");d.className="raster-header";const _=document.createElement("div");_.className="raster-info";const v=document.createElement("input");v.type="checkbox",Q_.set(u,v);const g=document.createElement("label"),p=h||Ve(r)||i;g.textContent=p,g.style.cursor="pointer";const M=document.createElement("button");M.textContent="Zoom",M.title="Zoom to layer",_.appendChild(v),_.appendChild(g),d.appendChild(_),d.appendChild(M);const w=document.createElement("div");w.className="raster-controls";const P=document.createElement("input");P.type="range",P.min="0",P.max="1",P.step="0.01",P.value="0.8",P.className="opacity";const x=document.createElement("div");x.className="legend";const A=h||(r?Ve(r):void 0);x.textContent=A?`Date  ${A}`:"",x.classList.remove("status-error"),w.appendChild(P),c.appendChild(d),c.appendChild(w),c.appendChild(x),e.appendChild(c);async function T(){if(xe.has(u))return xe.get(u);hm(),x.classList.remove("status-error"),x.textContent="Loading";const S=u;try{const O=await(await Ch(S)).getImage(),N=O.getWidth(),B=O.getHeight(),j=(await O.readRasters({interleave:!1,samples:[0]}))[0],$=O.getGDALNoData?.()??O.getNoDataValue?.(),{obsMin:F,obsMax:K}=await um(j,$),ct=document.createElement("canvas");ct.width=N,ct.height=B;const mt=ct.getContext("2d"),tt=async()=>{await Co({data:j,width:N,height:B,noData:$,ctx:mt})};await tt();let et=fn.get(u);et||(et=Oh(O),fn.set(u,et));const{geoKeys:Et,fileDirectory:Z,projCode:gt,projectionDefined:U,rasterType:at,transform:rt,ties:ut,scale:st,bbox:W,bounds:V,lonMin:bt,lonMax:Ut,latMin:ke,latMax:Wt}=et,ei=Z&&typeof Z.GeoAsciiParams=="string"?Z.GeoAsciiParams:void 0;if(console.groupCollapsed(`GeoTIFF info: ${i}`),console.log("GeoKeys:",Et),console.log("FileDirectory keys:",Object.keys(Z||{})),console.log("RasterType (1=Area,2=Point):",at),console.log("Proj code:",gt),ei&&console.log("GeoAsciiParams:",ei),rt){const Gt=Math.abs(rt[1])>1e-12||Math.abs(rt[4])>1e-12;console.log("Has transform:",!0,"rotation/shear:",Gt),Gt&&console.warn("Raster has rotation/shear; axis-aligned ImageOverlay may misalign.")}else console.log("Has transform:",!1);if(Array.isArray(ut)&&ut.length&&console.log("First tiepoint:",ut[0]),st&&console.log("ModelPixelScale:",st),console.groupEnd(),gt&&Number.isFinite(gt)&&gt!==4326&&V&&U){x.classList.remove("status-error"),x.textContent="Reprojecting";const Gt=Math.max(2,Math.min(N,4096)),Kt=Math.max(2,Math.round(B*(Gt/N))),Ee=new Float32Array(Gt*Kt),Cn=`EPSG:${gt}`,Gn=([ft,z])=>Pi("EPSG:4326",Cn,[ft,z]);let Ii=null,Ni=null,Be=null,ii=null,Oi=null,In=null,Ri=!1;if(rt&&rt.length===16&&Math.abs(rt[12])<1e-12&&Math.abs(rt[13])<1e-12){const ft=rt[0],z=rt[1],ge=rt[3],qt=rt[4],Xt=rt[5],Yt=rt[7],Jt=ft*Xt-z*qt;Math.abs(Jt)>1e-12&&(Ii=Xt/Jt,Ni=-z/Jt,Be=-qt/Jt,ii=ft/Jt,Oi=-(Ii*ge+Ni*Yt),In=-(Be*ge+ii*Yt),Ri=!0)}const It=Array.isArray(ut)&&ut.length>0?ut[0]:void 0,Ns=It&&Number.isFinite(It.i)?It.i:0,Nn=It&&Number.isFinite(It.j)?It.j:0,ki=It&&Number.isFinite(It.x)?It.x:W[0],On=It&&Number.isFinite(It.y)?It.y:W[3],Os=st&&st.length>=2?Number(st[0])||1:(W[2]-W[0])/N,ze=st&&st.length>=2?Number(st[1])||1:(W[3]-W[1])/B,Rs=(ft,z)=>{if(Ri){const Xt=Ii*ft+Ni*z+Oi,Yt=Be*ft+ii*z+In;return[Xt,Yt]}else if(Array.isArray(ut)&&ut.length>0&&st&&st.length>=2){const Xt=(ft-ki)/Os+Ns,Yt=(On-z)/ze+Nn;return[Xt,Yt]}const ge=(ft-W[0])/(W[2]-W[0])*N,qt=(W[3]-z)/(W[3]-W[1])*B;return[ge,qt]},ks=(Ut-bt)/Gt,Rn=(Wt-ke)/Kt,Di=at===2,kn=Math.max(1,Math.floor(5e5/Math.max(1,Gt)));await(async()=>{for(let ft=0;ft<Kt;ft++){const z=Wt-(ft+.5)*Rn,ge=ft*Gt;for(let qt=0;qt<Gt;qt++){const Xt=bt+(qt+.5)*ks,[Yt,Jt]=Gn([Xt,z]),[zi,pe]=Rs(Yt,Jt),si=Di?Math.round(zi):Math.floor(zi),Fi=Di?Math.round(pe):Math.floor(pe),Fn=ge+qt;if(si>=0&&si<N&&Fi>=0&&Fi<B){const Zs=Fi*N+si;Ee[Fn]=j[Zs]}else Ee[Fn]=Number.NaN}(ft+1)%kn===0&&ft+1<Kt&&await new Promise(requestAnimationFrame)}})();const me=document.createElement("canvas");me.width=Gt,me.height=Kt;const Dn=me.getContext("2d"),Bn=async()=>{await Co({data:Ee,width:Gt,height:Kt,noData:$,ctx:Dn})};await Bn(),ct.width=me.width,ct.height=me.height;const Ds=me.toDataURL("image/png"),Bs=Pt.imageOverlay(Ds,V,{opacity:0,className:Ce?"smooth":"pixelated"}),Bi=at===2?"PixelIsPoint":"PixelIsArea",zs=Number.isFinite(gt)?`EPSG:${gt}4326`:"EPSG:unknown4326",zn=h||(r?Ve(r):void 0),Fs=zn?`${zn}  `:"",ni={layer:Bs,statusText:`${Fs}${zs}  ${Bi}  reproj:${N}x${B}${Gt}x${Kt}  obs:[${F.toFixed(3)}, ${K.toFixed(3)}] domain:[0,1]`,data:Ee,width:Gt,height:Kt,noData:$,bounds:V,canvas:me,ctx:Dn,renderToCanvas:Bn,added:!1,isoDate:r,displayDate:h};return xe.set(u,ni),Ts(ni,{force:!0}),x.classList.remove("status-error"),x.textContent=ni.statusText,ni}else gt&&Number.isFinite(gt)&&gt!==4326&&!U&&console.warn(`EPSG:${gt} has no proj4 definition available; displaying without reprojection.`);const De=ct.toDataURL("image/png"),Ai=Pt.imageOverlay(De,V,{opacity:0,className:Ce?"smooth":"pixelated"}),Is=at===2?"PixelIsPoint":"PixelIsArea",An=Number.isFinite(gt)?`EPSG:${gt}`:"EPSG:unknown",Ci=h||(r?Ve(r):void 0),Gi=Ci?`${Ci}  `:"",_e={layer:Ai,statusText:`${Gi}${An}  ${Is}  obs:[${F.toFixed(3)}, ${K.toFixed(3)}] domain:[0,1]`,data:j,width:N,height:B,noData:$,bounds:V,canvas:ct,ctx:mt,renderToCanvas:tt,added:!1,isoDate:r,displayDate:h};return xe.set(u,_e),Ts(_e,{force:!0}),x.classList.remove("status-error"),x.textContent=_e.statusText,_e}catch(I){throw console.error(I),x.classList.add("status-error"),x.textContent="Error: "+(I?.message||"failed to load"),I}finally{lm()}}v.addEventListener("change",async()=>{if(v.checked)try{const S=await T(),{layer:I}=S;x.textContent="Rendering",S.added||(I.addTo(nt),S.added=!0);const O=isNaN(parseFloat(P.value))?.8:parseFloat(P.value);I.setOpacity&&I.setOpacity(O);const N=I.getElement&&I.getElement();if(N&&(N.classList.toggle("smooth",Ce),N.classList.toggle("pixelated",!Ce)),S.bounds&&S.bounds.isValid&&S.bounds.isValid()&&!S._zoomedOnce){S._zoomedOnce=!0;try{nt.fitBounds(S.bounds.pad(.02))}catch{}}if(S.isoDate){const B=ie(S.isoDate);B&&yn.add(B),ka()}Ao(),x.classList.remove("status-error"),x.textContent=S.statusText||"Visible"}catch{v.checked=!1}else{const S=xe.get(u);if(S){S.layer.setOpacity&&S.layer.setOpacity(0),x.classList.remove("status-error");const I=S.displayDate||(S.isoDate?Ve(S.isoDate):void 0);if(x.textContent=I?`Date  ${I}`:"",S.isoDate){const O=ie(S.isoDate);O&&yn.delete(O),ka()}Ao()}}}),M.addEventListener("click",async()=>{try{const S=await T();S&&S.bounds&&S.bounds.isValid&&S.bounds.isValid()&&nt.fitBounds(S.bounds.pad(.05))}catch{}}),P.addEventListener("input",()=>{const S=xe.get(u);if(S){const I=parseFloat(P.value);S.layer.setOpacity&&S.layer.setOpacity(I)}})})}async function xm(){const e=ws;for(const{dir:i,file:s}of e){const o=Rh(i,s);try{if(fn.has(o)){const c=fn.get(o);if(c?.bounds&&c.bounds.isValid&&c.bounds.isValid()){nt.fitBounds(c.bounds.pad(.05));return}}const h=await(await Ch(o)).getImage(),u=Oh(h);if(fn.set(o,u),u.bounds&&u.bounds.isValid&&u.bounds.isValid()){nt.fitBounds(u.bounds.pad(.05));return}}catch(r){console.warn("Failed to derive bounds for",s,r)}}}async function Pm(){}(async()=>{if(an){const e=document.createElement("div");e.textContent="Loading raster list",an.appendChild(e)}try{await ym(),await Mm()}catch(e){console.error(e)}an&&(an.textContent=""),wm();try{await xm()}catch(e){console.warn("Failed to fit initial view",e)}try{await Pm()}catch(e){console.warn("Failed to activate default layers",e)}})();Cs(!0);setTimeout(()=>Cs(!1),2500);(()=>{Io();const e=document.getElementById("rampSelect");e&&(e.value=Da,e.addEventListener("change",async()=>{Da=e.value,Io();for(const s of xe.values())!s||!s.layer||s.renderToCanvas&&s.canvas&&(await s.renderToCanvas(),Ts(s,{force:!0}))}));const i=document.getElementById("smoothToggle");i&&(i.checked=Ce,i.addEventListener("change",()=>{Ce=i.checked,xe.forEach(s=>{if(!s||!s.layer)return;const o=s.layer.getElement&&s.layer.getElement();o&&(o.classList.toggle("smooth",Ce),o.classList.toggle("pixelated",!Ce))})}))})();export{bm as L,Sm as a,Ba as g};
